---
weight: 10
sourceSHA: 3bc2f33176efb6b2528cea4d198bc359c003f4d2236a9a5b91334fd1908a1125
---

# Создание подсетей (Сеть Calico)

Создайте подсети в сети Calico для достижения более тонкой градации сетевой изоляции для ресурсов внутри кластера.

## Ограничения и ограничения

В среде кластера IPv6 подсети, созданные в сети Calico, по умолчанию используют инкапсуляцию VXLAN. Порты, необходимые для инкапсуляции VXLAN, отличаются от портов инкапсуляции IPIP. Вы должны убедиться, что UDP-порт 4789 открыт.

## Правила распределения IP

**Примечание**: Если проект или пространство имен имеют несколько подсетей, IP-адрес будет случайным образом выбран из одной из подсетей.

- Распределение по проекту:

  - Если проект не привязан к подсети, Pods во всех пространствах имен под этим проектом могут использовать только IP-адреса из подсети по умолчанию. Если в подсети по умолчанию недостаточно IP-адресов, Pods не смогут запуститься.
  - Если проект привязан к подсети, Pods во всех пространствах имен под этим проектом могут использовать только IP-адреса из этой конкретной подсети.

- Распределение по пространству имен:

  - Если пространство имен не привязано к подсети, Pods в этом пространстве имен могут использовать только IP-адреса из подсети по умолчанию. Если в подсети по умолчанию недостаточно IP-адресов, Pods не смогут запуститься.
  - Если пространство имен привязано к подсети, Pods в этом пространстве имен могут использовать только IP-адреса из этой конкретной подсети.

## Создание подсети и распределение проектов или пространств имен

1. Перейдите в **Управление платформой**.

2. В левой навигационной панели нажмите **Управление сетью** > **Подсети**.

3. Нажмите **Создать подсеть**.

4. Ознакомьтесь с приведенными ниже инструкциями для настройки соответствующих параметров.

   | Параметр                  | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   | ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | **CIDR**                  | После распределения подсети проекту или пространству имен группы контейнеров в пространстве имен будут случайным образом использовать IP-адреса в пределах данного CIDR для связи.<br />**Примечание**: Для соответствия между CIDR и BlockSize обратитесь к [Содержимому справки](#1).                                                                                                                                                                                                                                      |
   | **Протокол инкапсуляции** | Выберите протокол инкапсуляции. **IPIP** не поддерживается в режиме двойного стека.<ul><li>**IPIP**: Реализует межсегментное взаимодействие с использованием протокола IPIP.</li><li>**VXLAN (Alpha)**: Реализует межсегментное взаимодействие с использованием протокола VXLAN.</li><li>**Без инкапсуляции**: Прямое подключение через маршрутизацию.</li></ul>                                                                                                                                                                   |
   | **Режим инкапсуляции**    | Когда протокол инкапсуляции **IPIP** или **VXLAN**, режим инкапсуляции должен быть установлен, по умолчанию он составляет **Всегда**.<br /><ul><li>**Всегда**: Всегда включать туннели IPIP / VXLAN.</li><li>**Кросс-подсеть**: Включать туннели IPIP / VXLAN только тогда, когда хост находится в разных подсетях; прямое соединение через маршрутизацию, если хост находится в одной подсети.</li></ul>                                                                                                                                      |
   | **NAT исходящего трафика**| Выберите, необходимо ли включить NAT для исходящего трафика (Сетевой адрессный перевод), который включен по умолчанию.<br />Он в основном используется для установки адресов доступа, открытых для внешней сети, когда группа контейнеров подсети обращается к внешней сети.<br />Когда включен NAT для исходящего трафика, IP-адрес хоста будет использоваться в качестве адреса доступа для текущей группы контейнеров подсети; когда не включен, IP-адреса групп контейнеров в подсети будут напрямую открыты для внешней сети. |

5. Нажмите **Подтвердить**.

6. На странице деталей подсети выберите **Действия** > **Распределить проект** / **Распределить пространство имен**.

7. Завершите конфигурацию и нажмите **Распределить**.

## Содержимое справки \{#1}

Динамическое соответствие между CIDR и blockSize показано в таблице ниже.

| CIDR            | Размер blockSize | Количество хостов | Размер одного пула IP |
| --------------- | ---------------- | ----------------- | --------------------- |
| `prefix<=16`    | 26               | 1024+             | 64                    |
| `16<prefix<=19` | 27               | 256~1024          | 32                    |
| `prefix=20`     | 28               | 256               | 16                    |
| `prefix=21`     | 29               | 256               | 8                     |
| `prefix=22`     | 30               | 256               | 4                     |
| `prefix=23`     | 30               | 128               | 4                     |
| `prefix=24`     | 30               | 64                | 4                     |
| `prefix=25`     | 30               | 32                | 4                     |
| `prefix=26`     | 31               | 32                | 2                     |
| `prefix=27`     | 31               | 16                | 2                     |
| `prefix=28`     | 31               | 8                 | 2                     |
| `prefix=29`     | 31               | 4                 | 2                     |
| `prefix=30`     | 31               | 2                 | 2                     |
| `prefix=31`     | 31               | 1                 | 2                     |

**Примечание**: Конфигурации подсетей с префиксами больше 31 не поддерживаются.
