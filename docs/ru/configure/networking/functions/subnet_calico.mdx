---
weight: 10
sourceSHA: 3bc2f33176efb6b2528cea4d198bc359c003f4d2236a9a5b91334fd1908a1125
---

# Создание подсетей (Сеть Calico)

Создайте подсети в сети Calico для достижения более тонкой градации сетевой изоляции для ресурсов в кластере.

## Ограничения и ограничения

В среде кластера IPv6 подсети, созданные в сети Calico, по умолчанию используют инкапсуляцию VXLAN. Порты, необходимые для инкапсуляции VXLAN, отличаются от портов инкапсуляции IPIP. Вам необходимо убедиться, что UDP порт 4789 открыт.

## Правила распределения IP

**Примечание**: Если проект или пространство имен использует несколько подсетей, IP-адрес будет случайным образом выбран из одной из подсетей.

- Распределение по проектам:

  - Если проект не связан с подсетью, поды во всех пространствах имен под этим проектом могут использовать только IP-адреса из подсети по умолчанию. Если в подсети по умолчанию недостаточно IP-адресов, поды не смогут запуститься.
  - Если проект связан с подсетью, поды во всех пространствах имен под этим проектом могут использовать только IP-адреса из этой конкретной подсети.

- Распределение по пространствам имен:

  - Если пространство имен не связано с подсетью, поды в этом пространстве имен могут использовать только IP-адреса из подсети по умолчанию. Если в подсети по умолчанию недостаточно IP-адресов, поды не смогут запуститься.
  - Если пространство имен связано с подсетью, поды в этом пространстве имен могут использовать только IP-адреса из этой конкретной подсети.

## Создание подсети и распределение проектов или пространств имен

1. Перейдите в **Управление платформой**.

2. В левой навигационной панели нажмите **Управление сетью** > **Подсети**.

3. Нажмите **Создать подсеть**.

4. Ознакомьтесь со следующими инструкциями для настройки соответствующих параметров.

   | Параметр                 | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   | ------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | **CIDR**                 | После распределения подсети проекту или пространству имен контейнерные группы в пространстве имен будут случайным образом использовать IP-адреса в этом CIDR для связи.<br />**Примечание**: Для соответствия между CIDR и BlockSize, пожалуйста, обратитесь к [Содержимому справки](#1).                                                                                                                                                                                                                                     |
   | **Протокол инкапсуляции** | Выберите протокол инкапсуляции. **IPIP** не поддерживается в режиме двойного стека.<ul><li>**IPIP**: Реализует межсегментную связь, используя протокол IPIP.</li><li>**VXLAN (Alpha)**: Реализует межсегментную связь, используя протокол VXLAN.</li><li>**Без инкапсуляции**: Прямое соединение через маршрутизацию и пересылку.</li></ul>                                                                                                                                                               |
   | **Режим инкапсуляции**    | Когда протокол инкапсуляции **IPIP** или **VXLAN**, режим инкапсуляции должен быть установлен, по умолчанию равен **Всегда**.<br /><ul><li>**Всегда**: Всегда включать IPIP / VXLAN туннели.</li><li>**Между подсетями**: Включать IPIP / VXLAN туннели только когда хост находится в различных подсетях; прямое соединение через маршрутизацию и пересылку, когда хост находится в одной и той же подсети.</li></ul>                                                                                                                                     |
   | **NAT исходящего трафика** | Выберите, следует ли включить NAT (Сетевой адресный перевод) для исходящего трафика, который включен по умолчанию.<br />Он в основном используется для настройки адресов доступа, открытых для внешней сети, когда контейнерная группа подсети обращается к внешней сети.<br />Когда NAT для исходящего трафика включен, IP-адрес хоста будет использоваться в качестве адреса доступа для текущей контейнерной группы подсети; когда не включен, IP-адреса контейнерных групп в подсети будут напрямую доступны извне. |

5. Нажмите **Подтвердить**.

6. На странице деталей подсети выберите **Действия** > **Распределить проект** / **Распределить пространство имен**.

7. Завершите настройку и нажмите **Распределить**.

## Содержимое справки \{#1}

Динамическое соответствие между CIDR и blockSize показано в таблице ниже.

| CIDR            | Размер blockSize | Число узлов | Размер одного пула IP |
| --------------- | --------------- | ------------- | --------------------- |
| `prefix<=16`    | 26             | 1024+           | 64                      |
| `16<prefix<=19` | 27             | 256~1024        | 32                      |
| `prefix=20`     | 28             | 256             | 16                      |
| `prefix=21`     | 29             | 256             | 8                       |
| `prefix=22`     | 30             | 256             | 4                       |
| `prefix=23`     | 30             | 128             | 4                       |
| `prefix=24`     | 30             | 64              | 4                       |
| `prefix=25`     | 30             | 32              | 4                       |
| `prefix=26`     | 31             | 32              | 2                       |
| `prefix=27`     | 31             | 16              | 2                       |
| `prefix=28`     | 31             | 8               | 2                       |
| `prefix=29`     | 31             | 4               | 2                       |
| `prefix=30`     | 31             | 2               | 2                       |
| `prefix=31`     | 31             | 1               | 2                       |

**Примечание**: Настройки подсетей с префиксами более 31 не поддерживаются.
