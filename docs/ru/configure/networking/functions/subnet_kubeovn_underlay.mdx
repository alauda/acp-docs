---
weight: 30
sourceSHA: e899e8840a783d7c43b4c8ff4f56748b617935a61fbc8edb7b73d55335e2ad87
---

# Создание подсетей (Kube-OVN Underlay Network)

Создание подсетей в сети Kube-OVN Underlay не только позволяет более тонко настраивать сетевую изоляцию для ресурсов, но и обеспечивает лучший производственный опыт.

**Заметка**: Сетевая инфраструктура контейнеров в Kube-OVN Underlay требует поддержки со стороны физической сети. Пожалуйста, ознакомьтесь с лучшими практиками [Подготовка физической сети Kube-OVN Underlay](../how_to/kubeovn_underlay_py.mdx), чтобы обеспечить сетевую связность.

## Правила выделения IP

**Заметка**: Если проекту или пространству имен выделено несколько подсетей, один из IP-адресов из соответствующей подсети будет случайным образом использоваться.

- Выделение проекта:

  - Если проект не привязан к подсети, Pods во всех пространствах имен под этим проектом могут использовать только IP-адреса из подсети по умолчанию. Если в подсети по умолчанию недостаточно IP-адресов, Pods не смогут запуститься.
  - Если проект привязан к подсети, Pods во всех пространствах имен под этим проектом могут использовать только IP-адреса из этой подсети.

- Выделение пространства имен:

  - Если пространство имен не привязано к подсети, Pods в этом пространстве имен могут использовать только IP-адреса из подсети по умолчанию. Если в подсети по умолчанию недостаточно IP-адресов, Pods не смогут запуститься.
  - Если пространство имен привязано к подсети, Pods в этом пространстве имен могут использовать только IP-адреса из этой подсети.

## Инструкции по использованию

Общий процесс создания подсетей в сети Kube-OVN Underlay: Добавить сетевой мост > Добавить VLAN > Создать подсеть.

## (Необязательно) Добавить сетевой мост \{#kube-ovn\_underlay\_bridge\_network}

Сетевой мост относится к мосту, и после привязки сетевой карты к мосту он может перенаправлять трафик сетей контейнеров, обеспечивая взаимосвязь с физической сетью.

### Шаги

1. Перейдите в **Управление платформой**.

2. В левом меню навигации выберите **Управление сетью** > **Сетевой мост**.

3. Нажмите **Добавить сетевой мост**.

4. Настройте соответствующие параметры на основе следующих инструкций.

   **Заметка**:

   - *Целевая контейнерная группа* относится ко всем контейнерным группам, запланированным на текущем узле, или контейнерным группам в пространствах имен, привязанных к определенным подсетям, запланированным на текущем узле. Это зависит от масштаба подсети под сетевым мостом.

   - Узлы в подсети Underlay должны иметь несколько сетевых карт, и сетевая карта, используемая сетевым мостом, должна быть эксклюзивно назначена Underlay и не может транспортировать другой трафик, такой как SSH. Например, если сетевой мост имеет три узла, планирующих использовать eth0, eth0, eth1 исключительно для Underlay, то сетевая карта по умолчанию может быть настроена как eth0, а сетевая карта для третьего узла может быть eth1.

   | Параметр                          | Описание                                                                                                                                                                                                                                                                                                                                                          |
   | ---------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Имя сетевой карты по умолчанию**      | По умолчанию целевая контейнерная группа будет использовать это как сетевую карту моста для взаимосвязи с физической сетью.                                                                                                                                                                                                                                    |
   | **Настроить сетевую карту по узлам** | Целевые контейнерные группы на настроенных узлах будут соединяться с заданной сетевой картой вместо сетевой карты по умолчанию.                                                                                                                                                                                                                                   |
   | **Исключить узлы**                  | Когда узлы исключаются, все контейнерные группы, запланированные на эти узлы, не будут подключаться к какой-либо сетевой карте на этих узлах.<br /><br />**Заметка**: Контейнерные группы на исключенных узлах не смогут взаимодействовать с физической сетью или сетями контейнеров между узлами, и следует избегать планирования связанных контейнерных групп на этих узлах. |

5. Нажмите **Добавить**.

## (Необязательно) Добавить VLAN

Платформа имеет предварительно настроенный виртуальный LAN **ovn-vlan**, который будет подключен к сетевому мосту **provider**. Также можно настроить новую VLAN для подключения к другим сетевым мостам, тем самым достигая сетевой изоляции между VLAN.

### Шаги

1. Перейдите в **Управление платформой**.

2. В левом меню навигации выберите **Управление сетью** > **VLAN**.

3. Нажмите **Добавить VLAN**.

4. Настройте соответствующие параметры на основе следующих инструкций.

   | Параметр          | Описание                                                                                      |
   | ------------------ | ------------------------------------------------------------------------------------------------ |
   | **ID VLAN**        | Уникальный идентификатор для этой VLAN, который будет использован для различения разных виртуальных LAN. |
   | **Сетевой мост** | VLAN подключится к этому сетевому мосту для взаимосвязи с физической сетью.   |

5. Нажмите **Добавить**.

## Создать подсеть и назначить проект или пространство имен

**Заметка**: Платформа также предварительно настраивает подсеть **join** для связи между узлами и контейнерными группами в режиме Overlay transport. Эта подсеть не будет использоваться в режиме Underlay transport, поэтому крайне важно избегать конфликтов IP-сегментов между **join** и другими подсетями.

### Шаги

1. Перейдите в **Управление платформой**.

2. В левом меню навигации выберите **Управление сетью** > **Подсеть**.

3. Нажмите **Создать подсеть**.

4. Настройте соответствующие параметры на основе следующих инструкций.

   | Параметр       | Описание                                                                                                                                  |
   | --------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
   | **VLAN**        | VLAN, к которому принадлежит подсеть.                                                                                                        |
   | **Подсеть**      | После назначения подсети проекту или пространству имен IP-адреса в физической подсети будут случайным образом выделены для использования контейнерными группами. |
   | **Шлюз**     | Физический шлюз в вышеупомянутой подсети.                                                                                                |
   | **Зарезервированный IP** | Указанный зарезервированный IP не будет автоматически назначаться. Например, его можно использовать как IP для компонента вычислений **фиксированный IP**.  |

5. Нажмите **Подтвердить**.

6. На странице сведений о подсети выберите **Действие** > **Назначить проект** / **Пространство имен**.

7. Завершите настройку и нажмите **Назначить**.

## Связанные операции

Когда как подсети Underlay, так и Overlay существуют в кластере, вы можете настроить [Автоматическую взаимосвязь между подсетями Underlay и Overlay](../how_to/underlay_overlay_st.mdx) по мере необходимости.
