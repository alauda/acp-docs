---
weight: 30
sourceSHA: e899e8840a783d7c43b4c8ff4f56748b617935a61fbc8edb7b73d55335e2ad87
---

# Создание подсетей (Kube-OVN Underlay сеть)

Создание подсетей в сети Kube-OVN Underlay не только позволяет обеспечить более тонкую изоляцию сети для ресурсов, но и предоставляет лучший пользовательский опыт с точки зрения производительности.

**Примечание**: Контейнерная сеть в Kube-OVN Underlay требует поддержки со стороны физической сети. Пожалуйста, ознакомьтесь с лучшими практиками [Подготовка физической сети Kube-OVN Underlay](../how_to/kubeovn_underlay_py.mdx), чтобы обеспечить сетевое подключение.

## Правила распределения IP

**Примечание**: Если проекту или пространству имен назначено несколько подсетей, один из IP-адресов из соответствующей подсети будет использован случайным образом.

- Распределение по проектам:

  - Если проект не связан с подсетью, Pods во всех пространствах имен этого проекта могут использовать только IP-адреса из стандартной подсети. Если в стандартной подсети недостаточно IP-адресов, Pods не смогут запуститься.
  - Если проект связан с подсетью, Pods во всех пространствах имен этого проекта могут использовать только IP-адреса из этой подсети.

- Распределение по пространству имен:

  - Если пространство имен не связано с подсетью, Pods в этом пространстве имен могут использовать только IP-адреса из стандартной подсети. Если в стандартной подсети недостаточно IP-адресов, Pods не смогут запуститься.
  - Если пространство имен связано с подсетью, Pods в этом пространстве имен могут использовать только IP-адреса из этой подсети.

## Инструкции по использованию

Общий процесс создания подсетей в сети Kube-OVN Underlay следующий: Добавить мостовую сеть > Добавить VLAN > Создать подсеть.

## (Необязательно) Добавить мостовую сеть \{#kube-ovn\_underlay\_bridge\_network}

Мостовая сеть относится к мосту, и после связывания сетевой карты с мостом она может передавать трафик контейнерной сети, обеспечивая взаимодействие с физической сетью.

### Шаги

1. Перейдите в раздел **Управление платформой**.

2. В левой боковой панели нажмите **Управление сетью** > **Мостовая сеть**.

3. Нажмите **Добавить мостовую сеть**.

4. Настройте соответствующие параметры на основе следующих инструкций.

   **Примечание**:

   - *Целевая группа контейнеров* относится ко всем контейнерным группам, запланированным на текущем узле, или контейнерным группам в пространствах имен, привязанных к определённым подсетям, запланированным на текущем узле. Это зависит от диапазона подсети под мостовой сетью.

   - Узлы в подсети Underlay должны иметь несколько сетевых карт, и сетевая карта, используемая мостовой сетью, должна быть исключительно назначена для Underlay и не может использоваться для других типов трафика, таких как SSH. Например, если мостовая сеть имеет три узла, планирующих использовать eth0, eth0 и eth1 исключительно для Underlay, то стандартную сетевую карту можно настроить как eth0, а сетевая карта для узла три может быть eth1.

   | Параметр                          | Описание                                                                                                                                                                                                                                                                                                                                                          |
   | ---------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Имя стандартной сетевой карты**      | По умолчанию целевая группа контейнеров будет использовать это как сетевую карту мостовой сети для взаимодействия с физической сетью.                                                                                                                                                                                                                                    |
   | **Настроить сетевую карту по узлу** | Целевые группы контейнеров на настроенных узлах будут связываться с указанной сетевой картой вместо стандартной сетевой карты.                                                                                                                                                                                                                                   |
   | **Исключить узлы**                  | При исключении узлов все контейнерные группы, запланированные на эти узлы, не будут связаны с какой-либо сетевой картой на этих узлах.<br /><br />**Примечание**: Контейнерные группы на исключённых узлах не смогут взаимодействовать с физической сетью или межузловыми контейнерными сетями, и нужно быть осторожным, чтобы избежать планирования связанных контейнерных групп на этих узлах. |

5. Нажмите **Добавить**.

## (Необязательно) Добавить VLAN

Платформа имеет преднастроенную виртуальную локальную сеть **ovn-vlan**, которая будет подключена к мостовой сети **provider**. Вы также можете настроить новую VLAN для подключения к другим мостовым сетям, тем самым достигнув сетевой изоляции между VLAN.

### Шаги

1. Перейдите в раздел **Управление платформой**.

2. В левой боковой панели нажмите **Управление сетью** > **VLAN**.

3. Нажмите **Добавить VLAN**.

4. Настройте соответствующие параметры на основе следующих инструкций.

   | Параметр          | Описание                                                                                      |
   | ------------------ | ------------------------------------------------------------------------------------------------ |
   | **VLAN ID**        | Уникальный идентификатор для этой VLAN, который будет использоваться для различия различных виртуальных локальных сетей. |
   | **Мостовая сеть** | VLAN будет подключаться к этой мостовой сети для взаимодействия с физической сетью.   |

5. Нажмите **Добавить**.

## Создать подсеть и назначить проект или пространство имен

**Примечание**: Платформа также предварительно настраивает подсеть **join** для связи между узлами и контейнерными группами в режиме Overlay transport. Эта подсеть не будет использоваться в режиме Underlay transport, поэтому крайне важно избегать конфликтов IP-адресов между **join** и другими подсетями.

### Шаги

1. Перейдите в раздел **Управление платформой**.

2. В левой боковой панели нажмите **Управление сетью** > **Подсеть**.

3. Нажмите **Создать подсеть**.

4. Настройте соответствующие параметры на основе следующих инструкций.

   | Параметр       | Описание                                                                                                                                  |
   | --------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
   | **VLAN**        | VLAN, к которой принадлежит подсеть.                                                                                                        |
   | **Подсеть**      | После назначения подсети проекту или пространству имен IP-адреса в пределах физической подсети будут выделяться случайным образом для использования контейнерными группами. |
   | **Шлюз**     | Физический шлюз внутри вышеуказанной подсети.                                                                                                |
   | **Резервированный IP** | Указанный резервированный IP не будет автоматически назначен. Например, он может использоваться как IP для компонента вычислений **fixed IP**.  |

5. Нажмите **Подтвердить**.

6. На странице деталей подсети выберите **Действие** > **Назначить проект** / **Пространство имен**.

7. Завершите настройку и нажмите **Назначить**.

## Связанные операции

Когда в кластере существуют как подсети Underlay, так и Overlay, вы можете настроить [Автоматическое взаимодействие между подсетями Underlay и Overlay](../how_to/underlay_overlay_st.mdx) по мере необходимости.
