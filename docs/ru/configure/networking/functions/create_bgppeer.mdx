---
weight: 20
sourceSHA: b2422ba10aeec6cff5f8ef11b203ee07ce168e4ed796bec913542b5024c690a8
---

# Создание BGP-соседей

Узлы, которые устанавливают соединения для обмена маршрутной информацией как между различными AS, так и внутри одного AS, которые общаются через протокол BGP.

## Терминология

| Термин          | Объяснение                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Номер AS**    | AS относится к совокупности маршрутизаторов, управляемых одной и той же технической административной организацией, использующей единую маршрутную политику. Каждому AS в BGP-сети присваивается уникальный номер AS, чтобы отличить его от различных AS. Номера AS делятся на 2-байтовые и 4-байтовые номера AS. <ul><li>Диапазон 2-байтовых номеров AS составляет 1~65535, где 1~64511 — зарегистрированные публичные номера AS в Интернете, аналогичные публичным IP-адресам; 64512~65535 — приватные номера AS, аналогичные приватным IP-адресам.Диапазон 4-байтовых номеров AS составляет 1~4294967295.</li></ul> Устройства, поддерживающие 4-байтовые номера AS, могут быть совместимы с устройствами, поддерживающими 2-байтовые номера AS. |

## Предварительные условия

Пожалуйста, свяжитесь с администратором для активации соответствующих функций.

## Пример пользовательского ресурса BGPPeer (CR)

```yaml
# test-bgb-example.yaml
apiVersion: metallb.io/v1beta2
kind: BGPPeer
metadata:
  name: example
  namespace: metallb-system
spec:
  myASN: 64512
  peerASN: 64512
  peerAddress: 172.30.0.3
  peerPort: 180
  nodeSelectors:
    - matchLabels:
        alertmanager: "true"
```

## Создание BGPPeer с помощью веб-консоли.

1. Перейдите в **Управление платформой**.

2. В левой навигационной панели нажмите **Управление сетью** > **BGP-соседи**.

3. Нажмите **Создать BGP-соседа**.

4. Следуйте приведенным ниже инструкциям для настройки параметров.

   | Параметр              | Описание                                                                                                                                                                                                                                                                                                        |
   | ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | **Локальный номер AS** | Номер AS, в котором находится узел, подключенный через BGP.<br /><br /><b>Примечание</b>: Если нет особых требований, рекомендуется использовать конфигурацию IBGP, что означает, что локальный номер AS должен совпадать с номером AS соседа.                                                              |
   | **Номер AS соседа**   | Номер AS, в котором находится BGP-сосед.                                                                                                                                                                                                                                                                |
   | **IP-адрес соседа**    | IP-адрес BGP-соседа, который должен быть действительным IP-адресом, способным установить соединение BGP.                                                                                                                                                                                                         |
   | **Локальный IP**       | IP-адрес узла, подключенного к BGP. Если у узла, подключенного к BGP, несколько IP-адресов, выберите указанный локальный IP для установления соединения BGP с соседом.                                                                                                                                                 |
   | **Порт соседа**        | Номер порта BGP-соседа.                                                                                                                                                                                                                                                                                   |
   | **Подключенный узел BGP** | Узел, который устанавливает соединение BGP. Если этот параметр не настроен, все узлы будут устанавливать соединения BGP.                                                                                                                                                                                       |
   | **eBGP Multi-Hop**     | Позволяет устанавливать сессии BGP между маршрутизаторами BGP, которые не соединены напрямую. Когда эта функция включена, значение TTL по умолчанию для пакетов BGP составляет 5, что позволяет устанавливать отношения BGP-соседей через несколько промежуточных сетевых устройств, делая проектирование сети более гибким.     |
   | **RouterID**           | Числовое значение размером 32 бита (обычно представлено в десятичном формате с точками, аналогичном формату IPv4), используемое для уникальной идентификации маршрутизатора BGP в BGP-сети, обычно используется для установления соседних отношений BGP, обнаружения маршрутных петель, выбора оптимальных путей и устранения неполадок в сети. |

5. Нажмите **Создать**.

## Создание BGPPeer с помощью CLI

```shell
kubectl apply -f test-bgb-example.yaml
```
