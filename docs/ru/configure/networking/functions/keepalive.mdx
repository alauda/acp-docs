---
weight: 10
sourceSHA: 12ef1b43d08e20844d30a3f43e45879921c6e7e4da4d80b4c2e2e766e34d5ab2
---

# TCP/HTTP Keepalive

## Основная концепция

1. ALB поддерживает настройку keepalive на уровне порта. Его можно настроить на фронтенде.

2. Keepalive происходит **между клиентом и ALB, а не между ALB и бэкэндом**.

3. Он реализуется через конфигурацию Nginx, и Nginx **необходим и будет автоматически перезагружен** при изменении конфигурации.

4. TCP keepalive и HTTP keepalive - это две разные концепции:
   1. **TCP keepalive** - это функция протокола TCP, которая отправляет периодические пакеты проверки, чтобы выяснить, активно ли соединение, когда нет передачи данных. Это помогает обнаруживать и очищать мертвые соединения.
   2. **HTTP keepalive** (также известный как постоянные соединения) позволяет нескольким HTTP-запросам использовать одно и то же TCP-соединение, избегая накладных расходов на установление новых соединений. Это улучшает производительность, снижая задержки и использование ресурсов.

## CRD

```yaml
keepalive:
  properties:
    http:
      description: Downstream L7 keepalive
      properties:
        header_timeout:
          description: Тайм-аут заголовка keepalive. По умолчанию не установлен.
          type: string
        requests:
          description: Запросы keepalive. По умолчанию 1000.
          type: integer
        timeout:
          description: Тайм-аут keepalive. По умолчанию 75s.
          type: string
      type: object
    tcp:
      description: TCPKeepAlive определяет параметры TCP keepalive (SO_KEEPALIVE)
      properties:
        count:
          description: Опция сокета TCP_KEEPCNT.
          type: integer
        idle:
          description: Опция сокета TCP_KEEPIDLE.
          type: string
        interval:
          description: Опция сокета TCP_KEEPINTVL.
          type: string
      type: object
  type: object
```

Его можно настроить только на фронтенде.
