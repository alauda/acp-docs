---
weight: 10
sourceSHA: bb78fcac637824261646f0fe4d2386d1134f402ddd40071864f04155e538cf65
---

# HTTP Перенаправление

## Основная Концепция

HTTP перенаправление — это функция, предоставляемая ALB. Она будет напрямую возвращать код HTTP 30x для запроса, соответствующего правилу. Заголовок Location будет использоваться для указания клиенту на перенаправление на новый URL.

ALB поддерживает конфигурацию перенаправления на уровне порта и правил.

## CRD

```yaml
redirect:
  properties:
    code:
      type: integer
    host:
      type: string
    port:
      type: integer
    prefix_match:
      type: string
    replace_prefix:
      type: string
    scheme:
      type: string
    url:
      type: string
  type: object
```

Перенаправление может быть сконфигурировано на:

- Frontend: `.spec.config.redirect`
- Правило: `.spec.config.redirect`

## Аннотация Ingress

| Аннотация                                          | Описание                                                        |
| --------------------------------------------------- | ---------------------------------------------------------------- |
| nginx.ingress.kubernetes.io/permanent-redirect      | Соответствует URL в CR, по умолчанию установит код на 301        |
| nginx.ingress.kubernetes.io/permanent-redirect-code | Соответствует коду в CR                                        |
| nginx.ingress.kubernetes.io/temporal-redirect       | Соответствует URL в CR, по умолчанию установит код на 302        |
| nginx.ingress.kubernetes.io/temporal-redirect-code  | Соответствует коду в CR                                        |
| nginx.ingress.kubernetes.io/ssl-redirect            | Соответствует схеме в CR, по умолчанию установит схему на HTTPS |
| nginx.ingress.kubernetes.io/force-ssl-redirect      | Соответствует схеме в CR, по умолчанию установит схему на HTTPS |

### SSL-Redirect

1. SSL-redirect и force-ssl-redirect различаются тем, что SSL-redirect действует только тогда, когда у ingress есть сертификат для соответствующего домена, в то время как force-ssl-redirect действует независимо от наличия сертификата.
2. Для HTTPS портов, если только настроено SSL-redirect, перенаправление не будет установлено.

## Перенаправление на уровне порта

Когда перенаправление настроено на уровне порта, *все запросы* на этот порт будут перенаправлены в соответствии с конфигурацией перенаправления.

## Перенаправление на уровне правила

Когда перенаправление настроено на уровне правила, запрос, соответствующий этому правилу, будет перенаправлен в соответствии с конфигурацией перенаправления.
