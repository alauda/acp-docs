---
weight: 20
sourceSHA: 3635a11133b4532198949a9af060e2cdf233e37c6910c8a82d71e01c31174f5f
---

# Как правильно распределять ресурсы ЦП и памяти

Для предложенных характеристик платформы для **малых**, **средних**, **больших** и **настраиваемых** производственных сред, а также методов распределения ресурсов для **экземпляров** и **портов**, можно обратиться к следующим рекомендациям по развертыванию.

### Малое производственное окружение

Для небольших бизнес-масштабов, таких как наличие не более 5 узлов в кластере и использование только для запуска стандартных приложений, достаточно **одного** балансировщика нагрузки. Рекомендуется использовать его в режиме **высокой доступности** с как минимум 2 репликами для обеспечения стабильности в окружении.

Вы можете изолировать балансировщик нагрузки с помощью изоляции **портов**, позволяя нескольким проектам делить его.

Пиковый QPS, измеренный в лабораторной среде для этой спецификации, составляет примерно 300 запросов в секунду.

![](../assets/loadbalancer-mini.png)

### Среднее производственное окружение

Когда объем бизнеса достигает определенной величины, например, не более 30 узлов в кластере и необходимо обрабатывать высококонкурентные бизнес-процессы наряду с запуском стандартных приложений, **одного** балансировщика нагрузки по-прежнему будет достаточно. Рекомендуется использовать режим **высокой доступности** с минимум 3 репликами для поддержания стабильности в окружении.

Вы можете воспользоваться методами изоляции **портов** или распределения **экземпляров**, чтобы поделить балансировщик нагрузки между несколькими проектами. Конечно, вы также можете создать новые балансировщики нагрузки для индивидуального использования ядровыми проектами.

Пиковый QPS, измеренный в лабораторной среде для этой спецификации, составляет около 10,000 запросов в секунду.

![](../assets/loadbalancer-middle.png)

### Большое производственное окружение

Для больших объемов бизнеса, таких как наличие более 30 узлов в кластере и необходимость обработки высококонкурентных бизнес-процессов, а также длительных соединений с данными, рекомендуется использовать **несколько** балансировщиков нагрузки, каждый из которых должен быть в типе **высокой доступности** с как минимум 3 репликами для обеспечения стабильности в окружении.

Вы можете изолировать балансировщик нагрузки с помощью методов изоляции **портов** или распределения **экземпляров** для нескольких проектов, чтобы поделить его. Вы также можете создать новые балансировщики нагрузки для исключительного использования ядровыми проектами.

Пиковый QPS, измеренный в лабораторной среде для этой спецификации, составляет примерно 20,000 запросов в секунду.

![](../assets/loadbalancer-large.png)

### Рекомендации по развертыванию в особых сценариях

| Сценарий                           | Рекомендации по развертыванию                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ---------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Функциональное тестирование**    | Рекомендуется развертывать **один экземпляр** балансировщика нагрузки.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Тестовая среда**                | Если тестовая среда соответствует определению **малой** или **средней**, как указано выше, использование **однопортового** балансировщика нагрузки будет достаточным. Экземпляр балансировщика нагрузки может быть общим между **множеством проектов**.                                                                                                                                                                                                                                                                                                                                                                   |
| **Ядровые приложения**            | Рекомендуется использовать специальные балансировщики нагрузки исключительно для ядровых приложений.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Передача больших объемов данных** | Из-за минимального потребления памяти, вызванного самим балансировщиком нагрузки, достаточно зарезервировать 2Gi памяти даже для **большой** спецификации. Однако, если бизнес требует передачи больших объемов данных, что приведет к значительному потреблению памяти, объем памяти для балансировщика нагрузки должен быть увеличен соответственно. <br /><br /> Рекомендуется постепенно увеличивать объем памяти балансировщика нагрузки в сценариях **настраиваемой** спецификации, внимательно следя за использованием памяти, чтобы в конечном итоге достичь приемлемого размера памяти для разумных темпов использования. |

### Выбор режима использования балансировщика нагрузки

| Режим использования                                                                                         | Преимущества                                                                                                                                                                | Недостатки                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ----------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **(Рекомендуется) Выделите балансировщик нагрузки как ресурс экземпляра для одного проекта**                | <ul><li>Управление относительно простое.</li><li>Каждый проект имеет свой собственный балансировщик нагрузки, что обеспечивает изоляцию правил и разделение ресурсов без вмешательства.</li></ul> | В режиме сетевого хоста кластер должен иметь значительное количество доступных узлов для балансировщика нагрузки, что приводит к высоким требованиям к потреблению ресурсов.                                                                                                                                                                                                                                                                                                                                  |
| **Выделите балансировщик нагрузки как ресурс экземпляра для нескольких проектов**                         | Управление относительно простое.                                                                                                                                 | Поскольку все назначенные проекты имеют полные права доступа к экземпляру балансировщика нагрузки, когда один проект настраивает порты и правила балансировщика нагрузки, могут возникнуть следующие ситуации: <ul><li>Правила, настроенные этим проектом, могут повлиять на другие проекты.</li><li>Ошибки при конфигурации балансировщика нагрузки могут изменить настройки других проектов.</li><li>Запросы на трафик от конкретного бизнеса могут повлиять на общую доступность экземпляра балансировщика нагрузки.</li></ul> |
| **Динамически выделяйте ресурсы балансировщика нагрузки по портам, позволяя различным проектам использовать различные порты** | Правила между проектами изолируют их, обеспечивая отсутствие вмешательства.                                                                                                     | <ul><li>Сложность управления увеличивается. Администраторы платформ должны активно планировать и выделять порты для проектов и настраивать внешние сопоставления сервиса.</li><li>Уровень зрелости на основе портов ниже. В настоящее время его используют меньше клиентов, и требуется дальнейшая доработка функций.</li><li>Конфликты ресурсов. Все службы, использующие один и тот же балансировщик нагрузки, могут столкнуться со сценариями, когда одна служба негативно влияет на весь балансировщик нагрузки.</li></ul>                       |
