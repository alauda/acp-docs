---
sourceSHA: 30540f3e9ef256ffb4675b45e709f8967a89884864eee6b0617c612ede36755d
---

# Восстановление после неудачи расширения PVC

Когда расширение PVC дает сбой в Kubernetes, администраторы могут вручную восстановить состояние Утверждения постоянного тома (PVC) и отменить запрос на расширение.

### Процедура

1. Измените политику возврата для постоянного тома (PV), связанного с PVC, на `Retain`. Для этого отредактируйте соответствующий PV и установите поле `persistentVolumeReclaimPolicy` в значение `Retain`.

2. Удалите оригинальный PVC.

3. Вручную отредактируйте PV, чтобы удалить запись `claimRef` из его спецификаций. Это гарантирует, что новый PVC сможет связаться с этим PV, изменяя статус PV на `Available`.

4. Воссоздайте новый PVC с меньшим размером или размером, поддерживаемым используемым поставщиком хранилища.

5. Явно укажите поле `volumeName` в новом PVC, чтобы оно соответствовало оригинальному имени PV. Это гарантирует, что новый PVC точно свяжется с указанным PV.

6. Наконец, восстановите оригинальную политику возврата PV.

### Дополнительные советы

- Убедитесь, что используемый `StorageClass` имеет включенное расширение томов, установив `allowVolumeExpansion` в значение `true`.
- Выполняйте эти действия осторожно, чтобы избежать риска потери данных.
