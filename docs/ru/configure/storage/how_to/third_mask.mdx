---
sourceSHA: 320792699e4e9c90c6287bb05a9c5f40359d3d68bef1c19707cffd6a8ae80ed9
---

# Как аннотировать возможности стороннего хранилища

С увеличением использования как публичных, так и частных облачных сред интеграция стороннего хранилища становится все более важной. Этот гид проведет вас через процесс аннотирования возможностей стороннего хранилища с использованием ConfigMap, чтобы ваша платформа могла автоматически распознавать и отображать эти возможности.

## Шаг 1: Откройте конфигурацию класса хранилища

1. Перейдите в **Управление платформой** в пользовательском интерфейсе вашей платформы.
2. В левой боковой панели перейдите в **Управление хранилищем** > **Классы хранилища**.
3. Нажмите **Создать класс хранилища**, чтобы начать определение нового класса хранилища.

## Шаг 2: Заполните информацию о классе хранилища

Укажите следующие данные в форме:

| Поле              | Описание                                               |
| ----------------- | ------------------------------------------------------ |
| **Имя**           | Имя вашего нового класса хранилища.                   |
| **Класс хранилища** | Выберите или определите идентификатор класса хранилища.|
| **Управляющий**    | Введите имя управляющего, используемое вашим плагином хранилища. |

## Шаг 3: Аннотируйте возможности хранилища с помощью ConfigMap

Чтобы включить аннотации возможностей, создайте **ConfigMap** в пространстве имен `kube-public` с соответствующей меткой и форматом данных.

### Пример YAML:

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: sd-built-in
  namespace: kube-public
  labels:
    features.alauda.io/type: StorageDescription
data:
  storage.type1.com: |-
    type: Filesystem
    volumeMode:
    - Filesystem
    accessModes:
    - ReadWriteOnce
    - ReadWriteMany
    - ReadWriteOncePod
  storage.type2.com: |-
    type: Filesystem
    snapshot: true
    volumeMode:
    - Filesystem
    - Block
    accessModes:
    - ReadWriteOnce
    - ReadOnlyMany
    - ReadWriteOncePod
```

### Ключевые моменты:

- **metadata.name**: Должен начинаться с `sd-`, например, `sd-configmap1`.
- **metadata.namespace**: Должен быть `kube-public`.
- **metadata.labels**: Включайте `features.alauda.io/type = StorageDescription`.
- **data**:
  - Каждой **ключ** соответствует полю `provisioner` в классе хранилища.
  - Каждое **значение** является YAML-строкой, описывающей поддерживаемые возможности хранилища.

## Шаг 4: Поймите поддерживаемые поля возможностей хранилища

Вот поддерживаемые поля, которые вы можете определить в ConfigMap:

| Возможность     | Поле          | Опции                                                            | По умолчанию | Примечания                                                                                                       |
| ---------------- | ------------- | ----------------------------------------------------------------- | ------------ | ----------------------------------------------------------------------------------------------------------------- |
| **Тип**          | `type`       | `Filesystem`, `Block`                                             | —            | Если опущено или недействительно, тип отображается как неизвестный.                                             |
| **Снимок**       | `snapshot`   | `true`, `false`                                                   | `false`      | Если `false` или недействительно, создание снимков через UI формы отключено.                                   |
| **Режим тома**   | `volumeMode` | `Filesystem`, `Block`                                             | `Filesystem` | PVC с `Block` режимом не поддерживают монтирование каталогов.                                                  |
| **Режим доступа** | `accessModes`| `ReadWriteOnce`, `ReadOnlyMany`, `ReadWriteMany`, `ReadWriteOncePod` | —            | Если опущено или недействительно, доступный режим доступа не отображается через UI. `ReadWriteOncePod` в настоящее время не активен в форме. |

## Шаг 5: Завершите создание класса хранилища

После того как приведенные выше данные настроены:

1. Нажмите **Создать**, чтобы сохранить класс хранилища.
2. Платформа автоматически сопоставит `provisioner` с ConfigMap и аннотирует класс хранилища определенными возможностями.

## Дополнительно: Создайте PVC с использованием аннотированного класса хранилища

Когда вы создаете Запрос на постоянный объем (PVC) через **интерфейс формы**, только поддерживаемые возможности из аннотированного ConfigMap будут доступны. Неподдерживаемые опции не появятся.
