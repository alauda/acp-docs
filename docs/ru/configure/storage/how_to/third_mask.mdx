---
sourceSHA: 320792699e4e9c90c6287bb05a9c5f40359d3d68bef1c19707cffd6a8ae80ed9
---

# Как аннотировать возможности стороннего хранилища

С увеличением использования как публичных, так и частных облачных сред интеграция стороннего хранилища становится все более важной. Этот гид проведет вас через процесс аннотирования возможностей стороннего хранилища с использованием ConfigMap, чтобы ваша платформа могла автоматически распознавать и отображать эти возможности.

## Шаг 1: Открытие конфигурации класса хранения

1. Перейдите в раздел **Управление платформой** в пользовательском интерфейсе вашей платформы.
2. В левой боковой панели перейдите в **Управление хранилищем** > **Классы хранения**.
3. Нажмите **Создать класс хранения**, чтобы начать определение нового класса хранения.

## Шаг 2: Заполнение информации о классе хранения

Укажите следующие данные в форме:

| Поле              | Описание                                               |
| ----------------- | ----------------------------------------------------- |
| **Имя**           | Имя вашего нового класса хранения.                    |
| **Класс хранения**| Выберите или определите идентификатор класса хранения. |
| **Провайдер**     | Введите имя провайдера, используемого вашим плагином хранилища. |

## Шаг 3: Аннотирование возможностей хранения с помощью ConfigMap

Чтобы включить аннотации возможностей, создайте **ConfigMap** в пространстве имен `kube-public` с соответствующей меткой и форматом данных.

### Пример YAML:

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: sd-built-in
  namespace: kube-public
  labels:
    features.alauda.io/type: StorageDescription
data:
  storage.type1.com: |-
    type: Filesystem
    volumeMode:
    - Filesystem
    accessModes:
    - ReadWriteOnce
    - ReadWriteMany
    - ReadWriteOncePod
  storage.type2.com: |-
    type: Filesystem
    snapshot: true
    volumeMode:
    - Filesystem
    - Block
    accessModes:
    - ReadWriteOnce
    - ReadOnlyMany
    - ReadWriteOncePod
```

### Ключевые моменты:

- **metadata.name**: Должно начинаться с `sd-`, например, `sd-configmap1`.
- **metadata.namespace**: Должно быть `kube-public`.
- **metadata.labels**: Включает `features.alauda.io/type = StorageDescription`.
- **data**:
  - Каждая **ключ** соответствует полю `provisioner` в классе хранения.
  - Каждое **значение** является YAML-строкой, описывающей поддерживаемые способности хранилища.

## Шаг 4: Понимание поддерживаемых полей возможностей хранения

Вот поддерживаемые поля, которые вы можете определить в ConfigMap:

| Возможность      | Поле         | Опции                                                             | По умолчанию | Заметки                                                                                                         |
| ---------------- | -------------| ------------------------------------------------------------------| ------------ | ---------------------------------------------------------------------------------------------------------------- |
| **Тип**          | `type`      | `Filesystem`, `Block`                                             | —            | Если пропущено или недействительно, тип отображается как неизвестный.                                          |
| **Снимок**       | `snapshot`   | `true`, `false`                                                   | `false`      | Если `false` или недействительно, создание снимка через интерфейс формы отключено.                               |
| **Режим тома**   | `volumeMode` | `Filesystem`, `Block`                                             | `Filesystem` | PVC с режимом `Block` не поддерживают монтирование каталогов.                                                  |
| **Режим доступа**| `accessModes`| `ReadWriteOnce`, `ReadOnlyMany`, `ReadWriteMany`, `ReadWriteOncePod`| —            | Если пропущено или недействительно, режим доступа не может быть выбран через интерфейс. `ReadWriteOncePod` в настоящее время не поддерживается формой. |

## Шаг 5: Завершение работы с классом хранения

После того как указанные выше данные настроены:

1. Нажмите **Создать**, чтобы сохранить ваш класс хранения.
2. Платформа автоматически сопоставит `provisioner` с ConfigMap и аннотирует класс хранения определенными возможностями.

## Дополнительно: Создание PVC с использованием аннотированного класса хранения

Когда вы создаете Запрос на постоянный том (PVC) через **интерфейс формы**, будут доступны только поддерживаемые возможности из аннотированного ConfigMap. Неподдерживаемые опции не будут отображаться.
