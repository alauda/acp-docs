---
weight: 51
sourceSHA: 75136cec18072811832c8c5815a3d82eb9e8816fa36b5b780ba584df4e0c6635
---

# Общие эфемерные тома

Общие эфемерные тома в Kubernetes — это функция, которая позволяет вам создавать эфемерные (временные) тома на уровне пода, используя существующие классы хранения и драйверы CSI, без необходимости предварительного определения PersistentVolumeClaims (PVC).

Они сочетают в себе гибкость динамического выделения с простотой декларации томов на уровне пода.

- Это временные тома, которые автоматически:

  - создаются при запуске пода

  - удаляются при завершении пода

- Используют те же механизмы, что и PersistentVolumeClaim

- Требуют драйвера CSI (Container Storage Interface), который поддерживает динамическое выделение

## Пример эфемерных томов

Это автоматически создает временный PVC для пода, используя указанный `StorageClass`.

```shell
apiVersion: v1
kind: Pod
metadata:
  name: ephemeral-demo
spec:
  containers:
    - name: app
      image: busybox
      command: ["sh", "-c", "echo hello > /data/hello.txt && sleep 3600"]
      volumeMounts:
        - mountPath: /data
          name: ephemeral-volume
  volumes:
    - name: ephemeral-volume
      ephemeral: # [!code callout]
        volumeClaimTemplate:
          metadata:
            labels:
              type: временный
          spec:
            accessModes: [ "ReadWriteOnce" ]
            resources:
              requests:
                storage: 1Gi
            storageClassName: стандартный
```

<Callouts>
  1. `Pod` создаст `PVC`, используя этот шаблон.
</Callouts>

## Ключевые особенности

| Особенность             | Описание                                                       |
| ----------------------- | -------------------------------------------------------------- |
| **Эфемерный**          | Том удаляется, когда под удаляется                             |
| **Динамическое выделение** | Поддерживается любым драйвером CSI с динамическим выделением |
| **Нет отдельного PVC**  | VolumeClaim встроен непосредственно в спецификацию пода       |
| **Поддержка CSI**      | Работает с любым совместимым драйвером CSI (EBS, RBD, Longhorn и т. д.) |

## Когда использовать общие эфемерные тома

- Когда вам нужно временное хранилище с такими функциями, как:

  - Изменяемые тома

  - Снимки

  - Шифрование

  - Не локальное хранилище (например, облачное блочное хранилище)

- Идеально подходит для:

  - Кэширования промежуточных данных

  - Временных рабочих каталогов

  - Конвейеров, AI/ML рабочих процессов

## Чем они отличаются от emptyDir?

| Особенность          | `emptyDir`                  | Общий эфемерный том             |
| -------------------- | --------------------------- | -------------------------------- |
| Хранилище            | Локальный диск или память узла | Любая поддерживаемая CSI-база   |
| Функции хранения     | Базовые                     | Поддерживает снимки, шифрование и т. д. |
| Сценарий использования | Простое временное хранилище | Расширенные потребности в эфемерном хранилище |
| Переносимость        | Нет (привязан к узлу)      | Да (если том CSI можно подключить) |
