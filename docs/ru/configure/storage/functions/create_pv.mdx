---
weight: 50
sourceSHA: 25b8107be2a49ba56daed3a3cc9cbc75d3d84edfa3e0efabe20fc907f5096a59
---

# Создание PV

Вручную создайте статический постоянный том типа **HostPath** или **NFS Shared Storage**.

- **HostPath**: Монтирует файловый каталог с хоста, на котором находится контейнер, в указанном пути в контейнере (соответствует HostPath Kubernetes), позволяя контейнеру использовать файловую систему хоста для постоянного хранения. Если хост становится недоступным, HostPath может быть недоступен.

- **NFS Shared Storage**: NFS Shared Storage использует плагин хранения сообщества NFS CSI (Container Storage Interface), который более точно соответствует принципам проектирования Kubernetes и предоставляет возможности доступа клиентам для нескольких служб. Убедитесь, что в текущем кластере развернут **плагин хранения NFS** перед использованием.

## Предварительные условия

- Подтвердите размер создаваемого постоянного тома и убедитесь, что система хранения на заднем плане в настоящее время имеет вместимость, чтобы предоставить соответствующее хранилище.

- Получите адрес доступа к системе хранения на заднем плане, путь к файлу, который необходимо смонтировать, учетные данные (если требуется) и другую соответствующую информацию.

## Пример PersistentVolume

```yaml
# example-pv.yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: example-pv
spec:
  capacity:
    storage: 5Gi # [!code callout]
  accessModes:
    - ReadWriteOnce # [!code callout]
  persistentVolumeReclaimPolicy: Retain # [!code callout]
  storageClassName: manual # [!code callout]
  hostPath: # [!code callout]
    path: "/mnt/data"
```

<Callouts>
  1. Объем хранилища.
  2. Как том может быть смонтирован.
  3. Что происходит после удаления PVC (Сохранить, Удалить, Переработать).
  4. Название StorageClass (для динамического связывания).
  5. Тип хранилища на заднем плане.
</Callouts>

## Создание PV с помощью веб-консоли

1. Перейдите в **Управление платформой**.

2. В левой навигационной панели щелкните **Управление хранилищем** > **Постоянные тома (PV)**.

3. Нажмите **Создать постоянный том**.

4. Ознакомьтесь с приведенными ниже инструкциями и настройте параметры перед нажатием **Создать**.

### Информация о хранении

<table>
  <thead>
    <tr>
      <th>Тип</th>
      <th>Параметр</th>
      <th>Описание</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>HostPath</td>
      <td>Путь</td>
      <td>Путь к каталогу файлов на узле, поддерживающем том для хранения. Например: <code>/etc/kubernetes</code>.</td>
    </tr>

    <tr>
      <td rowSpan={3}>NFS Shared Storage</td>
      <td>Адрес сервера</td>
      <td>Адрес доступа к NFS серверу.</td>
    </tr>

    <tr>
      <td>Путь</td>
      <td>Путь монтирования файловой системы NFS на узле сервера, например, <code>/nfs/data</code>.</td>
    </tr>

    <tr>
      <td>Версия протокола NFS</td>
      <td>В настоящее время поддерживаемые версии протокола NFS на платформе это <code>v3</code>, <code>v4.0</code> и <code>v4.1</code>. Вы можете выполнить <code>nfsstat -s</code> на стороне сервера, чтобы просмотреть информацию о версиях.</td>
    </tr>
  </tbody>
</table>

## Создание PV с помощью CLI

```shell
kubectl apply -f example-pv.yaml
```

### Режимы доступа

Режимы доступа постоянного тома определяются соответствующими параметрами, установленными задним хранилищем.

| Режим доступа             | Значение                                         |
| ------------------------- | ----------------------------------------------- |
| **ReadWriteOnce (RWO)**  | Можно смонтировать в режиме чтения-записи с одного узла.  |
| **ReadWriteMany (RWX)**  | Можно смонтировать в режиме чтения-записи с нескольких узлов. |
| **ReadOnlyMany (ROX)**   | Можно смонтировать в режиме только для чтения с нескольких узлов.  |

### Политики восстановления

| Политика восстановления | Значение                                                                                                                                                                                                                                     |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Delete**              | Удаляет заявку на постоянный том одновременно с удалением связанного постоянного тома, а также ресурса объема хранения на заднем плане. <br />**Примечание**: Политика восстановления для PV типа NFS Shared Storage не поддерживает **Delete**. |
| **Retain**              | Даже при удалении заявки на постоянный том, связанный постоянный том и данные хранилища будут по-прежнему сохранены. Необходимо будет вручную обработать данные хранилища и удалить постоянный том после этого.                               |

## Связанные операции

Вы можете нажать ⋮ справа на странице списка или нажать **Операции** в верхнем правом углу страницы деталей, чтобы обновить или удалить постоянный том по мере необходимости.

Удаление постоянного тома применяется в следующих двух ситуациях:

- Удаление несвязанного постоянного тома: не был записан и больше не требуется для записи, что приведет к освобождению соответствующего пространства хранения после удаления.

- Удаление **Сохраненного** постоянного тома: заявка на постоянный том была удалена, но из-за политики сохранения, он не был удален одновременно. Если данные в постоянном томе были сохранены в другом хранилище или больше не нужны, их удаление также может освободить соответствующее пространство хранения.

## Дополнительный ресурс

- [Создание PVC](./create_pvc.mdx)
