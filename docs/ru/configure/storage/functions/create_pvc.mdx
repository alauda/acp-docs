---
weight: 50
i18n:
  title:
    en: Создание PVC
    zh: 创建 PVCs
sourceSHA: bc0076169cf388b6abae3948da29499657d1422dbc0d2614329f8bab468d1d61
---

# Создание PVC

Создайте PersistentVolumeClaim (PVC) и установите параметры для запрашиваемого PersistentVolume (PV) по мере необходимости.

Вы можете создать PersistentVolumeClaim как через визуальную форму UI, так и с помощью пользовательского YAML файла оркестрации.

## Предварительные требования

Убедитесь, что в пространстве имен достаточно оставшейся **памяти** для удовлетворения необходимого размера хранилища для этой операции создания.

## Пример PersistentVolumeClaim:

```yaml
# example-pvc.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: example-pvc
  namespace: k-1
  annotations: {}
  labels: {}
spec:
  storageClassName: cephfs
  accessModes:
    - ReadWriteOnce
  volumeMode: Filesystem
  resources:
    requests:
      storage: 4Gi
```

## Создание Persistent Volume Claim с использованием веб-консоли

1. Перейдите в **Container Platform**.

2. Нажмите на **Storage > PersistentVolumeClaims (PVC)** в левой боковой панели.

3. Нажмите на **Create PVC**.

4. Настройте параметры по мере необходимости.

   **Примечание**: Следующее содержимое предоставлено в качестве примера с использованием метода формы; вы также можете переключиться в режим YAML для завершения операции.

   | Параметр            | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
   | ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | **Имя**             | Имя PersistentVolumeClaim, которое должно быть уникальным в текущем пространстве имен.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   | **Метод создания**  | - Динамическое создание: Динамически генерирует PersistentVolume на основе класса хранения и связывает его. <br />- Статическое связывание: Соответствует и связывает на основе настроенных параметров и существующих PersistentVolumes.                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   | **Класс хранения**  | После выбора метода динамического создания платформа динамически создаст PersistentVolume в соответствии с описанием в указанном классе хранения.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   | **Режим доступа**   | - ReadWriteOnce (RWO): Может быть смонтирован одним узлом в режиме чтения-записи. <br />- ReadWriteMany (RWX): Может быть смонтирован несколькими узлами в режиме чтения-записи. <br />- ReadOnlyMany (ROX): Может быть смонтирован несколькими узлами в режиме только для чтения. <br /><br />**Совет**: Рекомендуется учитывать количество экземпляров рабочей нагрузки, которые планируется связать с текущим PersistentVolumeClaim, и тип контроллера развертывания. Например, при создании развертывания с несколькими экземплярами (Deployment), поскольку все экземпляры используют один и тот же PersistentVolumeClaim, не рекомендуется выбирать режим доступа RWO, который может быть прикреплен только к одному узлу. |
   | **Вместимость**     | Размер запрашиваемого PersistentVolume.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
   | **Режим тома**      | - Filesystem: Связывает PersistentVolume как файловый каталог, смонтированный в Pod. Этот режим доступен для любого типа рабочей нагрузки. <br />- Block Device: Связывает PersistentVolume как необработанное блочное устройство, смонтированное в Pod. Этот режим доступен только для виртуальных машин.                                                                                                                                                                                                                                                                                                                                                                           |
   | **Дополнительно**    | - Метки <br />- Аннотации <br />- Селектор: После выбора метода статического связывания вы можете использовать селектор для нацеливания на PersistentVolumes, которые помечены определенными тегами. Метки PersistentVolume могут использоваться для обозначения специальных атрибутов хранилища, таких как тип диска или географическое местоположение.                                                                                                                                                                                                                                                                                                                                                 |

5. Нажмите на **Create**. Подождите, пока статус PersistentVolumeClaim не изменится на `Bound`, что указывает на успешное соответствие PersistentVolume.

## Создание Persistent Volume Claim с использованием CLI

```shell
kubectl apply -f example-pvc.yaml
```

## Операции

- **Связать PersistentVolumeClaim**: При создании приложений или рабочих нагрузок, требующих постоянного хранения данных, свяжите PersistentVolumeClaim для запроса совместимого PersistentVolume.

- **Создать PersistentVolumeClaim с использованием снимков томов**: Это помогает резервировать данные приложений и восстанавливать их по мере необходимости, обеспечивая надежность данных бизнес-приложений. Пожалуйста, обратитесь к [Использование снимков томов](./using_volume_snapshot.mdx).

- **Удалить PersistentVolumeClaim**: Вы можете нажать кнопку **Actions** в правом верхнем углу страницы деталей, чтобы удалить PersistentVolumeClaim по мере необходимости. Перед удалением убедитесь, что PersistentVolumeClaim не связан с какими-либо приложениями или рабочими нагрузками и что он не содержит никаких снимков томов. После удаления PersistentVolumeClaim платформа обработает PersistentVolume в соответствии с политикой рекламации, что может очистить данные в PersistentVolume и освободить ресурсы хранения. Пожалуйста, действуйте осторожно, учитывая соображения безопасности данных.

## Расширение емкости хранения PersistentVolumeClaim с использованием веб-консоли

1. В левой навигационной панели нажмите Storage > Persistent Volume Claims (PVC).

2. Найдите постоянный том и нажмите ⋮ > Expand.

3. Заполните новую емкость.

4. Нажмите Expand. Процесс расширения может занять некоторое время, пожалуйста, наберитесь терпения.

## Расширение емкости хранения Persistent Volume Claim с использованием CLI

```shell
kubectl patch pvc example-pvc -n k-1 --type='merge' -p '{
  "spec": {
    "resources": {
      "requests": {
        "storage": "6Gi"
      }
    }
  }
}'
```

:::info
Когда расширение PVC не удается в Kubernetes, администраторы могут вручную восстановить состояние Persistent Volume Claim (PVC) и отменить запрос на расширение. См. [Восстановление после сбоя расширения PVC](../trouble_shooting/recovery_pvc_expansion.mdx)
:::

## Дополнительные ресурсы

- [Как аннотировать возможности стороннего хранилища](../how_to/third_mask.mdx)
