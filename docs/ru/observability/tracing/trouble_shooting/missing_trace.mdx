---
weight: 10
sourceSHA: 3394197f24ed6b6c88ad22b426c55d0181a0c13178c08d90b7318cd86d5022b6
---

# Невозможность запроса необходимого трассирования

## Описание проблемы

При запросе трассирования в сервисной сетке вы можете столкнуться с ситуациями, когда целевое трассирование не может быть получено.

## Анализ корневой причины

### 1. Скорость выборки трассирования настроена слишком низко

Когда параметр скорости выборки для трассирования установлен слишком низко, система будет собирать данные трассировки пропорционально. Во время недостаточного объема запросов или в периоды низкой нагрузки это может привести к тому, что sampled данные окажутся ниже порога видимости.

### 2. Ограничения в реальном времени Elasticsearch

Параметр конфигурации по умолчанию для индекса Elasticsearch составляет `"refresh_interval": "10s"`, что приводит к задержке в 10 секунд перед обновлением данных из буфера памяти в состояние, пригодное для поиска. При запросе недавно сгенерированного трассирования результаты могут отсутствовать, потому что данные еще не были зафиксированы.

Эта конфигурация индекса может эффективно снизить нагрузку на объединение данных в Elasticsearch, улучшая скорость индексирования и скорость первого запроса, но также снижает реальное время существования данных в некоторой степени.

## Решение для корневой причины 1

- Соответственно увеличьте скорость выборки в зависимости от требований.
- Используйте более богатые методы выборки, такие как выборка хвостов.

## Решение для корневой причины 2

Настройте интервал обновления через параметр запуска `--es.asm.index-refresh-interval` `jaeger-collector`, с значением по умолчанию `10s`.

Если значение этого параметра установлено в `"null"`, конфигурация для индекса `refresh_interval` не будет применена.

**Примечание**: Установка в `"null"` повлияет на производительность и скорость запросов Elasticsearch.
