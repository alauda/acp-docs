---
weight: 10
sourceSHA: 45f1fd723d5ec123f5b5c29264f6ca6cc6d32941b9be8be57b9cac97d9f3ff05
---

# Добавление пользовательских устройств с помощью ConfigMap

## Введение

- Реализует стандартизованное определение и управление пользовательскими ресурсами Kubernetes через ConfigMap, охватывая:
- Унитарное управление спецификациями пользовательских ресурсов для предотвращения фрагментации конфигураций
- Стандартизированный формат определения ресурсов для лучшей поддержки
- Поддержка многоязыкового описания и конфигурации значений по умолчанию
- Подходит для сценариев, требующих расширения модели ресурсов Kubernetes (например, управление ресурсами GPU), предоставляя стандартизированную структуру определения ресурсов

## Возможности

- Спецификация определения ресурса с одним ключом
- Связанное определение ресурса с несколькими ключами
- Стандартизованный интерфейс запроса ресурсов
- Поддержка двуязычного описания на китайском и английском языках
- Механизм конфигурации значений по умолчанию для ресурсов

## Преимущества

- **Расширяемость**: Управление группами ресурсов через метки
- **Безопасность**: Изоляция пространств имен (kube-public)
- **Стабильность**: Обязательные правила проверки формата
- **Поддерживаемость**: Унитарные спецификации метаданных меток

## Модуль функции 1: Спецификации авторинга ConfigMap

### Основные правила

1. **Принцип единственной ответственности**: Один ConfigMap для определения одного ключа

2. **Пространство имен**: Зафиксировано на `namespace=kube-public`

3. **Соглашение о наименовании**:
   ```
   cf-crl-{customName}-{keyName} 
   ```
   - `cf-crl`: Зафиксированный префикс
   - `customName`: Пользовательское допустимое имя
   - `keyName`: Идентификатор ключа (специальные символы заменены на '-')

4. **Требования к меткам**:
   ```yaml
   labels:
     features.alauda.io/type: CustomResourceLimitation  # Зафиксированное значение
     features.alauda.io/group: {resource-group}         # например, gpu-manager
     features.alauda.io/enabled: "true"               # Флаг активации
   ```

### Спецификация параметров

| Параметр       | Обязательный | Описание                              |
| :------------- | :----------: | :----------------------------------- |
| формат имени   |     Да       | Следует cf-crl-\{customName}-\{keyName} |
| пространство имен |   Да      | Зафиксировано на kube-public         |
| группа меток   |     Да       | Должна содержать указанные 3 метки признаков |

## Модуль функции 2: Определение значений ресурсов

### Пример с одним ключом

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: cf-crl-gpu-manager-vcuda-core
  namespace: kube-public
  labels:
    features.alauda.io/type: CustomResourceLimitation
    features.alauda.io/group: gpu-manager
    features.alauda.io/enabled: "true"
data:
  key: "tencent.com/vcuda-core"       # Ключ ресурса
  dataType: "integer"                # Тип значения
  defaultValue: "20"                 # Значение по умолчанию
  descriptionZh: "" # Описание на китайском
  descriptionEn: "Количество ядер GPU, 100 виртуальных ядер равны 1 физическому ядру GPU" # Описание на английском
  group: "gpu-manager"               # Группа ресурсов
  limits: "optional"                 # Политика поле лимитов
  requests: "disabled"               # Политика поле запросов
```

### Ассоциация с несколькими ключами

```yaml
metadata:
  name: cf-crl-gpu-manager-vcuda-core
  labels: [одни и те же метки группы]

metadata:
  name: cf-crl-gpu-manager-vcuda-memory
  labels: [одни и те же метки группы]  # Ассоциация через идентичные метки
```

### Спецификация политики

| Поле     | Допустимые значения               | Описание                      |
| -------- | ------------------------------- | ----------------------------- |
| limits   | disabled/required/optional      | Конфигурация лимитов ресурсов |
| requests | disabled/required/fromLimits    | Конфигурация запросов ресурсов |
