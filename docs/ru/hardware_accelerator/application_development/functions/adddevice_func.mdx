---
weight: 20
sourceSHA: aa1e3ebc4db7692a779a539696056bb435eae6079f95e4d6a04ab9cd3626917e
---

# Добавление пользовательских устройств с использованием ConfigMap

## Введение

- Реализует стандартизированное определение и управление пользовательскими ресурсами Kubernetes через ConfigMap, решая:
- Унифицированное управление спецификациями пользовательских ресурсов для предотвращения фрагментации конфигурации
- Стандартизированный формат определения ресурсов для лучшей поддерживаемости
- Поддержка многоязычного описания и конфигурации значений по умолчанию
- Подходит для сценариев, требующих расширения модели ресурсов Kubernetes (например, управление ресурсами GPU), предоставляя стандартизированную структуру определения ресурсов

## Особенности

- Спецификация определения ресурса с одним ключом
- Связанное определение ресурса с несколькими ключами
- Стандартизированный интерфейс запроса ресурсов
- Поддержка двуязычного описания на китайском и английском языках
- Механизм конфигурации значений по умолчанию для ресурсов

## Преимущества

- **Расширяемость**: Управление группами ресурсов через метки
- **Безопасность**: Изоляция пространств имен (kube-public)
- **Стабильность**: Принудительные правила валидации формата
- **Поддерживаемость**: Унифицированные спецификации метаданных меток

## Модуль функции 1: Спецификации авторинга ConfigMap

### Основные правила

1. **Принцип единственной ответственности**: Один ConfigMap на определение ключа

2. **Пространство имен**: Зафиксировано на `namespace=kube-public`

3. **Конвенция именования**:
   ```
   cf-crl-{customName}-{keyName} 
   ```
   - `cf-crl`: Зафиксированный префикс
   - `customName`: Пользовательское допустимое имя
   - `keyName`: Идентификатор ключа (специальные символы заменяются на '-')

4. **Требования к меткам**:
   ```yaml
   labels:
     features.alauda.io/type: CustomResourceLimitation  # Зафиксированное значение
     features.alauda.io/group: {resource-group}         # например, gpu-manager
     features.alauda.io/enabled: "true"               # Флаг активации
   ```

### Спецификация параметров

| Параметр   | Обязательный | Описание                             |
| :---------- | :------: | :-------------------------------------- |
| формат имени |    Да   | Следует cf-crl-\{customName}-\{keyName} |
| пространство имен   |    Да   | Зафиксировано как kube-public                    |
| группа меток |    Да   | Должна содержать указанные 3 метки функций |

## Модуль функции 2: Определение значений ресурсов

### Пример с одним ключом

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: cf-crl-gpu-manager-vcuda-core
  namespace: kube-public
  labels:
    features.alauda.io/type: CustomResourceLimitation
    features.alauda.io/group: gpu-manager
    features.alauda.io/enabled: "true"
data:
  key: "tencent.com/vcuda-core"       # Ключ ресурса
  dataType: "integer"                # Тип значения
  defaultValue: "20"                 # Значение по умолчанию
  descriptionZh: "" # Описание на китайском
  descriptionEn: "Количество GPU vcore, 100 виртуальных ядер равны 1 физическому ядру GPU" # Описание на английском
  group: "gpu-manager"               # Группа ресурсов
  limits: "optional"                 # Политика поля лимитов
  requests: "disabled"               # Политика поля запросов
```

### Ассоциация с несколькими ключами

```yaml
metadata:
  name: cf-crl-gpu-manager-vcuda-core
  labels: [одинаковые метки группы]

metadata:
  name: cf-crl-gpu-manager-vcuda-memory
  labels: [одинаковые метки группы]  # Ассоциация через идентичные метки
```

### Спецификация политики

| Поле    | Допустимые значения               | Описание                     |
| -------- | ---------------------------- | ------------------------------- |
| limits   | disabled/required/optional   | Конфигурация лимитов ресурсов   |
| requests | disabled/required/fromLimits | Конфигурация запросов ресурсов |
