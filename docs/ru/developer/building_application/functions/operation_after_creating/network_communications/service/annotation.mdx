---
weight: 20
sourceSHA: 0e1c2cf8619f5e471b268134b66b77ea5a4204709936494244d48ba22e4e14b5
---

# Аннотации для сервиса типа LoadBalancer

Сервисы типа LoadBalancer могут быть настроены с различными аннотациями в зависимости от окружения кластера для достижения определенной функциональности. Разные облачные провайдеры и локальные среды поддерживают различные конфигурации аннотаций. Пожалуйста, обратитесь к следующим разделам для получения подробных инструкций по использованию аннотаций для вашего конкретного окружения.

## Локальный кластер с MetalLB

Для подробных объяснений аннотаций MetalLB, пожалуйста, обратитесь к [документации по использованию](https://metallb.io/usage/).

| Ключ                                 | Значение                                                     | Описание                                                                                                                    |
| ------------------------------------ | ----------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| metallb.universe.tf/loadBalancerIPs | `1.2.3.4` или `1.2.3.4,3000::1` для нескольких IP-адресов | Запрос конкретных IP-адресов для этого сервиса. IP-адрес должен находиться в одном `IPAddressPool` и не использоваться другим сервисом. |
| metallb.universe.tf/address-pool    | Имя `IPAddressPool`. например, `production-public-ips`    | Запрос IP из конкретного `IPAddressPool`.                                                                               |
| metallb.universe.tf/allow-shared-ip | Ключ для совместного использования. например, `key-to-share-1.2.3.4` | Сервисы с одинаковым ключом совместного использования могут делить один IP-адрес.                                         |

## Кластер AWS EKS

Для подробных объяснений аннотаций сервиса LoadBalancer EKS, пожалуйста, обратитесь к [документации по использованию аннотаций](https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.5/guide/service/annotations/) .

| Ключ                                                          | Значение                                                                                                                                                             | Описание                                                                                                                                                                 |
| ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| service.beta.kubernetes.io/aws-load-balancer-type            | external: Используйте официальный контроллер AWS LoadBalancer.                                                                                                     | Указывает контроллер для типа LoadBalancer.<br /><br /><b>Примечание</b>: Пожалуйста, свяжитесь с администратором платформы заранее для развертывания контроллера AWS LoadBalancer. |
| service.beta.kubernetes.io/aws-load-balancer-nlb-target-type | <ul><li>instance: Трафик будет отправляться на поды через NodePort.</li><li>ip: Трафик направляется непосредственно на поды (кластер должен использовать Amazon VPC CNI).</li></ul> | Указывает, как трафик достигает подов.                                                                                                                                     |
| service.beta.kubernetes.io/aws-load-balancer-scheme          | <ul><li>internal: Частная сеть.</li><li>internet-facing: Публичная сеть.</li></ul>                                                                                 | Указывает, следует ли использовать частную сеть или публичную сеть.                                                                                                     |
| service.beta.kubernetes.io/aws-load-balancer-ip-address-type | <ul><li>ipv4</li><li>dualstack</li></ul>                                                                                                                            | Указывает поддерживаемый стек IP-адресов.                                                                                                                                   |

## Кластер Huawei Cloud CCE

Для подробных объяснений аннотаций сервиса LoadBalancer CCE, пожалуйста, обратитесь к [документации по использованию аннотаций](https://support.huaweicloud.com/intl/zh-cn/usermanual-cce/cce_10_0385.html) .

| Ключ                            | Значение                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Описание                                                                                                                                                                                                                       |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| kubernetes.io/elb.id           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Укажите ID облачного балансировщика нагрузки, должен использовать существующий облачный балансировщик нагрузки.                                                                                                                                              |
| kubernetes.io/elb.autocreate   | Пример: `{"type":"public","bandwidth_name":"cce-bandwidth-1551163379627","bandwidth_chargemode":"bandwidth","bandwidth_size":5,"bandwidth_sharetype":"PER","eip_type":"5_bgp","available_zone":["cn-north-4b"],"l4_flavor_name":"L4_flavor.elb.s1.small"}`<br /><br /><b>Примечание</b>: Пожалуйста, сначала прочитайте [инструкции по заполнению](https://support.huaweicloud.com/intl/zh-cn/usermanual-cce/cce_10_0385.html#section8) и при необходимости скорректируйте параметры примера. | Новый облачный балансировщик нагрузки будет создан.                                                                                                                                                                                            |
| kubernetes.io/elb.subnet-id    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | ID подсети, в которой находится кластер. Когда версия Kubernetes 1.11.7-r0 или ниже, это поле должно быть заполнено при создании нового облачного балансировщика нагрузки.                                                          |
| kubernetes.io/elb.class        | <ul><li>union: Совместное балансирование нагрузки.</li><li>performance: Эксклюзивное балансирование нагрузки, поддерживается только в версиях Kubernetes 1.17 и выше.</li></ul>                                                                                                                                                                                                                                                                                                                | Указывает тип нового облачного балансировщика нагрузки, который будет создан, пожалуйста, обратитесь к [различиям между эксклюзивным и совместным эластичным балансированием нагрузки](https://support.huaweicloud.com/intl/zh-cn/productdesc-elb/elb_pro_0004.html). |
| kubernetes.io/elb.enterpriseID |                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Указывает проект предприятия, к которому принадлежит вновь созданный облачный балансировщик нагрузки.                                                                                                                                          |

## Кластер Azure AKS

Для подробных объяснений аннотаций сервиса LoadBalancer AKS, пожалуйста, обратитесь к [документации по использованию аннотаций](https://cloud-provider-azure.sigs.k8s.io/topics/loadbalancer/#loadbalancer-annotations) .

| Ключ                                                     | Значение                                                                   | Описание                                                     |
| ------------------------------------------------------- | ------------------------------------------------------------------------- | ------------------------------------------------------------- |
| service.beta.kubernetes.io/azure-load-balancer-internal | <ul><li>true: Частная сеть.</li><li>false: Публичная сеть.</li></ul>     | Указывает, следует ли использовать частную сеть или публичную сеть. |

## Кластер Google GKE

Для подробных объяснений аннотаций сервиса LoadBalancer GKE, пожалуйста, обратитесь к [документации по использованию аннотаций](https://cloud.google.com/kubernetes-engine/docs/concepts/service-load-balancer-parameters?hl=zh-cn) .

| Ключ                                  | Значение    | Описание                                                                                   |
| ------------------------------------- | ----------- | --------------------------------------------------------------------------------------------- |
| networking.gke.io/load-balancer-type | Internal    | Указывает на использование частной сети.                                                       |
| loud.google.com/l4-rbs               | enabled     | По умолчанию публичный. Если этот параметр настроен, трафик будет направляться непосредственно на поды. |
