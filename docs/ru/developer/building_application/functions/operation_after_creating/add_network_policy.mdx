---
weight: 40
i18n:
  title:
    en: Configuring Network Policies
    zh: 配置网络策略
title: Настройка сетевых политик
sourceSHA: 260351b84b1a7795535337f2169184b803fe9224320f9e364053a2cc426f42db
---

# Настройка сетевых политик

:::info
Платформа теперь предоставляет два разных интерфейса для сетевых политик. Старый сохраняется по соображениям совместимости, в то время как новый более гибкий и предоставляет встроенный редактор YAML. Мы рекомендуем использовать новую версию.

Пожалуйста, свяжитесь с администратором платформы, чтобы включить функциональность `network-policy-next` и получить доступ к новому интерфейсу.
:::

Сетевые политики (NetworkPolicy) — это ресурсы Kubernetes с областью действия на пространство имен, реализуемые плагинами CNI.
С помощью сетевых политик вы можете контролировать сетевой трафик Pods, достигая сетевой изоляции и уменьшая риск атак.

По умолчанию все Pods могут свободно общаться, разрешая входящий и исходящий трафик из любого источника.
Когда применяется сетевой полис, целевые Pods будут принимать только тот трафик, который соответствует спецификации.

:::warning
Сетевые политики применяются только к трафику контейнеров. Они не затрагивают Pods, работающие в режиме **hostNetwork**.
:::

## Шаги

1. Войдите в **Контейнерную платформу**.

2. В левой навигационной панели нажмите **Сеть** > **Сетевые политики**.

3. Нажмите **Создать сетевую политику**.

4. Используйте следующие инструкции, чтобы выполнить соответствующие настройки.

   <table>
     <thead>
       <tr>
         <th>Область</th>
         <th colSpan={2}>Параметр</th>
         <th>Описание</th>
       </tr>
     </thead>

     <tbody>
       <tr>
         <td rowSpan={2}>Целевой Pod</td>
         <td colSpan={2}>Выбор Pods</td>
         <td>Введите метки целевых Pods в формате ключ-значение; если не указано, будет применяться ко всем Pods в текущем пространстве имен.</td>
       </tr>

       <tr>
         <td colSpan={2}>Предварительный просмотр целевых Pods, затронутых текущей политикой</td>
         <td>Нажмите <b>Предварительный просмотр</b>, чтобы увидеть целевые Pods, затронутые этой сетевой политикой.</td>
       </tr>

       <tr>
         <td rowSpan={5}>Входящий трафик</td>
         <td colSpan={2}>Блокировать весь входящий трафик</td>
         <td>Блокировать весь входящий трафик к целевому Pod. <br /><br /><b>Примечание</b>:<ul><li>Если входящий трафик добавляется в поле `spec.policyTypes` в YAML без настройки конкретных правил, параметр <b>Блокировать весь входящий трафик</b> автоматически будет отмечен при возврате к форме.</li><li>Если поля `spec.ingress`, `spec.egress` и `spec.policyTypes` одновременно удаляются в YAML, параметр <b>Блокировать весь входящий трафик</b> автоматически будет отмечен при возврате к форме.</li></ul></td>
       </tr>

       <tr>
         <td rowSpan={3}>Правила<br /><br /><b>Описание</b>: Если в правилах добавлены несколько источников, между ними существует логическое <b>ИЛИ</b>.</td>
         <td>Pods в текущем пространстве имен</td>
         <td>Сопоставить Pods с указанными метками в текущем пространстве имен; только совпадающие Pods могут получить доступ к целевому Pod. Вы можете нажать <b>Предварительный просмотр</b>, чтобы увидеть Pods, затронутые текущим правилом. Если этот пункт не настроен, всем Pods в текущем пространстве имен по умолчанию разрешен доступ к целевому Pod.</td>
       </tr>

       <tr>
         <td>Pods в текущем кластере</td>
         <td>Сопоставить пространства имен или Pods с указанными метками в кластере; только совпадающие Pods могут получить доступ к целевому Pod. Вы можете нажать <b>Предварительный просмотр</b>, чтобы увидеть Pods, затронутые текущим правилом. <ul><li>Если и пространственное, и выбор Pods настроены, будет использоваться их пересечение, то есть Pods с указанными метками будут выбраны из указанного пространства имен.</li><li>Если этот пункт не настроен, все Pods из всех пространств имен в кластере могут получить доступ к целевому Pod по умолчанию.</li></ul></td>
       </tr>

       <tr>
         <td>Диапазон IP</td>
         <td>Введите CIDR, который может получить доступ к целевому Pod, и можно исключить диапазоны CIDR, которым не разрешен доступ к целевому Pod. Если этот пункт не настроен, любой трафик может получить доступ к целевому Pod.<br /><br /><b>Описание</b>: Вы можете добавить элементы исключения в форме <i>exampleip</i>/32, чтобы исключить один IP-адрес.</td>
       </tr>

       <tr>
         <td colSpan={2}>Порт</td>
         <td>Сопоставить трафик по указанным протоколам и портам; могут быть добавлены числовые порты или имена портов на Pods. Если этот пункт не настроен, будут сопоставлены все порты.</td>
       </tr>

       <tr>
         <td rowSpan={5}>Исходящий трафик</td>
         <td colSpan={2}>Блокировать весь исходящий трафик</td>
         <td>Блокировать весь исходящий трафик к целевому Pod. <br /><br /><b>Примечание</b>:<ul><li>Если исходящий трафик добавляется в поле `spec.policyTypes` в YAML без настройки конкретных правил, параметр <b>Блокировать весь исходящий трафик</b> автоматически будет отмечен при возврате к форме.</li></ul></td>
       </tr>

       <tr>
         <td colSpan={2}>Другие параметры</td>
         <td>По аналогии с параметрами **Входящего трафика**, здесь не будет углубления.</td>
       </tr>
     </tbody>
   </table>

5. Нажмите **Создать**.

## Справка

Если вам нужно больше деталей, посмотрите официальную документацию по [сетевым политикам](https://kubernetes.io/docs/concepts/services-networking/network-policies/).
