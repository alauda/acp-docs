---
weight: 20
sourceSHA: 50a71ed4f4bd316160593a2371cdf2fb141654f99e6d8eab4191bfe1b0956b80
---

# Настройка HPA

Для безсостояний приложений HPA (Horizontal Pod Autoscaler) автоматически регулирует количество подов вверх или вниз в зависимости от ваших бизнес-требований и заранее заданных политик, чтобы справляться с внезапными всплесками нагрузки или экономить ресурсы для других приложений.

## Предварительные требования

Пожалуйста, убедитесь, что компоненты мониторинга развернуты в текущем кластере и функционируют должным образом. Вы можете проверить развертывание и состояние здоровья компонентов мониторинга, нажав в правом верхнем углу платформы <span style={{ display: 'inline-flex', alignItems: 'center', gap: '4px', verticalAlign: 'middle' }}><img src="../../../../../en/developer/building_application/functions/operation_after_creating/assets/question.png" alt="expand" style={{ verticalAlign: 'middle' }} /> <span>  > **Состояние здоровья платформы**.</span></span>.

## Шаги выполнения

1. Войдите в **Контейнерную платформу**.

2. В левой навигационной панели нажмите **Рабочие нагрузки** > **Развертывания**.

3. Щелкните на ***Имя развертывания***.

4. Прокрутите вниз до области **Эластичное масштабирование** и нажмите **Обновить** справа.

5. Выберите **Горизонтальное масштабирование** и завершите настройку политики.

   | Параметр                      | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   | ------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Количество подов**                  | После успешного создания развертывания вам необходимо оценить **Минимальное количество подов**, соответствующее известным и регулярным изменениям бизнес-объема, а также **Максимальное количество подов**, которое может быть поддержано квотой пространства имен при высокой нагрузке. Максимальные или минимальные количества подов могут быть изменены после установки, и рекомендуется сначала получить более точное значение через тестирование производительности и непрерывно корректировать в процессе использования, чтобы соответствовать бизнес-требованиям.                                                                                         |
   | **Политика триггера**             | Список **Метрик**, которые чувствительны к изменениям в бизнесе, и их **Целевые пороги** для запуска действий по увеличению или уменьшению масштаба. <br /> Например, если вы установите *Использование CPU = 60%*, как только использование CPU отклонится от 60%, платформа начнет автоматически корректировать количество подов на основе недостаточного или избыточного распределения ресурсов текущего развертывания. <br /> **Примечание**: Типы метрик включают встроенные метрики и пользовательские метрики. Пользовательские метрики применяются только к развертываниям в нативных приложениях, и вы должны сначала [добавить пользовательские метрики]() . |
   | **Шаг увеличения/уменьшения (Alpha)** | Для бизнеса с конкретными требованиями к скорости масштабирования вы можете постепенно адаптироваться к изменениям в бизнес-объеме, указав **Шаг увеличения** или **Шаг уменьшения**. <br /> Для шага уменьшения вы можете настроить **Окно стабильности**, которое по умолчанию составляет 300 секунд, что означает, что необходимо подождать 300 секунд перед выполнением действий по уменьшению масштаба.                                                                                                                                                                                                                           |

6. Нажмите **Обновить**.

**Примечания**:

- Для метрик **Использование CPU** и **Использование памяти** автоматическое масштабирование будет запускаться только тогда, когда фактическое значение колеблется за пределами диапазона ±10% целевого порога.

- Уменьшение масштаба может повлиять на текущие бизнес-операции; пожалуйста, действуйте с осторожностью.

## Правила расчета

Когда бизнес-метрики изменяются, платформа автоматически рассчитывает целевое количество подов, которое соответствует бизнес-объему, согласно следующим правилам, и корректирует его соответственно. Если бизнес-метрики продолжают колебаться, значение будет скорректировано до установленного **Минимального количества подов** или **Максимального количества подов**.

- Целевое количество подов для одиночной политики: ceil\[(sum(фактические значения метрики)/порог метрики)] . Это означает, что сумма фактических значений метрики всех подов делится на порог метрики, округляется вверх до наименьшего целого числа, которое больше или равно результату. Например: Если в настоящее время есть 3 пода с использованием ЦП 80%, 80% и 90%, и установленный порог использования ЦП составляет 60%. Согласно формуле количество подов будет автоматически скорректировано до: ceil\[(80%+80%+90%)/60%] = ceil 4.1 = 5 подов.

  **Примечание**:

  - Если рассчитанное целевое количество подов превышает установленное **Максимальное количество подов** (например, *4*), платформа увеличит количество подов только до 4. Если после изменения максимального количества подов метрики продолжают оставаться высокими, возможно, вам потребуется использовать альтернативные методы масштабирования, такие как увеличение квоты подов пространства имен или добавление аппаратных ресурсов.

  - Если рассчитанное целевое количество подов (в предыдущем примере *5*) меньше количества подов, скорректированного в соответствии с **Шагом увеличения** (например, *10*), платформа увеличит количество подов только до 5.

- Целевое количество подов для нескольких политик: выбрать максимальное значение среди результатов каждого расчета политики.
