---
weight: 20
sourceSHA: 50a71ed4f4bd316160593a2371cdf2fb141654f99e6d8eab4191bfe1b0956b80
---

# Настройка HPA

Для безстатусных приложений HPA (Horizontal Pod Autoscaler) автоматически регулирует количество подов вверх или вниз на основе ваших бизнес-требований и заранее установленных политик, чтобы справляться с резкими всплесками нагрузки или выделять ресурсы для других приложений.

## Предварительные требования

Пожалуйста, убедитесь, что компоненты мониторинга развернуты в текущем кластере и функционируют правильно. Вы можете проверить статус развертывания и здоровья компонентов мониторинга, кликнув в верхнем правом углу платформы <span style={{ display: 'inline-flex', alignItems: 'center', gap: '4px', verticalAlign: 'middle' }}><img src="../../../../../en/developer/building_application/functions/operation_after_creating/assets/question.png" alt="expand" style={{ verticalAlign: 'middle' }} /> <span>  > **Статус здоровья платформы**.</span></span>.

## Этапы операции

1. Войдите в раздел **Container Platform**.

2. В левом навигационном меню нажмите **Рабочие нагрузки** > **Развертывания**.

3. Нажмите на ***Имя развертывания***.

4. Прокрутите вниз до области **Эластичное масштабирование** и нажмите **Обновить** справа.

5. Выберите **Горизонтальное масштабирование** и завершите настройку политик.

   | Параметр                      | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   | ------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Количество подов**          | После успешного создания развертывания вам необходимо оценить **Минимальное количество подов**, соответствующее известным и регулярным изменениям объема бизнеса, а также **Максимальное количество подов**, которое может поддерживаться в пределах квоты пространства имен при высоком бизнес-нагрузке. Максимальное или минимальное количество подов можно изменить после установки. Рекомендуется сначала вывести более точное значение с помощью тестирования производительности, а затем постоянно настраивать его в процессе использования для удовлетворения бизнес-требований.                                                                                         |
   | **Политика триггера**        | Перечислите **Метрики**, которые чувствительны к изменениям в бизнесе, и их **Целевые пороги** для запуска действий по масштабированию вверх или вниз. <br /> Например, если вы установите *Использование ЦП = 60%*, как только использование ЦП отклонится от 60%, платформа начнет автоматически корректировать количество подов на основе недостаточного или избыточного распределения ресурсов в текущем развертывании. <br /> **Примечание**: Типы метрик включают встроенные метрики и пользовательские метрики. Пользовательские метрики применимы только к развертываниям в родных приложениях, и вы должны сначала [добавить пользовательские метрики]() . |
   | **Шаг масштабирования вверх/вниз (Alpha)** | Для бизнесов с конкретными требованиями к скорости масштабирования вы можете постепенно адаптироваться к изменениям в объеме бизнеса, указав **Шаг увеличения** или **Шаг уменьшения**. <br /> Для шага уменьшения вы можете настроить **Интервал стабильности**, который по умолчанию составляет 300 секунд, что означает, что вы должны подождать 300 секунд перед выполнением действий по уменьшению.                                                                                                                                                                                                                           |

6. Нажмите **Обновить**.

**Примечания**:

- Для метрик **Использование ЦП** и **Использование памяти** автоматическое масштабирование будет инициироваться только тогда, когда фактическое значение колеблется за пределами диапазона ±10% от целевого порога.

- Уменьшение масштаба может повлиять на текущие бизнес-операции; пожалуйста, действуйте осторожно.

## Правила расчета

Когда бизнес-метрики изменяются, платформа автоматически вычисляет целевое количество подов, которое соответствует объему бизнеса, в соответствии со следующими правилами и корректирует его соответственно. Если бизнес-метрики продолжают колебаться, значение будет скорректировано до установленного **Минимального количества подов** или **Максимального количества подов**.

- Целевое количество подов для одной политики: ceil\[(sum(фактические значения метрик) / порог метрики)] . Это означает, что сумма фактических значений метрик всех подов делится на порог метрики, округляется до ближайшего большего целого числа. Например: если в настоящее время 3 пода с использованием ЦП 80%, 80% и 90%, а установленный порог использования ЦП составляет 60%. Согласно формуле количество подов будет автоматически скорректировано до: ceil\[(80% + 80% + 90%) / 60%] = ceil 4.1 = 5 подов.

  **Примечание**:

  - Если рассчитанное целевое количество подов превышает установленное **Максимальное количество подов** (например, *4*), платформа будет масштабироваться только до 4 подов. Если после изменения максимального количества подов метрики остаются постоянно высокими, возможно, вам потребуется использовать альтернативные методы масштабирования, такие как увеличение квоты подов пространства имен или добавление аппаратных ресурсов.

  - Если рассчитанное целевое количество подов (в предыдущем примере *5*) меньше количества подов, скорректированного в соответствии с **Шагом увеличения** (например, *10*), платформа будет масштабироваться только до 5 подов.

- Целевое количество подов для нескольких политик: брать максимальное значение среди результатов расчета каждой политики.
