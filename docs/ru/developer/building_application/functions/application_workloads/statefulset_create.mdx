---
weight: 30
i18n:
  title:
    en: StatefulSets
    zh: 有状态副本集
title: Создание StatefulSets
sourceSHA: 9b03565db7ec4988bd698ce36133bd654a0d05742edb70315da4a1635b88b20a
---

# StatefulSets

## Понимание StatefulSets

Смотрите официальную документацию Kubernetes: [StatefulSets](https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/)

**StatefulSet** — это контроллер Kubernetes, предназначенный для управления состоянием приложений, организуя экземпляры Pod с стабильными сетевыми идентичностями и постоянным хранилищем. В рамках одной архитектуры приложения вы можете развернуть несколько StatefulSets в качестве отдельных компонентов для предоставления специализированных услуг, сохраняя при этом упорядоченное развертывание, масштабирование и поэтапные обновления.

## Предварительные требования

Получите адрес изображения. Источник изображений может быть из репозитория изображений, интегрированного администратором платформы через инструментальную цепочку, или из репозиториев изображений сторонних платформ.

- В первом случае администратор обычно назначает репозиторий изображений вашему проекту, и вы можете использовать изображения в нем. Если требуемый репозиторий изображений не найден, пожалуйста, свяжитесь с администратором для выделения.

- Если это репозиторий изображений сторонней платформы, убедитесь, что изображения могут быть извлечены непосредственно из него в текущем кластере.

## Процедура

1. На **Платформе контейнеров** перейдите в **Нагрузки** > **StatefulSets** в левом боковом меню.

2. Нажмите **Создать StatefulSet**.

3. **Выберите** или **Введите** изображение и нажмите **Подтвердить**.

   **Примечание**: Вы можете фильтровать изображения, выбирая только при использовании изображений из интегрированного репозитория изображений этой платформы. Например, интегрированное имя проекта, такое как *контейнеры (docker-registry-projectname)*, включает имя проекта *projectname* от этой платформы и имя проекта *контейнеры* из репозитория изображений.

### Настроить Основную информацию

В разделе **Основная информация** настройте декларативные параметры для рабочих нагрузок Развертывания:

| **Параметры**             | **Описание**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| :------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Реплики**               | Определяет желаемое количество реплик Pod в Развертывании (по умолчанию: `1`). Настройте в зависимости от требований нагрузки. Пожалуйста, установите это в соответствии с фактическим объемом запросов бизнеса.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Стратегия обновления**   | Управляет поэтапными обновлениями в поэтапных обновлениях StatefulSet: <br />1. **Значение раздела**: <ul><li> Указывает порядковый порог для обновлений Pod.</li></ul> 2. **Поведение**: <ul><li> Pod с порядковым номером ≥ значение раздела будут обновлены немедленно. </li><li> Pod с порядковым номером \< значение раздела сохраняют предыдущий шаблон. </li></ul>  3. **Недопустимый случай**: <ul><li> Если раздел > количество реплик, считается 0 </li></ul> **Пример**: <ul><li> Реплики=5 (Pods: web-0 \~ web-4)</li><li> Раздел=3 → Обновляет только web-3 и web-4. </li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Шаблоны запросов хранилища** | `volumeClaimTemplates` — ключевая функция StatefulSets, которая позволяет **динамическое выделение постоянного хранилища на Pod**. Каждая реплика Pod в StatefulSet автоматически получает свой собственный выделенный PersistentVolumeClaim (PVC) на основе предопределенных шаблонов.<br /> 1. **Динамическое создание PVC**: Автоматически создает уникальные PVC для каждого Pod:<ul><li> Шаблон именования: `<statefulset-name>-<claim-template-name>-<pod-ordinal>`</li><li> Пример: `web-data-0`, `web-data-1` </li></ul> 2. **Режимы доступа**: Поддерживает все режимы доступа Kubernetes:<ul><li> `ReadWriteOnce` (RWO): Чтение/запись для одного узла </li><li>`ReadOnlyMany` (ROX): Многопользовательский доступ только для чтения</li><li> `ReadWriteMany` (RWX): Многопользовательский доступ на чтение/запись</li></ul> 3. **Класс хранилища**: Укажите бэкенд хранилища через `storageClassName`:<ul><li> Использует класс хранилища по умолчанию кластера, если не указано </li><li> Поддерживает облачные/локальные типы хранилищ (SSD, HDD и т. д.) </li></ul> **Вместимость**: Настройте емкость через `resources.requests.storage`:<ul><li> Пример: `100Gi`</li><li> Поддерживает динамическое расширение объема (если включено)</li></ul> |

### Настроить Pod

В разделе **Pod** смотрите [Создание Развертывания - Настроить Pod](./deployment_create.mdx#configurepod)

### Настроить Контейнеры

В разделе **Контейнеры** смотрите [Создание Развертывания - Настроить Контейнеры](./deployment_create.mdx#configurecontainers)

### Создать

Нажмите **Создать**.
