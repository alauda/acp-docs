---
weight: 30
i18n:
  title:
    en: Создание StatefulSets
    zh: 创建 StatefulSets
title: Создание StatefulSets
sourceSHA: 9c3f949c5f60097ede76d5c4a106f61fdd3fdda6beb1b6dcfb28dba9afa84a3d
---

# Создание StatefulSet

**StatefulSet** — это контроллер Kubernetes, предназначенный для управления состоянием приложений, оркестрируя экземпляры Pod с постоянными сетевыми идентификациями и постоянным хранением. В рамках одной архитектуры приложения вы можете развернуть несколько StatefulSets в качестве отдельных компонентов для предоставления специализированных услуг при этом сохраняя упорядоченное развертывание, масштабирование и поэтапные обновления.

## Предварительные требования

Получите адрес изображения. Источником изображений могут быть как репозиторий изображений, интегрированный администратором платформы через инструментальный набор, так и репозитории изображений сторонних платформ.

- В первом случае администратор, как правило, назначает репозиторий изображений для вашего проекта, и вы можете использовать изображения из него. Если необходимый репозиторий изображений не найден, пожалуйста, свяжитесь с администратором для выделения.

- Если это репозиторий изображений сторонней платформы, убедитесь, что изображения могут быть вытянуты напрямую из него в текущем кластере.

## Процедура

1. В **Платформе контейнеров** перейдите в **Нагрузки** > **StatefulSets** в левой боковой панели.

2. Нажмите **Создать StatefulSet**.

3. **Выберите** или **введите** изображение и нажмите **Подтвердить**.

   **Примечание**: Вы можете фильтровать изображения, выбирая только при использовании изображений из интегрированного репозитория изображений этой платформы. Например, интегрированное имя проекта, такое как *containers (docker-registry-projectname)*, включает имя проекта *projectname* с этой платформы и имя проекта *containers* из репозитория изображений.

### Настройка основной информации

В разделе **Основная информация** настройте декларативные параметры для рабочих нагрузок развертывания:

| **Параметры**             | **Описание**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| :------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Replica**               | Определяет желаемое количество реплик Pod в развертывании (по умолчанию: `1`). Настройте в зависимости от требований рабочей нагрузки. Пожалуйста, установите это в соответствии с фактическим объемом запросов бизнеса.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Стратегия обновления**   | Управляет поэтапными обновлениями в процессе поэтапного обновления StatefulSet: <br />1. **Значение разбиения**: <ul><li> Указывает порядковый порог для обновлений Pod.</li></ul> 2. **Поведение**: <ul><li> Pods с порядковым номером ≥ значение разбиения будут обновляться сразу. </li><li> Pods с порядковым номером \< значение разбиения сохраняют предыдущий шаблон. </li></ul>  3. **Недопустимый случай**: <ul><li> Если значение разбиения > количество реплик, считать 0 </li></ul> **Пример**: <ul><li> Реплики=5 (Pods: web-0 \~ web-4)</li><li> Значение разбиения=3 → Обновления только web-3 и web-4. </li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Шаблоны заявок на тома** | `volumeClaimTemplates` — это критическая функция StatefulSets, которая позволяет **динамически предоставлять постоянное хранение для каждого Pod**. Каждая реплика Pod в StatefulSet автоматически получает свою собственную выделенную PersistentVolumeClaim (PVC) на основе предопределенных шаблонов.<br /> 1. **Динамическое создание PVC**: Автоматически создает уникальные PVC для каждого Pod:<ul><li> Шаблон именования: `<statefulset-name>-<claim-template-name>-<pod-ordinal>`</li><li> Пример: `web-data-0`, `web-data-1` </li></ul> 2. **Режимы доступа**: Поддерживает все режимы доступа Kubernetes:<ul><li> `ReadWriteOnce` (RWO): Чтение/запись на одном узле </li><li>`ReadOnlyMany` (ROX): Множественное чтение на нескольких узлах</li><li> `ReadWriteMany` (RWX): Множественная запись на нескольких узлах</li></ul> 3. **Класс хранилища**: Уточните хранилище через `storageClassName`:<ul><li> Использует класс хранилища по умолчанию кластера, если не указан </li><li> Поддерживает типы хранилищ облака/локальной инфраструктуры (SSD, HDD и т.д.) </li></ul> **Вместимость**: Настройте вместимость через `resources.requests.storage`:<ul><li> Пример: `100Gi`</li><li> Поддерживает динамическое расширение томов (если включено)</li></ul> |

### Настройка Pod

В разделе **Pod** смотрите [Создание Deployment - Настройка Pod](./deployment_create.mdx#configurepod)

### Настройка контейнеров

В разделе **Container** смотрите [Создание Deployment - Настройка контейнеров](./deployment_create.mdx#configurecontainers)

### Создать

Нажмите **Создать**.
