---
weight: 60
sourceSHA: c400cc9153b379a203f056c7c70a79c7300e2a6a0d7d29e9e78ffd90995d554e
---

# Коэффициент перерасхода ресурсов

## Понимание коэффициента перерасхода ресурсов пространства имен

<Term name="product" /> позволяет установить коэффициент перерасхода ресурсов (ЦП и память) для каждого пространства имен. Это управляет соотношением между лимитами контейнеров (максимальное использование) и запросами (гарантированный минимум) в этом пространстве имен, оптимизируя использование ресурсов.

Настраивая этот коэффициент, вы обеспечиваете, чтобы лимиты и запросы контейнеров, определенные пользователем, оставались в разумных пределах, улучшая общую эффективность ресурсов кластера.

**Ключевые концепции**

- Лимиты: Максимальное количество ресурсов, которое может использовать контейнер. Превышение лимитов может привести к ограничению (ЦП) или завершению (память).
- Запросы: Гарантированный минимум ресурсов, необходимых контейнеру. Kubernetes планирует контейнеры на основе этих запросов.
- Коэффициент перерасхода: Лимиты / Запросы. Эта настройка определяет допустимый диапазон для этого коэффициента в пределах пространства имен, балансируя гарантии ресурсов и предотвращая чрезмерное потребление.

**Основные возможности**

- Повышение плотности ресурсов и стабильности приложений в пределах пространства имен путем установки соответствующего коэффициента перерасхода для управления балансом между лимитами ресурсов и запросами.

**Пример**

> Предположим, что коэффициент перерасхода пространства имен установлен на 2, при создании приложения и указании лимита ЦП в 4c, соответствующее значение запроса ЦП рассчитывается как:

Запрос ЦП = Лимит ЦП / Коэффициент перерасхода. Таким образом, запрос ЦП становится 4c / 2 = 2c.

## Определение CRD

```yaml
# example-namespace-overcommit.yaml
apiVersion: resource.alauda.io/v1
kind: NamespaceResourceRatio
metadata:
  namespace: example
  name: example-namespace-overcommit
spec:
  cpu: 3 # Отсутствие этого поля указывает на наследование коэффициента перерасхода кластера; 0 означает отсутствие ограничений.
  memory: 4 # Отсутствие этого поля указывает на наследование коэффициента перерасхода кластера; 0 означает отсутствие ограничений.
status:
  clusterCPU: 2 # Коэффициент перерасхода кластера
  clusterMemory: 3
```

## Создание коэффициента перерасхода с помощью CLI

```bash
kubectl apply -f example-namespace-overcommit.yaml
```

## Создание/обновление коэффициента перерасхода с помощью веб-консоли

Позволяет настраивать **коэффициент перерасхода** для пространства имен для управления соотношением между лимитами ресурсов и запросами. Это гарантирует, что распределение ресурсов контейнера остается в пределах определенных границ, улучшая использование ресурсов кластера.

### Предостережения

Если кластер использует виртуализацию узлов (например, виртуальные узлы), отключите перерасход на уровне кластера/пространства имен перед его настройкой для виртуальных машин.

### Процедура

1. Перейдите в **Управление проектом** и навигацию к **Пространствам имен** > Список **пространств имен**.

2. Нажмите на целевое ***Имя пространства имен***.

3. Нажмите **Действия** > **Обновить перерасход**.

4. Выберите соответствующий метод **настройки коэффициента перерасхода**, чтобы установить коэффициент перерасхода ЦП или памяти для пространства имен.

| Параметр                | Описание                                                                                                                                                                                                                                                                         |
| ------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Наследовать от кластера** | <ul><li>Пространство имен наследует коэффициент перерасхода кластера.</li><li>Пример: Если коэффициент ЦП/памяти кластера равен 4, пространство имен по умолчанию будет равно 4.</li><li>Запросы контейнера = лимит / коэффициент кластера.</li><li>Если лимит не установлен, используйте квоту контейнера по умолчанию для пространства имен.</li></ul> |
| **Пользовательский**               | <ul><li>Установите коэффициент, специфичный для пространства имен (целое число > 1).</li><li>Пример: Коэффициент кластера = 4, коэффициент пространства имен = 2 → запросы = лимит / 2.</li><li>Оставьте пустым, чтобы отключить перерасход для пространства имен.</li></ul>                                                                  |

5. Нажмите **Обновить**.

**Примечание**: Изменения применяются только к вновь созданным Pod. Существующие Pod сохраняют свои оригинальные запросы до тех пор, пока не будут пересозданы.
