---
weight: 30
i18n:
  title:
    en: Configuring Secrets
    zh: 配置 Secrets
title: Настройка Secrets
sourceSHA: 5b40968aa9bfaf2b9b6f9783674ac3adafd867ee7af6174631daf11fcbf6a6e2
---

# Настройка Secrets

## Понимание Secrets

В Kubernetes (k8s) объект Secret является основным элементом, предназначенным для хранения и управления конфиденциальной информацией, такой как пароли, токены OAuth, SSH-ключи, TLS-сертификаты и API-ключи. Его основная цель — предотвратить прямое встраивание конфиденциальных данных в определения Pod или образы контейнеров, тем самым повышая безопасность и портативность.

Secrets похожи на ConfigMaps, но специально предназначены для конфиденциальных данных. Обычно они кодируются в формате base64 для хранения и могут использоваться Pod различными способами, включая монтирование в виде томов или выставление в качестве переменных окружения.

### Характеристики использования

- **Улучшенная безопасность**: По сравнению с конфигурационными картами в открытом виде (Kubernetes ConfigMap), Secrets предлагают лучшую безопасность, храня конфиденциальную информацию с использованием кодирования Base64. Этот механизм, в сочетании с возможностью Kubernetes контролировать доступ, значительно снижает риск раскрытия данных.

- **Гибкость и управление**: Использование Secrets обеспечивает более безопасный и гибкий подход, чем жесткое кодирование конфиденциальной информации непосредственно в файлы определения Pod или образы контейнеров. Это разделение упрощает управление и модификацию конфиденциальных данных без необходимости вносить изменения в код приложения или образы контейнеров.

### Поддерживаемые типы

Kubernetes поддерживает различные типы Secrets, каждый из которых предназначен для конкретных случаев использования. Платформа обычно поддерживает следующие типы:

- **Opaque**: Общий тип Secret, используемый для хранения произвольных пар ключ-значение конфиденциальных данных, таких как пароли или API-ключи.

- **TLS**: Специально предназначен для хранения информации о сертификате и закрытом ключе протокола TLS (Transport Layer Security), обычно используемого для HTTPS-связи и безопасного входа.

- **SSH Key**: Используется для хранения закрытых ключей SSH, часто для безопасного доступа к репозиториям Git или другим сервисам с поддержкой SSH.

- **SSH Authentication (kubernetes.io/ssh-auth)**: Хранит информацию для аутентификации данных, передаваемых по протоколу SSH.

- **Username/Password (kubernetes.io/basic-auth)**: Используется для хранения учетных данных базовой аутентификации (имя пользователя и пароль).

- **Image Pull Secret (kubernetes.io/dockerconfigjson)**: Хранит строку аутентификации в формате JSON, необходимую для извлечения образов контейнеров из частных репозиториев образов (Docker Registry).

### Методы использования

Secrets могут использоваться приложениями внутри Pod различными способами:

- **В качестве переменных окружения**: Конфиденциальные данные из Secret могут быть непосредственно внедрены в переменные окружения контейнера.

- **В качестве смонтированных файлов (Volume)**: Secrets могут быть смонтированы в виде файлов внутри тома Pod, позволяя приложениям считывать конфиденциальные данные из указанного пути к файлу.

**Примечание**: Экземпляры Pod в рабочих нагрузках могут ссылаться только на Secrets в одном и том же пространстве имен. Для более сложного использования и конфигураций YAML обратитесь к [официальной документации Kubernetes](https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets).

## Создание Secret типа Opaque

1. **Платформа контейнеров**.

2. В левой навигационной панели нажмите **Конфигурация** > **Secrets**.

3. Нажмите **Создать Secret**.

4. Настройте параметры.

   **Примечание**: В форме ввода конфиденциальные данные, такие как имя пользователя и пароль, будут автоматически закодированы в формате Base64 перед сохранением в Secret. Преобразованные данные можно просмотреть в представлении YAML.

5. Нажмите **Создать**.

## Последующие действия

При создании рабочих нагрузок для нативных приложений в одном и том же пространстве имен вы можете ссылаться на уже созданные Secrets.

## Операции

Вы можете нажать (⋮) с правой стороны страницы списка или нажать **Действия** в правом верхнем углу страницы деталей, чтобы обновить или удалить Secret по мере необходимости.

| Операция  | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Обновить** | После добавления или обновления Secret рабочие нагрузки, которые ссылались на этот Secret (или его элементы конфигурации) через переменные окружения, должны иметь свои Pods пересозданы, чтобы новая конфигурация вступила в силу.                                                                                                                                                                                                                                                                                                                                                |
| **Удалить** | <ul><li>После удаления Secret рабочие нагрузки, которые ссылались на этот Secret (или его элементы конфигурации) через переменные окружения, могут быть затронуты из-за невозможности найти источник ссылки при пересоздании Pods.</li><li>Пожалуйста, не удаляйте Secrets, автоматически сгенерированные платформой, так как это может помешать правильной работе платформы. Например: Secrets типа service-account-token, содержащие информацию для аутентификации ресурсов пространства имен, и Secrets в системных пространствах имен (таких как kube-system).</li></ul> |
