---
weight: 20
i18n:
  title:
    en: Конфигурация ConfigMap
    zh: 配置 ConfigMap
title: Настройка ConfigMap
sourceSHA: fe4ffa7a067bb4717187b23cd2524b78d322d6ff48a52b7e74e933dc3772d08f
---

# Настройка ConfigMap

ConfigMap позволяет отделить артефакты конфигурации от содержимого образа, чтобы поддерживать портативность контейнеризованных приложений. В следующих разделах определяются config map и описывается, как их создавать и использовать.

## Понимание ConfigMap

Многие приложения требуют конфигурации с использованием комбинации конфигурационных файлов, аргументов командной строки и переменных окружения. В OpenShift Container Platform эти артефакты конфигурации отделены от содержимого образа, чтобы поддерживать портативность контейнеризованных приложений.

Объект `ConfigMap` предоставляет механизмы для внедрения конфигурационных данных в контейнеры, оставаясь при этом независимым от OpenShift Container Platform. ConfigMap может использоваться для хранения детализированной информации, такой как отдельные свойства, или более общей информации, такой как целые конфигурационные файлы или JSON-объекты.

Объект `ConfigMap` содержит пары ключ-значение конфигурационных данных, которые могут использоваться в подах или для хранения конфигурационных данных для системных компонентов, таких как контроллеры. Например:

```yaml
# my-app-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-app-config
  namespace: default
data:
  app_mode: "development"
  feature_flags: "true"
  database.properties: |-
    jdbc.url=jdbc:mysql://localhost:3306/mydb
    jdbc.username=user
    jdbc.password=password
  log_settings.json: |-
    {
      "level": "INFO",
      "format": "json"
    }
```

**Примечание**: Вы можете использовать поле `binaryData`, когда создаете config map из двоичного файла, такого как изображение.

Конфигурационные данные могут использоваться в подах различными способами. ConfigMap может использоваться для:

- Заполнения значений переменных окружения в контейнерах
- Установки аргументов командной строки в контейнере
- Заполнения конфигурационных файлов в томе

Пользователи и системные компоненты могут хранить конфигурационные данные в config map. ConfigMap похож на секрет, но предназначен для более удобной работы со строками, которые не содержат конфиденциальной информации.

## Ограничения ConfigMap

- ConfigMap должен быть создан до того, как его содержимое может быть использовано в подах.
- Контроллеры могут быть написаны так, чтобы терпеть отсутствие конфигурационных данных. Обратитесь к отдельным компонентам, настроенным с использованием config map, в каждом конкретном случае.
- Объекты `ConfigMap` находятся в проекте.
- Они могут быть использованы только подами в том же проекте.
- Kubectl поддерживает использование config map только для подов, которые он получает от API-сервера. Это включает любые поды, созданные с использованием CLI или косвенно через контроллер репликации. Это не включает поды, созданные с использованием флага `--manifest-url` узла OpenShift Container Platform, его флага `--config` или его REST API, так как это не обычные способы создания подов.

## ConfigMap против Secret

| Особенность | ConfigMap      | Secret                      |
| ----------- | -------------- | --------------------------- |
| Тип данных  | Неконфиденциальные  | Конфиденциальные (например, пароли) |
| Кодирование  | Обычный текст  | Закодированный в Base64     |
| Сценарии использования | Конфигурации, флаги | Пароли, токены           |

## Создание ConfigMap с использованием веб-консоли

1. Перейдите в **Container Platform**.

2. В левой боковой панели нажмите **Configuration** > **ConfigMap**.

3. Нажмите **Create ConfigMap**.

4. Ознакомьтесь с инструкциями ниже, чтобы настроить соответствующие параметры.

   | Параметр          | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   | ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Записи**        | Относится к парам `key:value`, поддерживающим как методы **Add**, так и **Import**.<br /><ul><li>**Add**: Вы можете добавлять элементы конфигурации по одному или вставить одну или несколько строк пар ключ=значение в поле ввода Key для массового добавления элементов конфигурации.</li><li>**Import**: Импорт текстового файла размером не более 1M. Имя файла будет использоваться как ключ, а содержимое файла будет использоваться как значение, заполненное в элементе конфигурации.</li></ul> |
   | **Двоичные записи** | Относится к двоичным файлам размером не более 1M. Имя файла будет использоваться как ключ, а содержимое файла будет использоваться как значение, заполненное в элементе конфигурации.<br />**Примечание**: После создания ConfigMap импортированные файлы не могут быть изменены.                                                                                                                                                                                                         |

   **Пример формата массового добавления**:

   ```
   # Одна пара ключ=значение на строку, несколько пар должны быть на отдельных строках, иначе они не будут распознаны правильно после вставки.
   key1=value1
   key2=value2
   key3=value3
   ```

5. Нажмите **Create**.

## Операции

Вы можете нажать (⋮) на правой стороне страницы списка или нажать **Actions** в правом верхнем углу страницы деталей, чтобы обновить или удалить ConfigMap по мере необходимости.

Изменения в ConfigMap повлияют на рабочие нагрузки, которые ссылаются на конфигурацию, поэтому, пожалуйста, ознакомьтесь с инструкциями по операциям заранее.

| Операции | Описание                                                                                                                                                                                                                                                                                                                                   |
| -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Обновить** | <ul><li>После добавления или обновления ConfigMap любые рабочие нагрузки, которые ссылались на этот ConfigMap (или его элементы конфигурации) через переменные окружения, должны перестроить свои поды, чтобы новая конфигурация вступила в силу.</li><li>Для импортированных двоичных элементов конфигурации поддерживаются только обновления ключей, обновления значений не поддерживаются.</li></ul> |
| **Удалить** | После удаления ConfigMap рабочие нагрузки, которые ссылались на этот ConfigMap (или его элементы конфигурации) через переменные окружения, могут быть негативно затронуты во время создания подов, если они будут перестроены и не смогут найти источник ссылки.                                                                                                  |
