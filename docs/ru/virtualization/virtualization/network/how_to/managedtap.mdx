---
sourceSHA: 669a42d7aca004b3a05a4c2834d055dfdb4e49e03b00c3abbaaf2f5a96bd8006
---

# Конфигурация виртуальных машин для использования режима привязки сети для поддержки IPv6

Режим привязки сети представляет собой механизм расширения плагина для сетевой работы виртуальных машин. По умолчанию платформа использует плагин под названием ManagedTap для включения поддержки IPv6 для виртуальных машин. Этот плагин позволяет виртуальным машинам получать IP-адреса через DHCP-сервер CNI. Следовательно, пока DHCP-сервер CNI поддерживает IPv6, виртуальные машины также получат возможности IPv6.

В настоящее время мы используем Kube-OVN в качестве CNI. Поскольку DHCP-сервер Kube-OVN полностью поддерживает IPv6, виртуальные машины могут получить надежную функциональность IPv6 благодаря комбинации ManagedTap и Kube-OVN.

## Предварительные условия

- Версия ACP должна быть v4.0.0 или выше.
- Используется Kube-OVN в качестве CNI, и подсеть виртуальной машины настроена как Underlay.

## Процедура

<Steps>
  ### Добавление конфигурации IPv6 в подсеть виртуальной машины

  ```bash
  kubectl edit subnet <subnet-name>
  ```

  Добавьте следующие параметры в раздел `spec`:

  ```yaml
  spec:
    enableDHCP: true
    enableIPv6RA: true
    u2oInterconnection: true
  ```

  ### Создание виртуальной машины с использованием режима привязки сети в веб-консоли

  При создании виртуальной машины выберите **Network Binding** в качестве сетевого режима.

  ### Доступ к виртуальной машине через VNC и настройка сетевого интерфейса

  Для систем CentOS отредактируйте файл `/etc/sysconfig/network-scripts/ifcfg-enp1s0` и добавьте следующую конфигурацию:

  ```bash
  IPV6INIT=yes
  DHCPV6C=yes
  IPV6_AUTOCONF=yes
  ```

  перезапустите сеть

  ```bash
  systemctl restart network
  ```

  ### Настройка IPv6 по умолчанию

  Если коммутатор настроен на отправку сообщений об объявлениях маршрутизаторов (RA), ручная настройка маршрута не требуется. Маршрут по умолчанию можно автоматически получить через RA-сообщения от коммутатора.

  ```bash
  ip r r default via <subnet-v6-gateway>
  ```
</Steps>
