---
weight: 10
sourceSHA: 3dd3a91fa8da8f089b57eecc2b5c2f201dc05e9e101cf58bbfe74548686cce7f
---

# Создание Виртуальных Машин/Групп Виртуальных Машин

Создайте виртуальную машину (VirtualMachineInstance) с использованием образа и запланируйте виртуальную машину на физические узлы с установленными компонентами Kubevirt и включенной виртуализацией.

Вы можете создать одну виртуальную машину через [Создать Виртуальную Машину](#virtual) или быстро создать несколько виртуальных машин (VirtualMachineInstance) с одинаковой конфигурацией, используя [Создать Группу Виртуальных Машин](#virtual_group) (virtualMachinePool).

## Предварительные условия

- Перед созданием виртуальной машины с использованием образа, пожалуйста, подтвердите следующее у администратора платформы:

  - Целевой кластер является самостоятельно построенным, и компоненты Kubevirt были развернуты.

  - Целевой узел должен быть физическим узлом с включенной виртуализацией.

  - В образ платформы была добавлена виртуальная машина.

- Если вам нужно использовать функцию прямой передачи физического GPU виртуальной машины, пожалуйста, свяжитесь с администратором платформы для следующей конфигурации:

  1. Получите план подготовки среды для передачи GPU и подготовьте необходимую среду.

  2. Подготовьте требуемый физический GPU и включите связанные функции для передачи физического GPU для виртуальной машины.

## Примечания

При использовании виртуальных машин на Windows поддерживаются только входы через **имя пользователя/пароль**, установленные в образе виртуальной машины. Пожалуйста, свяжитесь с администратором платформы, чтобы заранее получить эту информацию.

## Создать Виртуальную Машину\{#virtual}

### Процедура

**Примечание**: Следующее содержание представляет собой пример создания виртуальной машины с использованием формы, и вы можете также переключиться на формат YAML для выполнения операции.

1. Войдите в **Платформу Контейнеров**.

2. На левой панели навигации, нажмите **Виртуализация** > **Виртуальные Машины**.

3. Нажмите **Создать Виртуальную Машину**.

4. В области **Основная Информация**, заполните имя и отображаемое имя виртуальной машины и установите теги или аннотации.

   | Параметр       | Описание                                                                                                                                                    |
   | :-------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Теги**       | Используются для выбора объектов и поиска коллекций объектов, которые соответствуют определенным критериям. Должны быть парой ключ-значение, например: *app.kubernetes.io/name: hello-app*. |
   | **Аннотации**  | Используются для предоставления любой информации командам разработки и эксплуатации. Должны быть парой ключ-значение, например: *cpaas.io/maintainer: kim*.                        |

5. Установите тип машины и выберите образ виртуальной машины.

   | Параметр                | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
   | :----------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Спецификации**        | Вы можете выбрать рекомендуемые сценарии использования или пользовательские ограничения ресурсов в зависимости от ваших потребностей.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   | **Физический GPU (Alpha)** | Выберите модель физического GPU; только один физический GPU может быть выделен каждой виртуальной машине. <br /><br />**Примечание**: Прямая передача физического GPU для виртуальной машины подразумевает прямое выделение фактического графического процессора (GPU) виртуальной машине в среде виртуализации, что позволяет ей непосредственно доступать и использовать физический GPU для достижения графической производительности, эквивалентной работе непосредственно на физической машине, избегая узких мест производительности, вызванных виртуальными графическими адаптерами и повышая общую производительность. |
   | **Образ**                | Выберите публичный образ, который был назначен администратором платформы проекту. <br />**Примечание**: Поддерживается только выбор образов с той же **архитектурой CPU**, что и архитектура кластера.                                                                                                                                                                                                                                                                                                                                                           |

6. В области **Хранилище**, обратитесь к следующим инструкциям для настройки соответствующей информации.

   | Параметр          | Описание                                                                                                                                                                                                                                                                                                                                                                        |
   | :----------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Имя Диска**     | Имя диска хранения; имя системного диска нельзя изменить.                                                                                                                                                                                                                                                                                                             |
   | **Тип**           | <ul><li>**Корневой Диск**: Система автоматически создает диск rootfs типа VirtIO для хранения операционной системы и данных.</li><li>**Диск Данных**: Нажмите, чтобы добавить несколько дисков данных для долговременного хранения данных. По умолчанию это устройство VirtIO.</li></ul>**Примечание**: Имена дисков данных не должны дублировать существующие имена дисков.                                                        |
   | **Режим Томов**    | <ul><li>**Файловая Система**: Монтировать диск как смонтированный файловый каталог.</li><li>**Блочное Устройство**: Монтировать диск как блочное устройство.</li></ul>                                                                                                                                                                                                                                         |
   | **Класс Хранилища** | Платформа управляет дисками виртуальных машин, создавая и управляя требованиями постоянного тома. Вам нужно указать класс хранения, необходимый для динамического создания требований постоянного тома. <br />Разные классы хранения поддерживают разные режимы томов; если для выбранного режима тома нет доступного класса хранения, пожалуйста, свяжитесь с администратором для добавления. |
   | **Вместимость**    | Вместимость, необходимая для хранения виртуальной машины; минимум для системного диска составляет 20 Г.                                                                                                                                                                                                                                                                                    |
   | **Удалить с ВМ**   | По умолчанию включен, не может быть изменен, указывая на то, что данные диска также будут удалены при удалении виртуальной машины.                                                                                                                                                                                                                                                   |

7. В области **Сеть**, обратитесь к следующим инструкциям для настройки соответствующей информации.

   | Параметр                  | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
   | :------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **IP Адрес**              | <ul><li>По умолчанию **Динамический (DHCP)**; IP-адрес назначается динамически при запуске виртуальной машины, и IP-адрес освобождается при остановке виртуальной машины.</li><li>Если привязка **Статического IP**, виртуальная машина всегда будет использовать этот IP-адрес даже после перезапуска. Если в текущем проекте нет доступных IP, пожалуйста, сначала освободите IP должным образом.</li></ul>                                                                                                                                 |
   | **Режим Сети**            | <ul><li>**Мостовой**: Виртуальная машина делит тот же IP-адрес с контейнерной группой и взаимодействует с внешним миром через этот IP-адрес.</li><li>**NAT**: Виртуальной машине будет назначен внутренний IP-адрес, но она будет переводиться на IP-адрес контейнерной группы для внешнего взаимодействия. Открытые порты указывают на порты, открытые виртуальной машины, такие как порт SSH 22; не заполнение **Открытых Портов** указывает на то, что все порты открыты.</li></ul>                               |
   | **Вспомогательная Сетевая Карта** | Добавьте вспомогательные сетевые карты по мере необходимости. <br />**Примечание**:<ul><li>Если требуются функции вспомогательной сетевой карты или нет доступных типов сетей вспомогательных сетевых карт, пожалуйста, свяжитесь с администратором платформы для настройки.</li><li>Типы SR-IOV поддерживают только операционные системы Linux на архитектуре x86\_64.</li><li>По умолчанию получение IP-адресов происходит через DHCP.<li>После нескольких перезагрузок виртуальные машины SR-IOV могут проявлять два разных VF, но с одинаковым MAC-адресом.</li></li></ul> |

8. В области **Настройки Инициализации**, обратитесь к следующим инструкциям для настройки соответствующей информации.

   | Параметр             | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   | :-------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Ключи**             | Всегда используйте SSH-ключи для проверки удаленного входа. Этот метод не требует проверки паролями; рекомендуется входить в виртуальную машину с помощью ключей. <ul><li>Вы можете использовать ключи, уже доступные в платформе, или сразу создать новые ключи; все соответствующие ключи можно просмотреть на странице **Виртуализация > Пары Ключей**.</li><li>Только лица с закрытым ключом могут получить доступ к виртуальной машине через SSH. Если нескольким людям необходимо поддерживать виртуальную машину вместе, можно связать несколько ключей, а закрытые ключи можно назначить разным пользователям. Если происходит утечка ключа, связанный ключ может быть быстро отозван, чтобы снизить ущерб.</li><li>Открытый ключ SSH-ключа хранится в платформе в конфиденциальной форме; платформа не хранит ваш закрытый ключ, поэтому, пожалуйста, храните его в безопасности самостоятельно.</li><li>Пожалуйста, проконсультируйтесь с документацией соответствующей операционной системы для пароля пользователя root.</li></ul> |
   | **Пароль**            | Используйте имя пользователя и пароль операционной системы для проверки входа, которые все еще можно обновить на метод ключей позже. <ul><li>Пользователь является только первоначальной учетной записью; после успешного создания виртуальной машины вы также можете создать других пользователей операционной системы в виртуальной машине для входа.</li><li>Платформа шифрует и хранит ваш пароль пользователя root, и вы больше не увидите его открытый пароль, поэтому, пожалуйста, храните его в безопасности самостоятельно.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   | **Запуск Немедленно** | По умолчанию включен. Включение этой опции запустит виртуальную машину сразу после создания; в противном случае будет создана только виртуальная машина.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

9. (Необязательно) В области **Расширенная Конфигурация**, обратитесь к следующим инструкциям для настройки соответствующей информации.

   | Параметр         | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   | ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Проверка Здоровья**  | <ul><li>**Проверка Жизни**: Проверяет, находится ли виртуальная машина в здоровом состоянии; если результат обнаружения аномальный, будет решено, следует ли перезапустить экземпляр на основе конфигурации проверки здоровья.</li><li>**Проверка Доступности**: Проверяет, завершила ли виртуальная машина запуск и находится ли в нормальном рабочем состоянии; если состояние здоровья экземпляра виртуальной машины обнаруживается как аномальное, состояние виртуальной машины будет обновлено.</li></ul><br />Для связанных описаний параметров. |
   | **Привязанность Узлов** | <ul><li>**Предпочтительно**: Виртуальная машина будет запланирована на узлы, которые удовлетворяют требованиям привязанности, когда это возможно. Система определит узлы, способные запустить виртуальную машину, комбинируя веса привязанности и другие требования к планированию (например, требования к вычислительным ресурсам).</li><li>**Обязательно**: Виртуальная машина будет запланирована только на узлы, которые полностью удовлетворяют требованиям привязанности.</li></ul>                                                                                         |

10. После подтверждения правильности информации нажмите **Создать**.

    Подождите, пока виртуальная машина не изменит статус с **Создание** на **Работающая**.

### Связанные Операции

Вы можете щелкнуть значок ⋮ на правой стороне страницы списка или **Действия** в правом верхнем углу страницы деталей, чтобы обновить или удалить виртуальную машину по мере необходимости. Для других связанных операций, таких как сброс паролей или обновление ключей, пожалуйста, обратитесь к [Управление Виртуальными Машинами](./virtual_management.mdx).

**Примечание**:

- Обновления могут выполняться только тогда, когда виртуальная машина находится в статусе **Аномально**, **Неизвестно** или **Остановлено**.

- Обновления не поддерживают отображение дисков, которые были отдельно подключены или созданы после создания виртуальной машины.

- По умолчанию, **Запуск Немедленно** отключен во время обновлений; вы можете включить его по мере необходимости.

## Создать Группу Виртуальных Машин\{#virtual\_group}

### Процедура

**Примечание**: Следующее содержание представляет собой пример создания группы виртуальных машин с использованием формы, и вы можете также переключиться на формат YAML для выполнения операции.

1. Войдите в **Платформу Контейнеров**.

2. На левой панели навигации, нажмите **Виртуализация** > **Группы Виртуальных Машин**.

3. Нажмите **Создать Группу Виртуальных Машин**.

4. В области **Основная Информация**, обратитесь к следующим инструкциям для настройки информации для группы виртуальных машин.

   | Параметр                           | Описание                                                                                                                                                                                                                |
   | :---------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Количество Экземпляров**          | Количество виртуальных машин, создаваемых группой виртуальных машин.                                                                                                                                                       |
   | **Анти-Привязанность между Экземплярами** | Если включено, при планировании нескольких виртуальных машин на узлы, они будут пытаться распределиться по различным узлам, что может повысить высокую доступность группы виртуальных машин.             |
   | **Теги**                            | Теги могут быть добавлены к группе виртуальных машин. Теги можно использовать для выбора объектов и поиска коллекций объектов, которые соответствуют определенным критериям. Должны быть парой ключ-значение, например: *app.kubernetes.io/name: hello-app*. |

5. В области **Шаблон Виртуальной Машины**, обратитесь к [Создать Виртуальную Машину](#virtual) для настройки единых тегов, аннотаций, спецификаций, изображений, хранения и другой информации для всех виртуальных машин в группе.

6. После подтверждения правильности информации нажмите **Создать**.

   **Совет**: После успешного создания вы можете перейти на страницу списка **Виртуальные Машины**, чтобы просмотреть информацию о виртуальных машинах, созданных через группу виртуальных машин.
