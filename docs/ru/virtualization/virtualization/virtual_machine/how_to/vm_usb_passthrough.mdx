---
weight: 10
sourceSHA: 4e793a442b5a720e7f215057b1dec3ae9ed66a52416f2b7ec98f6050660b2573
---

# Настройка передачи USB-устройств от хоста

## Обзор функции

Функция передачи USB (универсальной последовательной шины) позволяет получать доступ и управлять USB-устройствами из виртуальной машины.

## Сценарии использования

Некоторые приложения, работающие в виртуальных машинах (VM), имеют требования к шифрованию и нуждаются во взаимодействии с отдельными USB-устройствами. В таких случаях необходимо передать USB-устройства с хост-компьютера на виртуальную машину.

## Предварительные требования

- Версия платформы должна быть не ниже v3.18.

## Шаги

<Steps>
  ### Открытие USB-устройств

  Чтобы назначить USB-устройство виртуальной машине, оно должно быть открыто через **ResourceName**. Это можно настроить, редактируя раздел `spec.permittedHostDevices.usbHostDevices` в **HyperConverged CR** в пространстве имен kubevirt.

  Ниже приведен пример конфигурации для USB-устройства с **ResourceName** kubevirt.io/storage, где вендор — `0bda`, а продукт — `8812`:

  ```yaml "
  spec:
    permittedHostDevices:
      usbHostDevices:
      - resourceName: kubevirt.io/storage
        selectors:
        - vendor: "0bda"
          product: "8812"
  ```

  <Directive type="info" title="Совет">
    Идентификаторы вендора и продукта USB-устройства можно получить с помощью команды `lsusb`.\
    Например:

    ```
    $ lsusb
    Bus 001 Device 007: ID 0bda:8812 Realtek Semiconductor Corp. RTL8812AU 802.11a/b/g/n/ac 2T2R DB WLAN Adapter
    ```

    Эта команда выводит список всех подключенных USB-устройств, где ID отображает пару вендор:продукт.
  </Directive>

  ### Назначение USB-устройств виртуальной машине

  Теперь в конфигурации виртуальной машины вы можете добавить `spec.domain.devices.hostDevices.deviceName`, чтобы ссылаться на `ResourceName`, указанный на предыдущем шаге, и назначить ему локальное имя.\
  Например:

  ```yaml "
  spec:
    domain:
      devices:
        hostDevices:
        - deviceName: kubevirt.io/storage
          name: usb-storage
  ```

  <Directive type="info" title="Совет">
    Убедитесь, что виртуальная машина остановлена перед редактированием конфигурации.
  </Directive>
</Steps>

## Результат операции

После завершения настройки выполните команду `lsusb` внутри виртуальной машины. Если вывод содержит USB-устройство узла хоста, передача прошла успешно.\
Например:

```
$ lsusb
Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 001 Device 002: ID 0bda:8812 Realtek Semiconductor Corp. RTL8812AU 802.11a/b/g/n/ac 2T2R DB WLAN Adapter
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
```

## Узнать больше

Вы можете передать несколько USB-устройств виртуальной машине, таких как клавиатура, мышь или смарт-карта. Мы поддерживаем назначение нескольких USB-устройств в рамках одного resourceName. Вот как это настроить:

<Steps>
  ### Открытие нескольких USB-устройств

  ```yaml "
  spec:
    permittedHostDevices:
      usbHostDevices:
      - resourceName: kubevirt.io/peripherals
        selectors:
        - vendor: "0bda"
          product: "8812"
        - vendor: "062a"
          product: "4102"
        - vendor: "072f"
          product: "b100"
  ```

  <Directive type="info" title="Совет">
    Примечание: Все USB-устройства должны быть физически подключены и обнаружены на хосте для обеспечения успешного назначения на виртуальную машину.
  </Directive>

  ### Назначение USB-устройств виртуальной машине

  ```yaml "
  spec:
    domain:
      devices:
        hostDevices:
        - deviceName: kubevirt.io/peripherals
          name: local-peripherals
  ```
</Steps>
