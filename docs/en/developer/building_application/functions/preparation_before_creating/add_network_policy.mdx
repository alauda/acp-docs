---
weight: 40
sourceSHA: 867db6812011cb31b6066bbae77006c79b2cc7e84f7e3f8045bfa7c74091840d
---

# Configuring Network Policies

The current platform provides two different styles of forms for network policies: the old version and the new version. The new version of the network policy is more powerful than the old version, featuring a completely redesigned form that allows network policies to be defined via YAML, as well as providing two dimensions of configuration for cluster and namespace, allowing control over inbound and outbound traffic.

## Old Version Network Policy

Network Policy (NetworkPolicy) is implemented by the network plugin and is a Kubernetes resource that belongs to a namespace. Through network policies, network data access traffic for computing components within the project can be controlled using a whitelist method, achieving network isolation and reducing the risk of attacks.

By default, there is no isolation between computing components, allowing inbound (ingress) and outbound (egress) traffic from any source. Once a network policy is added, the targeted computing components in the policy will only accept traffic from the whitelist.

For more information, please refer to [Kubernetes NetworkPolicy](https://kubernetes.io/docs/concepts/services-networking/network-policies/) .

### Notes

- Network policies do not apply to host network namespaces, and Pods that have host networking enabled are unaffected by network policy rules.

- When configuring network policies, bidirectional traffic must be considered. For example, if target computing component A allows outbound traffic to remote computing component B, and B does not make any settings, then A can access B normally; if B configures an inbound whitelist but does not include A, then B will deny A's access.

- Whether a network policy takes effect depends on whether the network plugin used by the cluster supports network policies. Please confirm with the platform administrator before use.

- The functionality in Kube-OVN network mode is currently in Alpha maturity.

- After the platform administrator creates the cluster network policy, relevant policies will be automatically generated under each namespace. Updating or deleting such network policies is not supported.

### Scenario 1: Exposing Web Service Only to the Outside

If you have created a web application and do not wish to expose file transfer (FTP), remote login (Telnet), or other services, you can set it to allow only clients to access the corresponding ports of the web service, such as 80 (HTTP) and 443 (HTTPS).

#### Steps

1. Enter **Container Platform**.

2. In the left navigation bar, click **Network** > **Network Policies**.

3. Click **Create Network Policy**.

4. Refer to the following instructions to complete the relevant configuration.

   | Parameter                 | Description                    |
   | ------------------ | --------------------- |
   | **Target Computing Component / Label Selector** | The computing component corresponding to the web application         |
   | **Direction**             | Inbound                    |
   | **Protocol**             | TCP                   |
   | **Port**             | 80 (HTTP) and 443 (HTTPS) |
   | **Remote Type**           | IP Range                  |
   | **Remote**             | 0.0.0.0/0             |

5. Click **Create**.

### Scenario 2: Specifying Instance Communication in an Isolated Internal Network

Even in a strictly controlled internal network environment, it's necessary to consider communication between related services. For instance, a service instance may need to retrieve data from a MySQL database. After configuring the network policy as shown in the following example, MySQL will only allow access requests from specified instances.

| Parameter                 | Example              |
| ------------------ | --------------- |
| **Target Computing Component / Label Selector** | The computing component corresponding to the MySQL instance |
| **Direction**             | Inbound              |
| **Protocol**             | TCP             |
| **Port**             | 6379            |
| **Remote Type**           | Namespace (current project)      |
| **Remote**             | The namespace where the specified instance resides      |

### Scenario 3: Restricting Instance Access to External Websites

After configuring the network policy as shown in the following example, the instance will not be able to access websites other than the configured IP.

| Parameter                 | Example                    |
| ------------------ | --------------------- |
| **Target Computing Component / Label Selector** | The computing component corresponding to the instance             |
| **Direction**             | Outbound                    |
| **Protocol**             | TCP                   |
| **Port**             | 80 (HTTP) and 443 (HTTPS) |
| **Remote Type**           | IP Range                  |
| **Remote**             | Allowed website IP addresses           |

## New Version Network Policy

### Prerequisites

Please contact the platform administrator to enable the relevant features of **Network Policies**.

### Notes

- Network policies do not apply to host network namespaces, and Pods that have host networking enabled will not be affected by network policy rules.

### Steps

1. Enter **Container Platform**.

2. In the left navigation bar, click **Network** > **Network Policies**.

3. Click **Create Network Policy**.

4. Refer to the following instructions to complete the relevant configuration.

   <table>
     <thead>
       <tr>
         <th>Area</th>
         <th colSpan={2}>Parameter</th>
         <th>Description</th>
       </tr>
     </thead>

     <tbody>
       <tr>
         <td rowSpan={2}>Target Pod</td>
         <td colSpan={2}>Pod Selector</td>
         <td>Enter the label of the target Pod in key-value form; if not set, it will apply to all Pods in the current namespace.</td>
       </tr>

       <tr>
         <td colSpan={2}>Preview of Target Pods Affected by Current Policy</td>
         <td>Click <b>Preview</b> to see the target Pods affected by this network policy.</td>
       </tr>

       <tr>
         <td rowSpan={5}>Inbound</td>
         <td colSpan={2}>Deny All Inbound Traffic</td>
         <td>Deny all inbound traffic to the target Pod. <br /><br /><b>Note</b>:<ul><li>If Ingress is added to the spec.policyTypes field in YAML without configuring specific rules, the <b>Deny All Inbound Traffic</b> option will automatically be checked when switching back to the form.</li><li>If the spec.ingress, spec.egress, and spec.policyTypes fields are simultaneously deleted in YAML, the <b>Deny All Inbound Traffic</b> option will automatically be checked when switching back to the form.</li></ul></td>
       </tr>

       <tr>
         <td rowSpan={3}>Rules<br /><br /><b>Description</b>: If multiple sources are added in the rules, there is a logical <b>OR</b> relationship between them.</td>
         <td>Pods in Current Namespace</td>
         <td>Match Pods with specified labels in the current namespace; only matched Pods can access the target Pod. You can click <b>Preview</b> to see the Pods affected by the current rule. If this item is not configured, all Pods in the current namespace are allowed to access the target Pod by default.</td>
       </tr>

       <tr>
         <td>Pods in Current Cluster</td>
         <td>Match namespaces or Pods with specified labels in the cluster; only matched Pods can access the target Pod. You can click <b>Preview</b> to see the Pods affected by the current rule. <ul><li>If both namespace and Pod selectors are configured, it will take the intersection of the two, meaning Pods with specified labels will be selected from the specified namespace.</li><li>If this item is not configured, all Pods from all namespaces in the cluster can access the target Pod by default.</li></ul></td>
       </tr>

       <tr>
         <td>IP Range</td>
         <td>Enter the CIDR that can access the target Pod and can exclude CIDR ranges that are not allowed to access the target Pod. If this item is not configured, any traffic can access the target Pod.<br /><br /><b>Description</b>: You can add exclusion items in the form of <i>exampleip</i>/32 to exclude a single IP address.</td>
       </tr>

       <tr>
         <td colSpan={2}>Port</td>
         <td>Match traffic on specified protocols and ports; numeric ports or port names on Pods can be added. If this item is not configured, all ports will be matched.</td>
       </tr>

       <tr>
         <td rowSpan={5}>Outbound</td>
         <td colSpan={2}>Deny All Outbound Traffic</td>
         <td>Deny all outbound traffic to the target Pod. <br /><br /><b>Note</b>:<ul><li>If Egress is added to the spec.policyTypes field in YAML without configuring specific rules, the <b>Deny All Outbound Traffic</b> option will automatically be checked when switching back to the form.</li></ul></td>
       </tr>

       <tr>
         <td colSpan={2}>Other Parameters</td>
         <td>Similar to the inbound parameters, this will not be elaborated on here.</td>
       </tr>
     </tbody>
   </table>

5. Click **Create**.

### Reference Document

For more detailed information, please refer to the official documentation on [Network Policies](https://kubernetes.io/zh-cn/docs/concepts/services-networking/network-policies/) .
