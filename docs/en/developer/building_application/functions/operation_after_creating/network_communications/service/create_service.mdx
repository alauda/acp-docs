---
weight: 10
sourceSHA: 4b268e12bb8e9357d4e22ef4b8ef1d8a7d8b37eabef2d8297e73115fb08ce633
---

# Create Service

Internal routing (Kubernetes Service) can be used for service discovery of workloads, providing a unified IP address or host port for accessing these components.

## Operation Steps

1. Enter **Container Platform**.

2. In the left navigation bar, click **Network** > **Internal Routing**.

3. Click **Create Internal Routing**.

4. Refer to the following instructions to configure the relevant parameters.

   | Parameter        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Virtual IP** | If enabled, an internal IP address (ClusterIP) will be allocated for the internal routing, which can be used for service discovery within the cluster.<br />If disabled, a Headless Service will be created, which is usually used by **StatefulSet**.                                                                                                                                                                                                                                                                                                                                                                                       |
   | **External Access**  | If **Virtual IP** is enabled: <ul><li>**Disabled**: The port will not be exposed externally, providing an IP address within the cluster only using ClusterIP mode.</li><li>**NodePort**: A fixed port (NodePort) will be opened on each compute node host, exposing the internal routing through this port, and external access to the Service can be achieved via `<NodeIP>:<NodePort>`. At the same time, an internal IP address will be allocated for service discovery.</li><li>**LoadBalancer**: A load balancer will be used to forward traffic to the backend service. LoadBalancer type routing only supports using the same transport layer protocol; for example, if using TCP, the supported traffic protocols include HTTP, HTTPS, gRPC, etc. When using a public cloud cluster, refer to the [LoadBalancer Type Internal Routing Annotations](./annotation.mdx) to add annotations as needed.</li></ul><br />If **Virtual IP** is disabled: The default selection is disabled and cannot be modified; the platform will create a Headless Service, which is typically used by **StatefulSet**. |
   | **Target Component**  | <ul><li>**Workload**: The internal routing will forward requests to a **specific** workload, which matches the labels like `project.cpaas.io/name: projectname` and `service.cpaas.io/name: deployment-name`.</li><br /><li>**Virtualization**: The internal routing will forward requests to a **specific** virtual machine or virtual machine group.</li><br /><li>**Label Selector**: The internal routing will forward requests to a **certain type** of workload with specified labels, for example, `environment: release`.</li></ul>                                                                                                                                                                                                                                   |
   | **Port**    | Used to configure the access policy for internal routing. In the following example, other podss within the cluster can call this internal routing via the virtual IP (if enabled) and TCP port *80*; the access requests will be forwarded to the externally exposed TCP port *6379* or *redis* of the target component's pods.<ul><li>**Protocol**: The protocol used by the internal routing, supported protocols include: `TCP`, `UDP`, `HTTP`, `HTTP2`, `HTTPS`, `gRPC`.</li><li>**Service Port**: The service port number exposed by the internal routing within the cluster, that is, Port, e.g., *80*.</li><li>**Container Port**: The target port number (or name) that the service port maps to, that is, targetPort, e.g., *6379* or *redis*.</li><li>**Service Port Name**: Will be generated automatically. The format is `<protocol>-<service port>-<container port>`, for example: *tcp-80-6379* or *tcp-80-redis*.</li></ul>                                                                                                  |
   | **Session Affinity**  | Session affinity based on the source IP address (ClientIP). If enabled, all access requests from the same IP address will be kept on the same server during load balancing, ensuring that requests from the same client are forwarded to the same server for processing.                                                                                                                                                                                                                                                                                                                                                                                                                              |

5. Click **Create**.

## Related Actions

You can click the â‹® icon on the right side of the list page or click the **Actions** button in the upper right corner of the details page to update or delete the internal routing as needed.

- Internal routings with a **Grey Release** label next to their name are automatically generated internal routings on the Container Platform for grayscale release, combined with the Service Mesh platform. These internal routings are view-only and do not support updates or deletions.

- Deleting an internal routing will render the inbound rules associated with that internal routing unusable, ultimately leading to an inability to implement service discovery and access for workloads.
