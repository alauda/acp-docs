---
weight: 10
sourceSHA: ae5d69aecd9674bffd6bf0a7d2bba939683a28fe158d51b838a81c2f2de2d1f5
---

# Create Object Storage

MinIO is an object storage service based on the Apache License v2.0 open-source protocol. It is compatible with the Amazon S3 cloud storage service interface and is well-suited for storing large volumes of unstructured data, such as images, videos, log files, backup data, and container/virtual machine images. An object file can range in size from a few KB to a maximum of 5 TB.

## Prerequisites

MinIO is built upon underlying storage; please ensure that a storage class has been created in the current cluster, with TopoLVM being the recommended choice.

## Deploying the Operator

1. Navigate to **Platform Management**.

2. In the left sidebar, click **Storage Management** > **Object Storage**.

3. Click **Configure Now**.

4. In the **Deploy MinIO Operator** wizard page, click the **Deploy Operator** button in the bottom right corner.

   - When the page automatically moves to the next step, it indicates that the Operator has been successfully deployed.

   - If the deployment fails, please refer to the interface prompt to **Cleanup Deployed Information and Retry**, and redeploy the Operator.

## Creating a Cluster

1. In the **Create Cluster** wizard page, configure the basic information.

   | Parameter        | Description                                                                                                                                              |
   | ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Access Key**   | The unique identifier associated with the private access key; the access key ID and the private access key are used together to encrypt and sign requests.                                                       |
   | **Secret Key**   | A private access key used in conjunction with the access key ID to encrypt and sign requests, identifying the sender and preventing request modification. |

2. In the **Resource Configuration** area, follow the descriptions below to configure the specifications.

   | Parameter        | Description                                                                                                                                                                                                                                  |
   | ---------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Small**        | Suitable for test environments or data backup scenarios handling a maximum of 100,000 objects and supporting concurrent access of no more than 50. The default resource requests and limits for CPU are 2 cores, and for memory are 4 Gi.                                                                    |
   | **Medium**       | Geared toward enterprise-level deployments requiring storage for up to 1,000,000 objects, capable of handling up to 200 concurrent requests. The default resource requests and limits for CPU are 4 cores, and for memory are 8 Gi.                                                                         |
   | **Large**        | Designed specifically for corporate users with storage requirements of up to 10,000,000 objects and the ability to handle up to 500 concurrent requests, suitable for high-load scenarios. The default resource requests and limits for CPU are 8 cores, and for memory are 16 Gi. |
   | **Custom**       | Tailored for professional users with specific needs, offering flexible on-demand configuration options to ensure service scale and performance requirements are precisely matched. <br /><br /><b>Note</b>: When configuring custom specifications, ensure that: <ul><li>CPU resource requests must be greater than 100 m.</li><li>Memory resource requests must be greater than or equal to 2 Gi.</li><li>CPU and memory resource limits must be greater than or equal to resource requests.</li></ul> |

3. In the **Storage Pool** area, refer to the descriptions below to configure the relevant information.

   | Parameter        | Description                                                                                                                                                                                                                                                                                                                                                                                                           |
   | ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **Number of Instances** | Increasing the number of instances in a MinIO cluster can significantly enhance system performance and reliability, ensuring high data availability. However, an excessive number of instances may lead to the following issues: <ul><li>Increased resource consumption.</li><li>When a node carries multiple instances, a node failure may result in multiple instances going offline simultaneously, reducing the overall reliability of the cluster.</li></ul> Therefore, one must carefully balance resource utilization and fault tolerance in configuring the number of instances. <br /><br /><b>Note</b>: <ul><li>The minimum number of instances that can be filled is 4.</li><li>When the number of instances exceeds 16, the value entered must be a multiple of 8.</li><li>When adding additional storage pools, the number of instances must be no less than that of the first storage pool.</li></ul> |
   | **Single Storage Volume** | The capacity of a single storage volume PVC. Each storage service manages one storage volume; after filling in the capacity of a single storage volume, the platform will automatically calculate the storage pool capacity and other information, which can be viewed in the **Storage Pool Overview**.                                                                                                                                                   |
   | **Underlying Storage** | The underlying storage used by the MinIO cluster. Please select the storage class that has been created in the current cluster; TopoLVM is recommended.                                                                                                                                                                                                                                                                                |
   | **Storage Nodes**  | Choose the required storage nodes for the MinIO cluster. It is recommended to use 4-16 storage nodes; the platform will deploy one storage service for each selected storage node.                                                                                                                                                                                                                                      |
   | **Storage Pool Overview** | For specific parameters and calculation formulas, please refer to [Storage Pool Overview](#stro).                                                                                                                                                                                                                                                                                                                       |

4. In the **Access Configuration** area, refer to the descriptions below to configure the relevant information.

   | Parameter        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                           |
   | ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **External Access** | When enabled, cross-cluster access to MinIO is supported; when closed, only access within the cluster is allowed.                                                                                                                                                                                                                                                                                                                                               |
   | **Protocol**     | Supports HTTP and HTTPS; when selecting HTTPS, a **Domain Name** must be filled in, along with importing the **Public Key** and **Private Key** of the domain certificate. <br /> **Note**: <ul><li>When the access protocol is HTTP, Pods within the cluster can directly access MinIO using the obtained IP or domain name without configuring the mapping of IP addresses and domain names; nodes within the cluster can directly access MinIO via the obtained IP; if domain name access is needed, manual mapping of IP addresses and domain names is necessary; external clusters can directly access MinIO through the obtained IP.</li><li>When the access protocol is HTTPS, Pods within and outside the cluster cannot access MinIO directly via IP; manual mapping of the obtained IP address and the domain name filled in during cluster creation is required for normal access via the domain name.</li></ul>      |
   | **Access Method** | <ul><li>**NodePort**: A fixed port is opened on each compute node host to expose the service externally. When configuring domain name access, it is recommended to use VIP for domain resolution to ensure high availability.</li><li>**LoadBalancer**: A load balancer is used to forward traffic for the backend service. Please ensure that the current cluster has deployed the MetalLB plugin and has an available IP in the external address pool before use.</li></ul>                                                                                                                                                                            |

5. Click the **Create Cluster** button in the bottom right corner.

   - When the page automatically enters **Cluster Details**, it indicates that the cluster has been successfully created.

   - If the cluster remains in the creation state, you can click **Cancel**. Cancelling will clear the deployed cluster information and return to the create cluster page, allowing for cluster recreation.

## Creating a Bucket

Log into the control node of the cluster and use the command to create a bucket.

### Operation Steps

1. Click the **Access Method** tab on the cluster detail page to view the MinIO access address; or use the following command to query it.

   ```
   kubectl get svc -n <tenant ns> minio | grep -w minio | awk '{print $3}'
   ```

   **Note:**

   - Replace `tenant ns` with the actual namespace `minio-system`.
   - Example: `kubectl get svc -n minio-system minio | grep -w minio | awk '{print $3}'`

2. Obtain the mc command.

   ```
   wget https://dl.min.io/client/mc/release/linux-amd64/mc -O /bin/mc && chmod a+x /bin/mc
   ```

3. Configure the MinIO cluster alias.

   - IPv4:

     ```
     mc --insecure alias set <minio集群别名> http://<minio endpoint>:<port> <accessKey> <secretKey>
     ```

   - IPv6:
     ```
     mc --insecure alias set <minio集群别名> http://<[minio endpoint]>:<port> <accessKey> <secretKey>
     ```

   - Domain Name
     ```
     mc --insecure alias set <minio集群别名> http://<域名>:<port> <accessKey> <secretKey>
     mc --insecure alias set <minio集群别名> https://<域名>:<port> <accessKey> <secretKey>
     ```

   **Note:**

   - Fill in the `minio endpoint` with the IP address obtained in step 1.
   - Fill in the `accessKey` and `secretKey` with the **Access Key** and **Secret Key** used when creating the cluster.
   - Configuration Examples
     - IPv4: `mc --insecure alias set myminio http://12.4.121.250:80 07Apples@ 07Apples@`
     - IPv6: `mc --insecure alias set myminio http://[2004::192:168:143:117]:80 07Apples@ 07Apples@`
     - Domain Name: `mc --insecure alias set myminio http://test.minio.alauda:80 07Apples@ 07Apples@` or `mc --insecure alias set myminio https://test.minio.alauda:443 07Apples@ 07Apples@`

4. Create a bucket.

   ```
   mc --insecure mb <minio集群别名>/<bucket 名称>
   ```

## Upload/Download Files

After creating the bucket, you can use commands to upload files to the bucket or download existing files from the bucket.

### Operation Steps

1. Create a file for upload testing; skip this step when uploading an existing file.

   ```
   touch <文件名称>
   ```

2. Upload files to the bucket.

   ```
   # Upload files; the command for downloading files is the same; simply copy the file from the bucket to the target path.
   mc --insecure cp <文件名称> <minio集群别名>/<bucket 名称>  
   ```

3. View the files in the bucket to confirm whether the upload was successful.

   ```
   mc --insecure ls <minio集群别名>/<bucket 名称>
   ```

4. Delete the uploaded files.

   ```
   mc --insecure rm <minio集群别名>/<bucket 名称>/<文件名称>
   ```

## Related Information

### Redundancy Coefficient Mapping Table

**Note**: When adding additional storage pools, the redundancy coefficient needs to be calculated based on the number of instances in the first storage pool.

| Number of Instances | Redundancy Coefficient |
| -------------------- | ---------------------- |
| **4 - 5**            | 2                      |
| **6 - 7**            | 3                      |
| **>= 8**             | 4                      |

### Storage Pool Overview\{#stro}

| Storage Pool Overview Parameters | Calculation Formula                                                                                                                                             |
| --------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Available Capacity**            | <ul><li>If the number of instances is less than or equal to 16, Available Capacity = Single Volume Capacity * (Number of Instances - Redundancy Coefficient).</li><li>If the number of instances > 16, Available Capacity = Single Volume Capacity * (Number of Instances - 4 * (Number of Instances + 15) / 16)). The calculation result of the "4 * (Number of Instances + 15) / 16" part needs to be rounded down.</li></ul> |
| **Total Capacity**                | <ul><li>Total Capacity = Number of Instances * Single Volume Capacity</li></ul>                                                                                                   |
| **Tolerated Faulty Storage Services** | <ul><li>If the number of instances > 2 * Redundancy Coefficient, Tolerated Faulty Storage Services = Redundancy Coefficient.</li><li>If the number of instances = 2 * Redundancy Coefficient, Tolerated Faulty Storage Services = Redundancy Coefficient - 1.</li></ul>                                      |
