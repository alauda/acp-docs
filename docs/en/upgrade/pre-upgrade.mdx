---
weight: 20
---
# Pre-Upgrade Preparation

## Important notes before upgrade

* Supported platform versions for upgrade: `3.16.0`, `3.16.1`, `3.16.2`, `3.18.0`, `3.18.1`, `3.18.2`, `4.0.0`, `4.0.1`, `4.0.2`, `4.0.3`.
  Ensure your current platform version is within this supported range before upgrading.

* The **Kubernetes version** of all clusters in the platform must be **at least 1.28**.
  If any cluster is below this version, upgrade its Kubernetes version first.

* If the platform has a cluster with a **service mesh** provided by the platform, ensure that its **Istio version is 1.20 or higher**. Otherwise, upgrade the service mesh before proceeding.

* Check whether any cluster in the platform has the **CostManager** or **Kubecost** plugins installed. These plugins are **deprecated in version 4.0** and must be uninstalled prior to upgrading.

* If your platform version is `3.16` and any cluster has the **ClickHouse log storage plugin** installed, uninstall it **before the upgrade**. After the upgrade is complete, reinstall the plugin.

* Ensure that the `/cpaas/minio` directory on the **control plane nodes of the global cluster** has at least **120 GB** of available space.
  If not, expand the storage before proceeding.

* During the upgrade, the upgrade package must be **copied to any control plane node** in the global cluster and extracted.
  If the upgrade package and extraction path are on the same disk, ensure the disk has **at least 250 GB** of free space.

* Starting from ACP 4.x, periodic ETCD backup tasks besides the default one will all be deprecated. Before upgrading, backup and delete all ETCD backup tasks except the task `etcd-backup-default` (deleting a timed backup task will not remove any existing snapshot of ETCD, just the task itself). You may reconfigure the `etcd-backup-default` task as you wish after the upgrading is accomplished.

* When upgrading the cluster's **Kubernetes version to 1.31 or higher**, all running Pods will be **restarted**. This behavior is due to changes in the PodSpec fields introduced in Kubernetes 1.31 and cannot be avoided. For more details, refer to the Kubernetes issue report: [#129385](https://github.com/kubernetes/kubernetes/issues/129385).

* Starting from version **4.0**, the upgrade process for clusters using the **global DR (Disaster Recovery)** solution has changed. Please refer to [global DR procedure](./upgrade_global_cluster.mdx#global_dr) for the new procedure.

## Preparation procedure

<Steps>

### Run the checklist

Contact technical support to obtain the **checklist script** and run it against the target platform to verify readiness.

### Download the upgrade package

For platforms upgrading from version `3.16` or `3.18` to `4.0`, the **upgrade package is the same as the installation package**.
Refer to [Download Installation Package](../install/prepare/download.mdx) for instructions.

</Steps>
