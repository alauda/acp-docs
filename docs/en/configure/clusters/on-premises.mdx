---
weight: 20
i18n:
  title:
    en:
---

# Creating an On-Premises Kubernetes Cluster

## Overview

This guide provides a detailed walkthrough for creating an on-premises Kubernetes cluster using the platform, covering prerequisites, configuration steps, and post-deployment actions.

## Key Considerations

### Preliminary Notes

* Platform network card traffic monitoring defaults to identifying traffic from network cards with names matching `eth\.\|en\.\|wl\.*\|ww\.*`. If you use network cards with different naming conventions, refer to the [Custom Network Card Data Collection] documentation after cluster integration.

* After cluster creation, the following configurations cannot be modified without recreating the cluster:
  - Network mode
  - Container network segment
  - Service network segment
  - Hardware architecture
  - IPv4/IPv6 dual-stack
  - Node proxy configuration

* Cluster Control Node Constraints:
  - Control node count can only be 1, 3, or 5
  - A cluster with only 1 control node is not recommended for production environments
  - With 1 control node, cluster becomes unavailable if the node fails

### Prerequisites

#### Hardware and Network Preparation

1. For clusters with 3 or 5 control nodes:
   - Prepare a hardware or software load balancer (e.g., F5 device, IaaS load balancer, HAProxy)

2. For custom VIP (Virtual IP) as cluster address:
   - Contact network administrators to request VIP and VRID
   - VIP must be an unused IP in the node IP subnet
   - VIP cannot be the same as any node IP

3. External Image Repository:
   - If pulling platform component images from an external repository, establish an image repository in advance
   - Consult technical support for implementation details

#### Node Requirements

1. Review [Node Availability Checklist]
2. Ensure all nodes meet the specified conditions
3. For nodes requiring proxy access:
   - Prepare a SOCKS5 proxy service

## Cluster Creation Steps

### 1. Basic Information Configuration

#### Kubernetes Version
- Select Kubernetes version compatible with your business components
- Consider [Cluster Component Version Requirements]

#### Runtime Components
- Choose container runtime based on the selected Kubernetes version
- Refer to [Runtime Component Selection Guide]

#### Cluster Address
- Configure cluster's API Server access address
- Options for VIP and external access configuration

#### Image Repository
- Select from:
  - Platform default
  - Private repository
  - Public repository

### 2. Container Network Configuration

Choose from network plugins:
- Kube-OVN
- Calico
- Flannel
- Custom

#### Network Mode Considerations
- Overlay vs. Underlay
- IP address range planning
- Service and Join network segment configurations

### 3. Node Configuration

#### Node Types
- Control Nodes: Manage cluster components
- Compute Nodes: Run business containers

#### Node Details
- IPv4/IPv6 addressing
- SSH connectivity
- Network interface selection
- Proxy configuration (if needed)

### 4. Optional: Extended Parameters

**Caution**: Modify with care to prevent cluster instability

Configurable parameters:
- Docker parameters
- Kubelet parameters
- Controller Manager parameters
- Scheduler parameters
- APIServer parameters
- Cluster annotations

## Post-Deployment Actions

### 1. Monitor Deployment Progress
- Check cluster creation status
- Review execution details

### 2. Plugin Deployment
- Install monitoring components
- Configure log collection and storage

### 3. Project Association
- Create or associate projects with the new cluster
- Create namespaces for resource management

## Best Practices

1. Plan network segments carefully
2. Ensure high availability with 3-5 control nodes
3. Use load balancing for multi-node clusters
4. Validate node compatibility before deployment
5. Consider future scalability

## Troubleshooting

- Verify all prerequisite checks
- Check network configurations
- Validate node SSH connectivity
- Review system tool and kernel module requirements

## Support

For complex scenarios or deployment issues, contact technical support with detailed configuration information.
