---
weight: 12
---

# Install Envoy Gateway via Envoy Gateway Operator

## Prerequisites

Please ensure that you have read the [Understanding EnvoyGateway](../architecture/understanding_envoy_gateway.mdx) documentation before proceeding.

## Overview

The `envoy-gateway-operator` is provided to facilitate advanced management of `envoy-gateway instance` deployments.

The operational architecture functions as follows:
the `envoy-gateway-operator` continuously monitors `EnvoyGatewayCtl` and automatically provisions corresponding `envoy-gateway instance` deployment,service etc.

## Installation

### Step1 Install Envoy Gateway Operator

1. Navigate to `Administrator -> Marketplace -> OperatorHub`
2. Locate the `Alauda build of Envoy Gateway` under `Networking` Category and click `Install`

### Step2 Create a Default EnvoyGatewayCtl

1. Navigate to `Administrator -> Marketplace -> OperatorHub`
2. Locate the `Alauda build of Envoy Gateway` under `Networking` Category ,click to Open it.
3. Navigate to the `All Instances` tab
4. Click `Create`, then in the displayed dialog box, locate the `EnvoyGatewayCtl` Instance Type section and click `Create`
5. The `Create EnvoyGatewayCtl` page displays the following configuration options:
   | Field | Default Value | Description | YAML Path |
   |-------|---------------|-------------|-----------|
   | Name | cpaas-default | Name of the Envoy Gateway instance | `.metadata.name` |
   | Namespace | envoy-gateway-operator | Namespace of the Envoy Gateway instance, each ns could **only have one** envoygatewayctl | `.metadata.namespace` |
   | Replica | 1 | The replica count of the Envoy Gateway deployment | `.spec.controller.replicaCount` |
   | Deploy Ns Mode | ControllerNamespace | Determines whether the gateway deployment is installed in the gateway namespace or the controller namespace, please refer to [deployment mode](https://gateway.envoyproxy.io/docs/tasks/operations/deployment-mode/) | `spec.config.envoyGateway.provider.kubernetes.deploy.type`|
   | Resources | 1C1G | The resource requests and limits of the Envoy Gateway deployment | `.spec.controller.resources` |

   **Recommendation**: Use the default values for typical deployments. Click **Create** to proceed.

## Configuration Via YAML

You could also apply `EnvoyGatewayCtl` via yaml

### Default Config

```yaml
apiVersion: envoy-gateway.alauda.io/v1
kind: EnvoyGatewayCtl
metadata:
  name: cpaas-default
  namespace: envoy-gateway-operator
spec:
  config:
    envoyGateway:
      provider:
        kubernetes:
          deploy:
            type: ControllerNamespace
        type: Kubernetes
  deployment:
    resources:
      limits:
        cpu: '1'
        memory: 1024Mi
      requests:
        cpu: 100m
        memory: 256Mi
```
Each `EnvoyGatewayCtl` will create a `GatewayClass` named as `$NS-$NAME`, for example `envoy-gateway-operator-cpaas-default`.

### Advanced Config Via EnvoyGatewayCtl \{#envoygatewayctl}

`EnvoyGatewayCtl` is essentially the envoy-gateway Helm chart wrapped with [helm-operator](https://sdk.operatorframework.io/docs/building-operators/helm/tutorial/). Its spec corresponds to the values of the envoy-gateway chart, allowing you to configure various global-level features of Envoy Gateway in one source.

For detailed information about available configuration options, please refer to [envoy-gateway-chart-values](https://github.com/envoyproxy/gateway/tree/v1.5.0/charts/gateway-helm).

:::danger
You should only configure the `envoy-gateway instance` through the `EnvoyGatewayCtl` resource. Do not directly modify rendered resources such as ConfigMaps, Deployments, as these changes may be lost during upgrades or reconciliation.
:::


#### Backend Routing

For example you can configure backend routing in the EnvoyGatewayCtl spec:

```yaml
apiVersion: envoy-gateway.alauda.io/v1
kind: EnvoyGatewayCtl
metadata:
  name: cpaas-default
  namespace: envoy-gateway-operator
spec:
  config:
    envoyGateway:
      extensionApis:
        enableBackend: true # Enable backend routing in EnvoyGatewayCtl not the envoygateway configmap
      provider:
        kubernetes:
          deploy:
            type: ControllerNamespace
        type: Kubernetes
  deployment:
    resources:
      limits:
        cpu: '1'
        memory: 1024Mi
      requests:
        cpu: 100m
        memory: 256Mi
```

## Next Steps
- [Configure GatewayAPI Gateway](../functions/configure_gatewayapi_gateway.mdx)
## Additional Resources
- [Configure GatewayAPI Route](../functions/configure_gatewayapi_route.mdx)
- [Tasks for Envoy Gateway](../how_to/tasks_for_envoy_gateway.mdx)
