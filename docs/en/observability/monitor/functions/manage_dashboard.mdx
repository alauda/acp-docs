---
weight: 40
sourceSHA: 82a9916bcbfb5783c06887e2ee109b5d08a3b72049c82a22339fa1e2c6c038dd
---

# Management Monitoring Dashboard

## Function Overview

The platform provides a powerful dashboard management feature designed to replace traditional Grafana tools, offering users a more comprehensive and flexible monitoring experience. This feature aggregates various types of monitoring data from within the platform, presenting a unified monitoring view that will significantly enhance your configuration efficiency.

### Key Features

- Supports configuring custom monitoring dashboards for both business view and platform view.
- Enables viewing public dashboards configured in platform view within the business view, with data isolation based on the business namespace.
- Supports managing charts within the dashboard, allowing for adding, deleting, and modifying charts, as well as resizing and moving their positions via drag-and-drop.
- Allows setting custom variables within the dashboard for filtering data displayed in charts.
- Supports configuring groups within the dashboard to manage the charts. Groups can be displayed multiple times based on custom variables.
- Supported chart types include: trend charts, line charts, bar charts, horizontal bar charts, gauge charts, donut charts, tables, statistics charts, scatter plots, pie charts, and text cards.
- One-click import of Grafana panels is supported.

### Advantages of the Feature

- Supports users in customizing monitoring scenarios without being limited to preset templates, truly achieving a personalized monitoring experience.
- Offers rich visualization options, including various chart types such as line charts, bar charts, and pie charts, along with flexible layout and style adjustment features.
- Deeply integrated with the platform's role permissions, allowing business views to independently define monitoring dashboards while ensuring data isolation.
- Integrates seamlessly with various functions of the container platform, providing instant access to monitoring data on containers, networks, storage, etc., offering users comprehensive performance observation and fault diagnosis.
- Fully compatible with Grafana panel JSON, enabling easy migration from Grafana for continued use.

### Use Cases

- **IT Operations Management**: As part of the IT operations team, you can use the monitoring dashboard to view and manage various performance metrics of the container platform, such as CPU, memory, network traffic, etc. By customizing monitoring reports and alert rules, you can promptly identify and locate system issues, improving operational efficiency.
- **Application Performance Analysis**: For application developers and testers, the monitoring dashboard provides rich visualization options, allowing an intuitive display of application operating status and resource consumption. You can tailor dedicated monitoring views for different application scenarios to deeply analyze application performance bottlenecks and form the basis for optimization.
- **Multi-cluster Management**: For users managing multiple container clusters, the monitoring dashboard can aggregate monitoring data scattered across different clusters, allowing you to easily grasp the operational status of the entire system.
- **Fault Diagnosis**: When a system fails, the monitoring dashboard can provide you with comprehensive performance data and analysis tools to quickly pinpoint the root of the problem. You can rapidly view changes in relevant monitoring metrics based on alert information, facilitating a thorough analysis of the fault causes.

### Prerequisites for Use

The monitoring dashboard currently only supports viewing monitoring data collected by the monitoring components deployed on the platform; therefore, you need to prepare the following before configuring the monitoring dashboard:

- Ensure that the cluster you need to configure the monitoring dashboard for has deployed monitoring components, namely **Prometheus** or **VictoriaMetrics** plugins.
- Ensure that the data you need to display has already been collected by the monitoring components.

### Relationship Between the Monitoring Dashboard and Monitoring Components

- Monitoring dashboard resources are stored in the Kubernetes cluster; you can switch the **Cluster** tab at the top to view monitoring dashboards from different clusters.
- The monitoring dashboard relies on the monitoring components in the cluster as a data source for querying data; therefore, you need to ensure that the current cluster has successfully deployed monitoring components and they are functioning properly before using the monitoring dashboard.
- The monitoring dashboard will request monitoring data for the corresponding cluster by default. If you have deployed **VictoriaMetrics** in proxy mode in the cluster, we will request the storage cluster to query the corresponding data for this cluster without requiring special configuration.

## Management Dashboard

A dashboard is a collection of one or more charts that are organized and arranged into one or more rows, providing a clear view of relevant information. These charts can query raw data from the data source and transform it into a series of visual effects supported by the platform.

### Creating a Dashboard

1. Click **Create Dashboard**, referring to the following instructions to configure relevant parameters.

| Parameter        | Description                                                |
| --------- | ------------------------------------------------- |
| **Folder**   | The folder where the dashboard resides, you can input or select an existing folder.                              |
| **Label**    | The label for the monitoring dashboard, which allows you to quickly find the created dashboard through the top label filter when switching dashboards.             |
| **Set as Main Dashboard** | If enabled, this dashboard will be configured as the main dashboard upon creation; next time you enter the dashboard function, it will default to display the main dashboard data.     |
| **Variables**    | Add variables when creating the dashboard, so they can be referenced as metric parameters in added charts and can also be used as filter options on the dashboard homepage. |

2. After adding, click **Create**, complete the dashboard creation, and then you need to **add variables**, **add charts**, and **add groups** to complete the entire layout design.

### Importing a Dashboard

The platform supports directly importing Grafana JSON to convert it into a monitoring dashboard for display.

- Currently, only V8+ versions of Grafana JSON are supported for import; lower versions of Grafana JSON will be prohibited from import.

- If the imported chart is not within the scope supported by the platform, it may appear as **Unsupported Chart Type**, but you can modify the chart settings to display it normally.

- After importing the dashboard, you can perform any management actions normally, and it will have no difference from the dashboards created on the platform.

### Adding Variables

1. In the variable form area, click **Add**.

   | Parameter        | Description                                                                                                                            |
   | --------- | ----------------------------------------------------------------------------------------------------------------------------- |
   | **Type**    | Currently only Query type variables are supported, allowing you to filter data based on the feature dimensions of the time series. You can dynamically calculate and generate query results by specifying query expressions.                                                              |
   | **Display Filter Option** | Default value for the drop-down filter displayed on the dashboard homepage, supports showing name and value, or hiding the filter box when not displayed.                                                                               |
   | **Query Settings**  | Using query type variables allows you to filter data based on the feature dimensions of the time series. When defining query settings, in addition to using PromQL to query time series, the platform also provides some commonly used variables and functions, refer to [Common Functions and Variables](#ref-function).        |
   | **Regex** | By using regular expressions, you can filter out the required values from the content returned by the variable query. This ensures that each option in the variable contains the expected name, and you can preview whether the filtered values meet expectations in **Variable Value Preview**.                                            |
   | **Selection Settings**  | - **Multi-select**: When selected from the top filter options on the dashboard homepage, allows multiple options to be selected simultaneously. You need to reference this variable in the query expression of the chart to view the data corresponding to the variable value.<br />- **All**: When checked, will enable an option that includes **All** in the filter options for selecting all variable data. |

2. Click **OK** to add one or more variables.

### Adding Charts

Add multiple charts to the currently created monitoring dashboard to display data information of different resources.

**Tip**: Click the bottom right corner of the chart to customize the size; click anywhere on the chart to drag and customize the arrangement order.

1. Click on **Add Chart**, and refer to the following instructions to configure relevant parameters.

- **Chart Preview**: The chart preview area will display the real-time data information corresponding to the added metrics.

- **Add Metrics**: Configure chart title and monitoring metrics in this area.

- **Adding Methods**: Supports using built-in metrics or using native custom metrics. Both methods will yield a combined result and are effective simultaneously.

  - **Built-in Metrics**: Select commonly used metrics and legend parameters provided by the platform to display the data information under the current chart.
    - **Note**: All metrics added to the chart must have unified units; it is not possible to add metrics with multiple units to a single chart.
  - **Native**: Customize metric units, expression and legend parameters. The metric expressions follow PromQL syntax, reference [PromQL Official Documentation](https://prometheus.io/docs/prometheus/latest/querying/basics/) for details.

- **Legend Parameters**: Controls the names corresponding to the curves in the chart; you can use text or template formats.
  - Rule: Input values must be in the format `{{.xxxx }}`; for example, `{{.hostname}}` will be replaced with the value corresponding to the hostname label returned by the expression.
  - **Tip**: If an incorrectly formatted legend parameter is entered, the corresponding names of the curves in the chart will be displayed in their original format.

- **Instant Switch**: When the **Instant** switch is turned on, it queries for instantaneous values via Prometheus's Query interface and sorts them, applicable for statistical charts or gauge charts; if turned off, the query\_range method is used to query a series of data within a time period.

- **Chart Settings**: Supports selecting different chart types to visualize the data information of the metrics; refer to [Manage Charts](#pannel).

2. Click **Save** to complete adding the chart.

3. You can add one or more charts within the dashboard.

4. Once chart addition is complete, you can use these two operations to ensure that the display and size of the charts meet your expectations.

   - Click the bottom right corner of the chart to customize its size.
   - Click anywhere on the chart to drag it and customize the order of arrangement.

5. After completing the adjustments, click the **Save** button on the dashboard page to save your changes.

### Adding Groups

Groups act as logical dividers within the dashboard, allowing for the combination of charts.

1. Click the drop-down menu of **Add Chart** > **Add Group** and refer to the following instructions to configure relevant parameters.

- **Group**: The name of the group.
- **Repeat**: Supports disabling repetition or selecting the current chart's variable
  - **Disable Repetition**: Do not select a variable; use the default created group.
  - **Parameter Variable**: Select variables created in the current chart; the monitoring dashboard will generate a row of identical sub-groups for each variable value, and each sub-group will be displayed using that variable value. Sub-groups cannot be modified, deleted, or moved.

2. After adding the group, you can perform the following operations to manage the chart display within the dashboard.

   - Groups can be collapsed or expanded to hide part of the dashboard content. Panels within the collapsed group will no longer issue queries.

   - Move the chart position under a group to make the chart managed by that group. The group will manage all charts between it and the next group.

   - When the group is folded, all panels managed by the group can also move positions together.

   - Folding and hiding groups is also an adjustment to the dashboard; if you want to keep this state when reopening the dashboard next time, please click the **Save** button.

### Switching Dashboards

Set a created custom monitoring dashboard as the main dashboard, which will default to show the main dashboard data when re-entering the monitoring dashboard function.

1. In the left navigation bar, click **Operations Center** > **Monitoring** > **Monitoring Dashboard**.

2. By default, the main monitoring dashboard will be displayed; click **Switch Dashboard**.

3. You can use label filtering or name search to find dashboards and switch the main dashboard via the **Main Dashboard** toggle.

### Other Operations

You can click the action button on the right side of the dashboard page to perform various operations as needed.

| Operation        | Description                                                              |
| --------- | --------------------------------------------------------------- |
| **YAML**  | Open the actual CR resource code stored in the Kubernetes cluster for the dashboard, allowing you to modify all content within the dashboard by adjusting the parameters in the YAML. |
| **Export Expression** | You can export the metrics and corresponding query expressions used by the current dashboard in CSV format.                                 |
| **Copy**    | Copy the current dashboard, allowing you to edit the charts as needed and save them as a new dashboard.                                          |
| **Settings**    | Modify the basic information of the current dashboard, such as changing labels, adding more variables, etc.                                     |
| **Delete**    | Delete the current monitoring dashboard.                                                       |

## Managing Charts {#pannel}

The platform provides multiple visualization methods to support different usage scenarios; this section will primarily introduce these chart types, configuration options, and usage methods.

### Chart Description

| No.     | Chart Name  | Description                              | Recommended Usage Scenarios                                                             |
| ------ | ----- | ------------------------------- | ------------------------------------------------------------------ |
| **1**  | Trend Chart   | Displays the trend of data changes over time with one or more lines.          | Displays trends over time, such as CPU utilization, memory usage, etc.                                |
| **2**  | Step Line Chart | Based on line charts, connections between data points are formed using horizontal and vertical segments. | Suitable for showing time points of discrete events, such as the count of alarms.                                            |
| **3**  | Bar Chart   | Uses vertical rectangular bars to represent the size of data, with the height of the bars representing value.    | Bar charts intuitively compare value differences, helpful for discovering patterns and anomalies; suitable for scenarios requiring attention to value changes, such as container group count, node count, etc.             |
| **4**  | Horizontal Bar Chart   | Similar to bar charts, but uses horizontal rectangular bars to represent data.          | When the data dimensions are numerous, horizontal bar charts better utilize space layout to enhance readability.                                      |
| **5**  | Donut Chart | Uses a semicircular or ring shape to represent the current value of an indicator and its proportion to the total.    | Intuitively reflects the current status of key monitoring indicators, such as system CPU usage and memory usage, recommended to be paired with alert thresholds to indicate abnormal conditions through color changes.          |
| **6**  | Gauge Chart | Uses vertical rectangular bars to represent the current value and its proportion.         | Intuitively reflects the current state of key indicators, such as completion progress and system load. When the same indicator has multiple categories, it is more advisable to use gauge charts, such as available disk space or utilization. |
| **7**  | Pie Chart    | Uses sectors to represent the proportion of different parts of the whole data.           | Suitable for showing the composition of overall data across different dimensions, such as the proportion of 4XX, 3XX, and 2XX response codes over a period of time.                        |
| **8**  | Table    | Organizes data in rows and columns, facilitating the viewing and comparison of specific values.          | Suitable for displaying structured multidimensional data, such as detailed information on nodes and container groups.                                    |
| **9**  | Statistics Chart   | Displays the current value of a single key indicator, usually needing text explanations.        | Suitable for showcasing the real-time values of important monitoring indicators, such as the number of container groups, number of nodes, and current alarm counts.                                   |
| **10** | Scatter Plot   | Uses a Cartesian coordinate system to plot a series of data points, reflecting the correlation between two variables.  | Suitable for analyzing relationships between two metrics; the distribution of data points can reveal linear correlations, clustering patterns, etc., aiding in the discovery of relationships between indicators.               |
| **11** | Text Card  | Uses card format to display key textual information, typically including a title and brief description.     | Suitable for presenting textual information, such as chart descriptions, troubleshooting descriptions, etc.                                           |

### Chart Configuration Description

#### General Parameters

| Parameter           | Description                                                                  |
| ------------ | ------------------------------------------------------------------- |
| **Basic Information**     | Choose an appropriate chart type based on the selected metric data and add a title and description; you can add one or more links, which can be quickly accessed by selecting the corresponding link name next to the title after being added.  |
| **Standard Settings**     | The unit applied to the native metric data. Additionally, donut charts and gauge charts support configuring the **Total Value** field, which will display the percentage of **Current Value/Total Value** in the chart. |
| **Tooltips** | Tooltips turn the real-time display of data to the right of the mouse over the chart on or off, and sorting is supported.                           |
| **Threshold Parameters**     | Configure the chart threshold switch; once enabled, thresholds will be displayed in the chart using the selected colors, and threshold sizes can be set.                             |
| **Value**        | Set the value calculation method, such as latest value, minimum value. This configuration item is only supported for statistics charts and donut gauge charts.                                |
| **Value Mapping**      | Redefine specific values or value ranges, for example defining value 100 as full load. This configuration item is only supported for statistics charts, tables, and donut gauge charts.              |

#### Special Parameters for Charts

| Chart Type      | Parameter          | Description                                                                                                                                   |
| --------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| **Trend Chart**   | **Graph Style**    | You can choose line or area charts as the display style; line charts focus on reflecting the trend of metrics, while area charts focus on changes related to totals and parts. Select according to your actual needs.                                                                 |
| **Donut Chart** | **Donut Chart Settings** | <br /> **Display Direction**: When you need to view multiple indicators within a single chart, you can set whether these indicators are arranged horizontally or vertically.<br /> **Unit Redefinition**: You can set the unit of each indicator independently; if not set, the platform will display using the unit in **Standard Settings**.                  |
| **Pie Chart**    | **Pie Chart Settings**    | <br /> **Maximum Display Block Count**: You can reduce the number of blocks in the pie chart to minimize the interference from many low-proportion categories; excess blocks will be combined and displayed as **Others**.<br /> **Label Display Field**: You can set the fields displayed in the pie chart labels.              |
| **Pie Chart**    | **Graph Style**    | You can choose pie chart or donut chart as the display style.                                                                                                                   |
| **Table**    | **Table Settings**    | <br /> **Hide Column**: You can reduce the number of columns in the table by setting this parameter, allowing you to focus on key column information.<br /> **Column Alignment**: You can modify the alignment of data within the columns through this setting.<br /> **Display Name and Unit**: You can modify the column names and the units used through this setting. |
| **Text Card**  | **Graph Style**    | <br /> **Style**: You can choose to use a rich text editing box or HTML to edit the content you wish to display in the text card.                                                                              |

## Creating a Monitoring Dashboard via CLI

1. Create a new YAML configuration file named `example-dashboard.yaml`.
2. Add the MonitorDashboard resource to the YAML file and submit that file. The following example creates a monitoring dashboard named `demo-v2-dashboard1`:

```yaml
kind: MonitorDashboard
apiVersion: ait.alauda.io/v1alpha2
metadata:
  annotations:
    cpaas.io/dashboard.version: "3"
    cpaas.io/description: '{"zh":"描述信息","en":""}' # Description field
    cpaas.io/operator: admin
  labels:
    cpaas.io/dashboard.folder: demo-v2-folder1 # Folder
    cpaas.io/dashboard.is.home.dashboard: "False" # Is it the main dashboard?
  name: demo-v2-dashboard1 # Name
  namespace: cpaas-system  # Location ns (Management view creation in this ns)
spec:
  body: # All information fields
    titleZh: 更新显示名称 # Built-in field for Chinese display name (created under Chinese language as this field)
    title: english_display_name # Built-in field for English display name (created under English language as this field)  Built-in dashboards can set Chinese and English translations
    templating: # Custom Variables
      list:
        - hide: 0 # 0 means not hidden, 1 means only hide label, 2 means hide label and value
          label: 集群 # Built-in variable display name (label will set different names based on language, in English as cluster)
          name: cluster # Built-in variable name (unique)
          options: # Dropdown options can be defined. If the query can be retrieved, use the requested data; otherwise, use options and a default value can be set (generally used only for setting the default value)
            - selected: false # Whether selected by default
              text: global
              value: global
          type: custom # Custom variable type. Currently, only built-in (custom) and query types are supported on the page (imported Grafana supports constant custom interval—after import, it will convert to custom variable and not support auto)
 
        - allValue: "" # Selecting all means that the passed value is in options options split by | (xxx|xxx|xxx); it can set allValue for conversion (Grafana is all data for the current variable, xxx|xxx|xxx will adjust after)
          current: null # Current variable value; if not set, it is the first in the list
          definition: query_result(kube_namespace_labels) # Query expression to request data
          hide: 0 # 0 means not hidden, 1 means only hide label, 2 means hide label and value
          includeAll: true # Whether to select all
          label: ns # Built-in variable display name
          multi: true # Whether multi-select
          name: ns # Variable name (unique)
          options: []
          query: ""
          regex: /.*namespace=\"(.*?)\".*/ # Regex to extract variable values
          sort: 2 # Sorting, 1: sorted in ascending order alphabetically, 2: sorted in descending order alphabetically (currently only these two are supported) 3: sorted ascending numerically 4: sorted descending numerically
          type: query # Custom variable type
    time: # Dashboard time
      from: now-30m # Start time
      to: now # End time
    repeat: '' # row repeat configuration, selected is the custom variable
    collapsed: 'false' # row whether to expand or collapse configuration
    description: "123" # Description (description after the title)
    targets: # Data source
      - indicator: cluster.node.ready # Metric
        expr: sum (cpaas_pod_number{cluster=\"\"}>0) # PromQL expression
        instant: false # Query mode true means query data at a time point
        legendFormat: "" # Icon
        range: true # Query default range time data
        refId: 指标1 # Unique identifier, data source display name
    gridPos: # Panel positioning information
        h: 8 # Height
        w: 12 # Width (width of 24 grids)
        x: 0 # Horizontal coordinate position
        y: 0 # Vertical coordinate position
    panels: # Panel data
      title: 图表标题tab # Chart name
      type: table # Chart type; currently supports timeseries, barchart, stat, gauge, table, bargauge, row, text, pie (step charts, scatter plots, bar charts are configured through drawStyle property)
      id: a2239830-492f-4d27-98f3-cb7ecb77c56f # Unique identifier
      links: # Links
        - targetBlank: true # Open in a new tab
          title: "1" # Name
          url: "1" # URL address
      transformations: # Data transformations
        - id: "organize" # Type organize; used for sorting, adjusting order, displaying fields, deciding whether to show
          options:
            excludeByName: # Hide fields
              cluster_cpu_utilization: true
            indexByName: # Sorting
                cluster_cpu_utilization: 0,
                Time: 1
            renameByName: # Rename
              Time: ""
              cluster_cpu_utilization: "222"
        - id: "merge" # Merge data
          options:
      fieldConfig: # Used to define chart attributes and appearance
        defaults: # Default configuration
          custom: # Custom icon attributes
            align: "left" # table alignment left center right
            cellOptions: # table threshold configuration
              type: color-text # Only supports text threshold color settings
            spanNulls: false # true connects empty values, false does not connect; number == 0 connects empty values according to 0 
            drawStyle: line # Chart type line, bars for bar charts, points for point charts,
            fillOpacity: 20 # Exists when drawStyle is area (currently not supported; area under defaults to 20)
            thresholdsStyle: # Configure threshold display formats (currently only supports line)
              mode: line # Line display format (area currently not supported)
            lineInterpolation: 'stepBefore' # Line chart configuration defaults to only support stepBefore (stepAfter will be supported in the future)
          decimals: 3 # Decimal points
          min: 0 # Minimum value (currently does not support page configuration; support for import adapted)
          max: 1 # Maximum value (page configuration only applies to stat gauge barGauge pie)
          unit: "%" # Unit
          mappings: # Value mapping configurations (currently only supports value and range types; special type supported on data)
            - options: # Value mapping rules
                "1": # Corresponding value
                  index: 0
                  text: "Running" # Value is 1 displayed as Running
              type: value # Value mapping
            - options: # Range mapping rules
                from: 2 # Range start value
                to: 3 # Range end value
                result: # Mapping results
                  index: 1
                  text: "Error" # Value from 2 to 3 will display as Error
              type: range # Range mapping type
            - type: special # Special mapping type
              options:
                match: null # nan null null+nan empty true false
                result:
                  text: xxx
                  index: 2
          thresholds: # Threshold configurations
            mode: absolute # Threshold configuration mode; absolute mode (currently only supports absolute and percentage mode; percentage mode not supported)
            steps: # Threshold steps
              - color: "#a7772f" # Threshold color
                value: "2" # Threshold value
              - color: "#007AF5" # Value with no value is the default Base
        overrides: # Override configurations
          - matcher:
              id: byName # Match by field name
              options: node # Corresponding name
            properties: # Override configurations id currently only supports displayName unit
              - id: displayName # Display name override
                value: "1" # Overridden display name
              - id: unit # Unit override
                value: GB/s # Unit value
              - id: noValue # No value display
                value: 无值展示
      options:
        orientation: horizontal # Control chart layout direction; effective for gauge barGauge (stat will be supported later)
        legend: # Legend configuration
          calcs: # Calculation methods (only displayed when legend position is right)
            - latest # Temporarily only supports latest value
          placement: right # Legend position; right, bottom (default is bottom)
          placementRightTop: "" # Right top configuration
          showLegend: true # Whether to display the legend
        tooltip: # Tooltip
          mode: multi # Mode multi-selection mode (only supports multi-mode) mouse over shows all data
          sort: asc # Sorting asc desc ascending descending
        reduceOptions: # Value calculation methods (used for data aggregation)
          calcs: # Calculation methods (latest, minimum, maximum, average, sum)
            - latest
          limit: 3 # Pie limit count
        textMode: 'value' # Stat configuration defines the display style of the metric value; auto, value, value_and_name, name, none (page temporarily does not support configuration; supports import adaptation)
        colorMode: 'value' # Stat configuration defines the color display mode of the metric value; none, value, background (default value; does not support configuration but import has adapted)
        displayLabels: ['name','value', 'percent'] # Pie chart label display fields
        pieType: "pie" # Pie chart type; pie donut
        mode: 'html' # Text chart type mode; html, richText (ie rich text)
        content: '<div>xxx</div>' # Text content for text chart type
        footer:
          enablePagination: true # Table whether to enable pagination
```

## Common Functions and Variables

### Common Functions

When defining query settings, in addition to using PromQL to query time series, the platform also offers some common functions that you can refer to for customizing query settings.

| Function                               | Purpose                                                                          |
| -------------------------------- | --------------------------------------------------------------------------- |
| **label_names()**               | Returns all labels in Prometheus, e.g., label_names()                                 |
| **label_values(label)**         | Returns all selectable values with the label name in all Prometheus monitoring metrics, e.g., label_values(job)               |
| **label_values(metric, label)** | Returns all selectable values for the label name in the metric monitoring metrics, e.g., label_values(up{}, job) |
| **metrics(metric)**              | Returns all metric names satisfying the regex defined by metric, e.g., metrics(cpaas_active)                    |
| **query_result(query)**         | Returns the query results of the Prometheus query statement, e.g., query_result(up{})                              |

### Common Variables

When defining query settings, you can combine common functions into variables to quickly customize variables. Here are some commonly used variable definitions:

| Variable Name            | Query Function                                                                                  | Regex                       |
| --------------- | ------------------------------------------------------------------------------------- | ----------------------------- |
| **cluster**     | -                                                                                     | -                             |
| **node**        | `label_values(node_load1, instance)`                                                  | `/(.*?):.*/`                |
| **namespace**   | `query_result(kube_namespace_labels)`                                                 | `/.*namespace=\"(.*?)\".*/` |
| **deployment**  | `label_values(kube_deployment_spec_replicas{namespace="$namespace"}, deployment)`     | -                             |
| **daemonset**   | `label_values(kube_daemonset_status_number_ready{namespace="$namespace"}, daemonset)` | -                             |
| **statefulset** | `label_values(kube_statefulset_replicas{namespace="$namespace"}, statefulset)`        | -                             |
| **pod**         | `label_values(kube_pod_info{namespace=~"$namespace"}, pod)`                           | -                             |
| **vmcluster**   | `label_values(up, vmcluster)`                                                         | -                             |
| **daemonset**   | `label_values(kube_daemonset_status_number_ready{namespace="$namespace"}, daemonset)` | -                             |

### Variable Usage Practice One

Using the **query_result(query)** function to query the value: `node_load5`, and extracting the IP.

1. In **Query Settings**, fill in `query_result(node_load5)`.

2. In **Variable Value Preview**, preview example `node_load5{container="node-exporter",endpoint="metrics",host_ip="192.168.178.182",instance="192.168.178.182:9100"}`.

3. In the **Regex**, fill in `/.*instance="(.*?):.*/` to filter values.

4. In **Variable Value Preview**, the preview example is `192.168.176.163`.

### Variable Usage Practice Two

1. Add the first variable: namespace, using **query_result(query)** function to query the value: `kube_namespace_labels`, and extract the namespace.

   - **Query Settings**: `query_result(kube_namespace_labels)`.

   - **Variable Value Preview** `kube_namespace_labels{container="exporter-kube-state", endpoint="kube-state-metrics", instance="12.3.188.121:8080", job="kube-state", label_cpaas_io_project="cpaas-system", namespace="cert-manager", pod="kube-prometheus-exporter-kube-state-55bb6bc67f-lpgtx", project="cpaas-system", service="kube-prometheus-exporter-kube-state"}`.

   - **Regex**: `/.*namespace=\"(.*?)\".*/`.

   - **Variable Value Preview** area, preview examples include `argocd`, `cpaas-system`, and multiple namespaces.

2. Add a second variable: deployment, referencing the variable just created:

   - **Query Settings**: `kube_deployment_spec_replicas{namespace=~"$namespace"}`

   - **Regex**: `/.*deployment="(.*?)",.*/`.

3. Add a chart under the panel, referencing the variables added earlier. For example:

   - The metric name is: **Memory Utilization of Container Groups under the Computing Component**.

   - Key-value pairs: `kind`: `Deployment`, `name`: `$deployment`, `namespace`: `$namespace`.

4. After adding the chart and saving, you can view the corresponding chart information on the dashboard homepage.

### Note When Using Built-in Metrics

:::warning

The custom variables used for the following metrics: `namespace`, `name`, and `kind` do not support **multi-select** or selection of **all**.

- `namespace` only supports selecting specific namespaces;
- `name` only supports three types of computing components: `deployment`, `daemonset`, `statefulset`;
- `kind` only supports filling in one of the types: `Deployment`, `DaemonSet`, `StatefulSet`.

:::

- `workload.cpu.utilization`

- `workload.memory.utilization`

- `workload.network.receive.bytes.rate`

- `workload.network.transmit.bytes.rate`

- `workload.gpu.utilization`

- `workload.gpu.memory.utilization`

- `workload.vgpu.utilization`

- `workload.vgpu.memory.utilization`
