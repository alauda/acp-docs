---
weight: 60
sourceSHA: 9815de7814e8701dedfe63c4d021af99ed2758d972a2808a3ab626511a6def9a
---

# Understanding Kustomize in Depth

## Introduction

Kustomize is a Kubernetes-native configuration management tool that allows users to customize Kubernetes resource definitions (YAML files) through layering and composition, without directly modifying the original files.

## Core Concepts of Kustomize

- Base: The base configuration containing common Kubernetes resource definitions.
- Overlay: A customization layer that modifies the Base.
- kustomization.yaml: The configuration file that defines how to combine and modify resources.

The integration of Argo CD with Kustomize makes GitOps practices more efficient, enabling declarative continuous delivery. An example is shown below:

```yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: kustomize-example
spec:
  project: default
  source:
    path: examples/helloWorld
    repoURL: 'https://github.com/kubernetes-sigs/kustomize'
    targetRevision: HEAD
  destination:
    namespace: default
    server: 'https://kubernetes.default.svc'
```

If the `repoURL` and `path` point to a location with a `kustomization.yaml` file, Argo CD will use Kustomize to render the manifests.

Kustomize has the following configuration options:

- `namePrefix` is a prefix added to Kustomize application resources.
- `nameSuffix` is a suffix added to Kustomize application resources.
- `images` is a list of image overrides in Kustomize.
- `replicas` is a list of replica overrides in Kustomize.
- `commonLabels` is a string mapping for additional labels.
- `labelWithoutSelector` is a boolean that defines whether common labels should be applied to resource selectors and templates.
- `forceCommonLabels` is a boolean that defines whether existing labels can be overridden.
- `commonAnnotations` is a string mapping for additional annotations.
- `namespace` is the namespace of Kubernetes resources.
- `forceCommonAnnotations` is a boolean that defines whether existing annotations can be overridden.
- `commonAnnotationsEnvsubst` is a boolean that allows environment variable substitution in annotation values.
- `patches` is a list of Kustomize patches that support inline updates.
- `components` is a list of Kustomize components.

To use Kustomize with overlays, point your path to the overlay.

## Advantages

- Declarative Configuration: Based on YAML files, defining the combination and modification of resources through kustomization.yaml.
- No Templates: Configuration customization is achieved through Patch and Overlay without the need for a template engine.
- Native Integration with Kubernetes: Kustomize is part of kubectl, requiring no additional tools.

## Use Cases

- Multi-Environment Distribution: Achieving environment differentiation in configurations through Base and Overlay for managing application, cluster, and other environmental variations.
- Configuration Reuse: Suitable for scenarios that require reusing base configurations.
- Progressive Release: Gradually adjusting resource configurations through Patch.

# References

For more detailed information, please refer to: [Kustomize](https://argo-cd.readthedocs.io/en/stable/user-guide/kustomize/)
