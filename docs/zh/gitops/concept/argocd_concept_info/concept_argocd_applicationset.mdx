---
weight: 30
---

# 深入理解 ApplicationSet

## ApplicationSet 介绍
ApplicationSet 是一个 Kubernetes 控制器，它添加了对 ApplicationSet CustomResourceDefinition (CRD) 的支持。它允许您使用一个模板来生成多个 Application。ApplicationSet 可以看作是一个 Application 的工厂，它可以根据不同的参数生成多个 Application 实例。它可实现自动化和更大的灵活性，从而实现跨大量集群和 monorepos 管理 Argo CD 应用程序（Application），此外，它还使在多租户 Kubernetes 集群上实现自助服务成为可能。

## ApplicationSet 适用场景
- 多个相似应用程序部署： 当您需要部署多个具有相似配置的应用程序时，可以使用 ApplicationSet 来减少重复配置。例如，您可以使用 ApplicationSet 来部署多个微服务，它们都使用相同的模板，但具有不同的服务名称和端口号。
- 多集群部署： 当您需要在多个 Kubernetes 集群中部署相同的应用程序时，可以使用 ApplicationSet 来简化配置。例如，您可以使用 ApplicationSet 来定义一个应用程序，并将其部署到多个集群中，每个集群使用不同的参数。
- 动态生成应用程序： 当您需要根据某些条件动态生成应用程序时，可以使用 ApplicationSet。例如，您可以根据 Git 仓库中的分支或标签来动态生成不同的应用程序实例。

## ApplicationSet 示例

```
apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: guestbook
spec:
  goTemplate: true
  goTemplateOptions: ["missingkey=error"]
  generators:
  - list:
      elements:
      - cluster: engineering-dev
        url: https://1.2.3.4
      - cluster: engineering-prod
        url: https://2.4.6.8
      - cluster: finance-preprod
        url: https://9.8.7.6
  template:
    metadata:
      name: '{{.cluster}}-guestbook'
    spec:
      project: my-project
      source:
        repoURL: https://github.com/infra-team/cluster-deployments.git
        targetRevision: HEAD
        path: guestbook/{{.cluster}}
      destination:
        server: '{{.url}}'
        namespace: guestbook
``` 

## 参考资料
- [Argo CD 官方文档](https://argo-cd.readthedocs.io/en/stable/)

