---
weight: 50
---

# 深入理解 Helm
## 介绍
Helm 是一个用于 Kubernetes 的包管理工具，允许用户定义、安装和升级复杂的 Kubernetes 应用程序。Helm 图表是 Helm 包的模板化配置，包含 Kubernetes 资源定义（YAML 文件）。

## Helm 的核心概念
- Chart：Helm 图表是 Helm 包的模板化配置，包含 Kubernetes 资源定义（YAML 文件）。
- Release：Helm 发布是 Helm 图表的实例，包含 Kubernetes 资源定义（YAML 文件）。
- Values：Helm 值是 Helm 图表的参数化配置，允许用户自定义 Kubernetes 资源定义（YAML 文件）。

Argo CD 与 Helm 的集成使得 GitOps 实践更加高效，可通过平台 UI、Argo CD Dashboard、CLI 实现声明式的持续交付，示例如下:

```
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: sealed-secrets
  namespace: argocd
spec:
  project: default
  source:
    chart: sealed-secrets
    repoURL: https://bitnami-labs.github.io/sealed-secrets
    targetRevision: 1.16.1
    helm:
      releaseName: sealed-secrets
  destination:
    server: "https://kubernetes.default.svc"
    namespace: kubeseal
```

OCI Helm Chart 示例：

```
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: nginx
spec:
  project: default
  source:
    chart: nginx
    repoURL: registry-1.docker.io/bitnamicharts  # note: the oci:// syntax is not included.
    targetRevision: 15.9.0
  destination:
    name: "in-cluster"
    namespace: nginx
```
:::info
- Application 的生命周期由 Argo CD 控制，而不是 Helm。
- 使用多种方式提供值时：优先顺序是 parameters > valuesObject > values > valueFiles > helm repository values.yaml。
:::

## 优势
- 模板化：Helm 使用 Go 模板引擎（gotpl）动态生成 Kubernetes 资源文件。

- 包管理：Helm 将应用打包为 Chart（包含模板、默认值和依赖关系），便于分发和版本管理。

- 依赖管理：支持 Chart 之间的依赖关系。

- 生命周期管理：提供 `install`、`upgrade`、`rollback` 等命令，管理应用的全生命周期。

## 使用场景

- 复杂应用部署：适合需要动态生成配置的场景，如：根据环境变量或用户输入生成资源等。

- 多环境部署：通过 `values.yaml` 文件支持不同环境的配置。

- 应用分发：适合将应用打包为 Chart 并发布到 Helm 仓库、OCI Chart 仓库等。

# 参考资料

更加详细的说明请参考：[Helm](https://argo-cd.readthedocs.io/en/stable/user-guide/helm/)
