---
weight: 10
---

# 通过平台 UI 创建 Argo CD Application

## 功能简介
通过 Alauda GitOps 应用管理能力，可视化创建 Argo CD Application，实现通过 GitOps 进行容器化应用的全生命周期管理。

## 前提条件 

- global 集群已部署 Alauda GitOps 集群插件。

        **说明**：如未部署请联系平台管理员为您部署。
        

- Git 仓库集成，可选择以下任意一种方式：
    - [通过 Argo CD 集成代码仓库](../../how_to/argocd_git.mdx)
    - 您需要具有项目的管理权限，且平台管理员已在 工具链管理 > 工具链集成 中集成或部署了 GitLab 仓库，并分配给您的项目使用。

## 功能优势

- 可视化的 GitOps 应用分发管理：结合平台多集群管理、差异化配置等能力，实现与平台风格统一的可视化 GitOps 应用管理、集群配置管理，让多云、多环境的精准分发更简单易用。


## 创建 GitOps 应用

> 通过可视化管理界面实现 GitOps 应用的分发，简化发布流程。

### 操作步骤

1. 在左侧导航栏中，单击 **GitOps 应用**。

2. 单击 **创建 GitOps 应用**。

3. 在 **基本信息** 及 **代码仓库** 区域，参考以下说明配置相关信息。

|   **参数**                       | **说明** | 
| :----- | :--------------------------------- |
|   **类型**                       |**Application**：Argo CD 定义的 Application。简单易用，资源消耗更小，可将应用分发到指定的命名空间。<br/> **ApplicationSet**：Argo CD 定义的 ApplicationSet。多层级覆盖差异化配置，可用于跨集群、跨命名空间分发，适合有多环境分发、容灾或边缘等场景下使用。 |
|   **来源**                       |**平台集成**：选择使用平台集成的、且已经分配给所在项目使用的代码仓库，平台支持 GitLab、GitHub 及 Bitbucket。<br/> **Argo CD 集成**：选择使用 Argo CD 集成的代码仓库，支持 GitLab、GitHub、Bitbucket、Gitee 及 Gitea，具体集成方式请参考 [通过 Argo CD 集成代码仓库] |
|  **集成项目名称**                 | 平台管理员分配或关联给您项目使用的集成工具项目名称。|
|  **版本标识**                     | 支持基于代码仓库中的 Branch、Tag 或 Commit 创建应用。<br/>**说明：** <br/> - 当版本标识为 Branch 时，仅支持使用选择的分支下最新的 Commit 创建应用。<br/> - 当版本标识为 Tag 或 Commit 时，默认选择代码仓库中最新的 Tag 或 Commit，您也可以按需选择其他版本。|
|  **源文件类型**                   | 基于 **源文件目录** 选择需要实现差异化配置的资源文件的文件类型，此参数与 **分发位置** 区域的 **差异化配置** 关联。<br/>**Kustomize**：Kustomize Overlay 目录中包含了 Kustomization 文件和资源文件，用于描述如何修改基础配置，具体请参见 [Kustomize 官方文档](https://kubectl.docs.kubernetes.io/zh/guides/)。您可在应用实例分发时选择 Overlay 目录，实现差异化配置。<br/>**Helm**：Helm Value 文件包含了应用程序的各种配置选项、参数和设置，这些值可以被模板引擎引用，并按需生成配置文件，使得配置可以在不同环境中重用和调整，具体请参见 [Helm 官方文档](https://helm.sh/zh/docs/chart_template_guide/values_files/)。您可在应用实例分发时选择 Value 文件，实现差异化配置。<br/>**Directory**：所选 **源文件目录及其子目录** 下的资源都将分发至目标集群。|   
|  **源文件目录**                   |基础配置所在的仓库目录，允许选择根目录。该目录下的资源会被分发至目标集群，目标集群根据资源文件部署资源、创建应用。|   
|  **自定义 Values**               | 当源文件类型为 Helm 时，支持选择自定义 Helm Values 文件。|  

4. 在 **分发位置** 区域，参考一下说明配置相关信息。

    - **当 GitOps 应用类型为 Application**：选择当前项目下的一个命名空间，并将应用分发至此命名空间中。

    - **当 GitOps 应用类型为 ApplicationSet**：将应用分发至集群的命名空间中，当分发的应用需要 **差异化配置** 时，可以按需选择差异化配置文件或目录。

     **说明**：差异化配置仅与 **源文件类型** 有关，不影响 **源文件目录** 中的基础配置文件，且同一集群可同时选择多个命名空间进行分发及差异化配置。

5. 设置同步策略，平台每 3 分钟会对集群资源及仓库配置进行一次检测。

    |参数| 说明                                                         |
    | --------------------- | ------------------------------------------------------------ |
    |**手动同步**| 当检测到集群中资源状态与仓库中期望状态不一致时，会提醒您及时进行同步操作，确保资源状态与期望状态保持一致。|
    |**自动同步**| 当检测到集群中资源状态与仓库中期望状态不一致时，无需人工干预，平台会自动触发同步操作，确保资源状态与期望状态保持一致。 |
    |**同步忽略配置**|忽略所选 **源文件目录** 下指定资源文件中的字段，在首次同步后，忽略的资源或字段不再随同步策略强制同步更新。您可以选择使用平台内置或自定义的同步忽略配置模板实现同步忽略配置，配置完成后可 [查看 YAML 文件中的同步忽略配置字段](#viewyaml)。<br/>**说明**：若需使用自定义同步忽略配置模板，请联系平台管理员配置。|   

6. 单击 **创建**。

    **说明**：当同步策略为 **手动同步** 时，需手动触发一次同步，平台才会从仓库拉取相关配置并进行 Application 分发等操作，此时单击 **创建** ，可以按需选择立即同步或稍后同步。<br/>**立即同步**：立即从仓库拉取相关配置并进行 Application 分发等操作。<br/>**稍后同步**：先不从仓库拉取相关配置，后续有需要时，再手动单击详情页面的 **同步** 按钮从仓库拉取相关配置并进行 Application 分发等操作。

<a id="viewyaml"></a>
### 查看 YAML 文件中的同步忽略配置字段

选择自定义模板作为同步忽略配置模板并创建 GitOps 应用后，可通过 YAML 文件查看同步忽略配置字段，具体查看步骤如下。

1. 在左侧导航栏中，单击 **GitOps 应用**。

2. 单击创建的 ***GitOps 应用名称***。

3. 单击详情页面右上角 **操作** > **更新**。

4. 可在 YAML 文件中查看如下忽略配置字段。

```yaml
ignoreDifferences: # 所选自定义同步忽略配置模板实际忽略的配置
- group: apps
  kind: Deployment
  jsonPointers:
  - /spec/replicas
```
## 管理 GitOps 应用
| 操作   | 说明                               |
| :----- | :--------------------------------- |
| **更新** | 在 GitOps 应用列表页面单击  或在详情页面单击右上角的 操作 > 更新，可更新应用。<br/>**注意**：更新应用将覆盖所有已分发的应用实例。 |
| **同步** | 当 同步策略 为手动同步时，若代码仓库中的配置文件发生变化，应用实例的同步状态将显示为 待同步。此时，您可以在详情页面单击右上角的 操作 > 同步，同步 GitOps 应用，同步后已分发的所有应用实例都将更新至最新版本。 |
| **删除** | 在 GitOps 应用列表页面单击  或在详情页面单击右上角的 操作 > 删除，可删除应用。<br/>**注意**：删除应用的同时将删除应用下所有已分发的应用实例，请谨慎操作。 |
| **同步** | 在 GitOps 应用列表页面单击  或在详情页面单击右上角的 操作 > 同步，可同步应用。<br/>**注意**：同步应用将同步所有已分发的应用实例。 |
| **查看来源** | 创建 **ApplicationSet** 类型的 GitOps 应用时，会创建相应的带有来源信息的 **Application** 类型应用。在 GitOps 应用列表页面单击 **来源** 链接，即可跳转至对应的 **ApplicationSet** 类型应用的详情信息页面，查看对应详情信息。 |
| **应用分发** | 应用创建完成后可以通过如下两种方式进行应用分发：<br/> - 通过更新操作修改已有配置或新增应用分发。<br/> - 在 GitOps 应用列表页面单击 **ApplicationSet** 类型应用 的名称，单击 **Application** 区域的 **Application** 分发 新增应用分发。|


