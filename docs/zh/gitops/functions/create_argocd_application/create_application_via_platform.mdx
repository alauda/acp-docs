---
weight: 10
i18n:
  title:
    en: Creating GitOps Application
    zh: 创建 GitOps 的 Application
title: 创建 GitOps 的 Application
sourceSHA: aa9e888425fffac5d1608c1878aefd1a2ccdc643f975a66705507f71489d4368
---

# 创建 GitOps 的 Application

# 概述

利用 **ACP GitOps** 的应用管理能力，通过 **GitOps Applications** 直观地创建 Argo CD ApplicationSet，实现容器化应用的全面生命周期管理。

## 前提条件

- **安装 ACP GitOps**：
  - 如果未安装，请联系管理员以 [安装 ACP GitOps](/gitops/install_gitops/install_gitops_plugin.mdx)

- **Git 仓库集成**（选择一种方法）：
  - [通过 Argo CD 仪表板集成代码仓库](../../how_to/argocd_git.mdx)
  - 管理员必须通过 **DevOps 工具链** > **集成** 提供代码仓库

## 通过网页控制台创建 Argo CD 应用

> 通过可视化管理界面简化应用分发。

### 操作步骤

1. **容器平台**，并导航到 **GitOps Applications**。

2. 点击 **创建 GitOps 应用**。

3. 在 **基本信息** 和 **代码仓库** 部分配置参数：

| **参数**                     | **描述**                                                                                                                                                                                                                                                                                                                                                                                             |
| :---------------------------  | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **类型**                     | **应用**： Argo CD 应用对象用于单命名空间部署 <br /> **ApplicationSet**：Argo CD ApplicationSet 用于跨集群/跨命名空间的差异化配置部署                                                                                                                                                                                                                                                          |
| **来源**                     | **平台集成**：预配置的 GitLab/GitHub/Bitbucket 仓库 <br /> **ArgoCD 集成**：通过 Argo CD 集成的 GitLab/GitHub/Bitbucket/Gitee/Gitea 仓库。请参考 [通过 Argo CD 仪表板集成代码仓库](../../how_to/argocd_git.mdx)                                                                                                                                                                                                                  |
| **集成项目名称**             | 管理员分配的工具链项目                                                                                                                                                                                                                                                                                                                                                                          |
| **版本标识**                 | 部署基础： `Branch`/`Tag`/`Commit`<br />**注意**：<ul><li>`Branch` 使用最新提交<br /></li><li>`Tag`/`Commit` 默认使用最新但可配置</li></ul>                                                                                                                                                                                                                                               |
| **源文件类型**               | **Kustomize**：使用 kustomization.yaml 进行覆盖配置；有关更多详细信息，请参见 [Kustomize 官方文档](https://kubectl.docs.kubernetes.io/guides/) <br />**Helm**：使用 values.yaml 进行模板；有关更多详细信息，请参见 [Helm 官方文档](https://helm.sh/docs/chart_template_guide/values_files/) <br />**目录**：原始清单 |
| **源目录**                   | 包含基础清单的仓库路径。支持选择根目录。该路径中的所有资源将被部署到目标集群                                                                                                                                                                                                                                                                                                                                |
| **自定义值**                 | 如果 **源文件类型** 为 **Helm**，您可以选择自定义的 Helm 值文件                                                                                                                                                                                                                                                                                                                             |

4. 在 **目标** 部分配置参数：

   - **应用**：差异配置不会修改源目录中的基础文件。

   - **ApplicationSet**：具有 **差异化配置** 的多集群部署。

   **注意**：**差异化配置** 不会修改 **源目录** 中的基础文件。

5. **同步策略**（3分钟调和间隔）。

   | **参数**                    | **描述**                                                                                                                                                                          |
   | :--------------------------  | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **手动同步**                 | 检测到偏差时需要用户确认。                                                                                                                                                 |
   | **自动同步**                 | 自动调和，无需人工干预。                                                                                                                                                    |
   | **同步忽略配置**            | 使用内置/自定义忽略模板进行配置，您可以 [查看 YAML 文件中的同步忽略配置字段](#viewyaml)。<br /> **注意**：自定义模板需要管理员配置。 |

6. 点击 **创建**。

:::info
**手动同步说明**：选择 **立即同步** 进行即时部署，或选择 **稍后同步** 通过详细页面手动触发。
:::

<a id="viewyaml" />

### 查看 YAML 文件中的同步忽略配置字段

在配置同步忽略规则后，通过以下方式验证：

1. 导航到 **GitOps 应用**

2. 选择目标应用

3. 点击 **操作 > 更新**

4. 检查 YAML 文件。

```yaml
ignoreDifferences: # 由所选的自定义同步忽略配置模板实际忽略的配置
- group: apps
  kind: Deployment
  jsonPointers:
  - /spec/replicas
```

## 通过 YAML 创建 Argo CD 应用

### 操作步骤

1. **容器平台**，并导航到 **GitOps Applications**。

2. 点击 **创建 GitOps 应用**。

3. 切换到 **YAML** 标签。

4. 在 **YAML** 部分，参考以下 YAML 文件并配置相关信息。将 `namespace` 和 `project` 替换为您自己的命名空间和项目。

```yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: guestbook
  namespace: argocd # 替换为您自己的命名空间
spec:
  project: default # 替换为您自己的项目
  source:
    repoURL: https://github.com/argoproj/argocd-example-apps.git
    targetRevision: master
    path: helm-guestbook
  destination:
    server: https://kubernetes.default.svc
    namespace: guestbook
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
    - CreateNamespace=true
```

5. 点击 **创建**。

## 通过 CLI 创建 Argo CD 应用

### 前提条件

已安装 web-cli 插件，并启用了 `web-cli` 开关。

```bash
kubectl apply -f application.yaml
```
