---
weight: 10
i18n:
  title:
    en: Creating GitOps ApplicationSet
    zh: 创建 GitOps 的 ApplicationSet
title: 创建 GitOps 的 ApplicationSet
sourceSHA: fc42ba7fbf448f4dfa0525e8bcbec8d0a96413f23fe32a14a1e7b532115c0a71
---

# 创建 GitOps 的 ApplicationSet

## 概述

利用 **ACP GitOps** 应用管理功能，直观地创建 Argo CD ApplicationSet，以通过 **GitOps 应用** 实现容器化应用的全面生命周期管理。

## 前提条件

- **安装 ACP GitOps**：
  - 如果尚未安装，请联系管理员进行 [安装 ACP GitOps](/gitops/install_gitops/install_gitops_plugin.mdx)

- **Git 仓库集成**（选择一种方法）：
  - [通过 Argo CD 仪表板集成代码仓库](../../how_to/argocd_git.mdx)
  - 管理员必须通过 **DevOps 工具链** > **集成** 配置代码仓库

## 主要收益

- **可视化 GitOps 应用分发**：结合多集群管理、差异配置和平台对齐的可视化操作，简化多云/多环境的部署过程。

## 创建 GitOps 应用

> 通过可视化管理界面简化应用分发。

### 流程

1. 在 **容器平台** 中，导航到 **GitOps 应用**。

2. 点击 **创建 GitOps 应用**。

3. 在 **基本信息** 和 **代码仓库** 部分配置参数：

| **参数**                    | **描述**                                                                                                                                                                                                                                                                                                                                                                                             |
| :-------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **类型**                    | **应用**：用于单命名空间部署的 Argo CD 应用对象 <br /> **ApplicationSet**：用于跨集群/跨命名空间部署并具有差异配置的 Argo CD ApplicationSet                                                                                                                                                                                                                          |
| **来源**                    | **已集成的平台**：预配置的 GitLab/GitHub/Bitbucket 仓库 <br /> **与 ArgoCD 集成**：通过 Argo CD 集成的 GitLab/GitHub/Bitbucket/Gitee/Gitea 仓库。有关更多信息，请参阅 [通过 Argo CD 仪表板集成代码仓库](../../how_to/argocd_git.mdx)                                                                                                                     |
| **集成项目名称**            | 管理员分配的工具链项目                                                                                                                                                                                                                                                                                                                                                                                       |
| **版本标识符**              | 部署基础：`分支`/`标签`/`提交` <br />**注意**：<ul><li>`分支` 使用最新提交</li><li>`标签`/`提交` 默认使用最新但可配置</li></ul>                                                                                                                                                                                                                                           |
| **源文件类型**              | **Kustomize**：使用 `kustomization.yaml` 进行叠加配置；有关更多详细信息，请参阅 [Kustomize 官方文档](https://kubectl.docs.kubernetes.io/guides/) <br />**Helm**：使用 values.yaml 进行模板化；有关更多详细信息，请参阅 [Helm 官方文档](https://helm.sh/docs/chart_template_guide/values_files/) <br />**目录**：原始清单 |
| **源目录**                  | 包含基本清单的仓库路径。支持选择根目录。此路径中的所有资源将部署到目标集群                                                                                                                                                                                                                                                                                                                             |
| **自定义值**                | 当 **源文件类型** 为 **Helm** 时，可以选择自定义 Helm 值文件                                                                                                                                                                                                                                                                                                                                               |

4. 在 **目标** 部分配置参数：

   - **应用**：差异配置不会修改源目录中的基本文件。

   - **ApplicationSet**：使用 **差异化配置** 进行多集群部署。

   **注意**：**差异化配置** 不会修改 **源目录** 中的基本文件。

5. **同步策略**（3 分钟的协调间隔）。

   | **参数**                   | **描述**                                                                                                                                                                         |
   | :------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | **手动同步**               | 检测到漂移时需要用户确认                                                                                                                                                      |
   | **自动同步**               | 无需人工干预的自动协调                                                                                                                                                        |
   | **同步忽略配置**          | 使用内置/自定义忽略模板进行配置，您可以 [查看 YAML 文件中的同步忽略配置字段](#viewyaml) <br /> **注意**：自定义模板需要管理员配置 |

6. 点击 **创建**。

:::info
**手动同步注意**：选择 **立即同步** 进行立即部署或选择 **稍后同步** 以便通过详情页面手动触发。
:::

<a id="viewyaml" />

### 查看 YAML 文件中的同步忽略配置字段

在配置同步忽略规则后，请通过以下步骤进行验证：

1. 导航到 **GitOps 应用**。

2. 选择目标应用。

3. 点击 **操作** > **更新**。

4. 检查 YAML 文件。

```yaml
ignoreDifferences: # 实际被选定的自定义同步忽略配置模板忽略的配置
- group: apps
  kind: Deployment
  jsonPointers:
  - /spec/replicas
```

## 管理 GitOps 应用

| **操作**                  | **描述**                                                                                                                                                                                                             |
| :----------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **更新**                  | 通过以下方式发起更新：<ul><li>在 **GitOps 应用** 列表中点击编辑图标 (✎) </li><li>在详情视图中选择 **操作** > **更新** 。</li><li>**注意**：此操作将覆盖所有创建的应用实例</li></ul> |
| **手动同步**              | 当 **同步策略** 为 **手动同步** 时：<ul><li>在检测到配置漂移后，通过在详情视图中选择 **操作** > **同步** 启动同步 </li><li> 将最新提交传播到所有管理实例</li></ul>         |
| **删除**                  | 通过以下方式删除：<ul><li>在列表页面点击删除图标 (🗑)</li><li>在详情视图中选择 **操作** > **删除**</li><li>**破坏性**：删除应用及所有子资源</li></ul>                                             |
| **自动同步**              | 启用自动协调以维持所需状态。所有实例每 3 分钟自动与仓库的更改同步                                                                                                                                            |
| **来源**                  | 对于 **ApplicationSet** 类型的应用：<ul><li>点击 **来源** 链接导航到父应用的详情页面。</li></ul>                                                                                                       |
| **应用分发**              | 扩展：<br />1. 更新现有 **ApplicationSet** 配置 <br />2. 在 **ApplicationSet** 详情中：**应用** > **添加分发**                                                                                                   |
