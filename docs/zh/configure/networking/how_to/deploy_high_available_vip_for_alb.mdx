---
weight: 10
sourceSHA: 61e2aee0db5bed5945164fd259540b0f54523a1812afdbe85b9ae82bf8477f9a
---

# 为 ALB 部署高可用 VIP

**负载均衡器**的高可用性需要一个 VIP。获取 VIP 的方式有两种。

## 方法 1：使用 LoadBalancer 类型的内部路由提供 VIP

在创建负载均衡器时，启用 **内部路由**选项，系统会自动创建一个 LoadBalancer 类型的内部路由为负载均衡器提供 VIP。在使用之前，请确保当前集群支持 LoadBalancer 类型的内部路由。您可以使用平台内置的 LoadBalancer 内部路由实现，具体配置请参考 [External Address Pool](../functions/create_metallb.mdx)；如果 **内部路由**选项被禁用，则需要为负载均衡器配置访问地址。

## 方法 2：使用外部负载均衡设备提供 VIP

- 部署前，请与网络工程师确认负载均衡服务的 IP 地址（公网 IP、私网 IP、VIP）或域名。如果您希望使用域名作为外部流量访问负载均衡器的地址，则需要提前申请域名并配置域名解析。建议使用商业负载均衡设备提供 VIP；如果没有，则可以使用 [纯软件数据中心 LB 解决方案（Alpha）](./deploy_pure_software_datacenter_lb.mdx)。

- 根据业务场景，外部负载均衡器需要为所有使用的端口配置健康检查，以减少 ALB 升级时的停机时间。健康检查配置如下：

  | 健康检查参数       | 描述                                                                                                                                                            |
  | ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
  | **端口**           | <ul><li>对于全球集群，填写：11782。</li><li>对于业务集群，填写：1936。</li></ul>                                                                                 |
  | **协议**           | 健康检查的协议类型，建议使用 TCP。                                                                                                                              |
  | **响应超时**       | 接收健康检查响应所需的时间，建议配置为 2 秒。                                                                                                                  |
  | **检查间隔**       | 健康检查的时间间隔，建议配置为 5 秒。                                                                                                                          |
  | **不健康阈值**     | 确定后端服务器健康检查状态失败所需的连续失败次数，建议配置为 3 次。                                                                                          |
