---
weight: 20
sourceSHA: b2422ba10aeec6cff5f8ef11b203ee07ce168e4ed796bec913542b5024c690a8
---

# 创建 BGP 对等体

节点建立连接以交换路由信息，不论是在不同的 AS 之间还是同一 AS 内部，通过 BGP 协议进行通信。

## 术语

| 术语          | 说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **AS 编号**   | AS 指由同一技术管理机构管理的一组路由器，它们使用统一的路由策略。在 BGP 网络中，每个 AS 被分配一个唯一的 AS 编号以将其与其他 AS 区分开。AS 编号分为 2 字节 AS 编号和 4 字节 AS 编号。 <ul><li>2 字节 AS 编号的范围是 1~~65535，其中 1-64511 是在 Internet 上注册的公共 AS 编号，类似于公共 IP 地址；64512~~65535 是私有 AS 编号，类似于私有 IP 地址。</li><li>4 字节 AS 编号的范围是 1\~4294967295。</li></ul> 支持 4 字节 AS 编号的设备可以与支持 2 字节 AS 编号的设备兼容。 |

## 先决条件

请联系管理员以启用相关功能。

## 示例 BGPPeer 自定义资源 (CR)

```yaml
# test-bgb-example.yaml
apiVersion: metallb.io/v1beta2
kind: BGPPeer
metadata:
  name: example
  namespace: metallb-system
spec:
  myASN: 64512
  peerASN: 64512
  peerAddress: 172.30.0.3
  peerPort: 180
  nodeSelectors:
    - matchLabels:
        alertmanager: "true"
```

## 通过 Web 控制台创建 BGPPeer

1. 进入 **平台管理**。

2. 在左侧导航栏中，点击 **网络管理** > **BGP 对等体**。

3. 点击 **创建 BGP 对等体**。

4. 请参考以下说明配置参数。

   | 参数                   | 描述                                                                                                                                                                                                                                                                                                    |
   | ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **本地 AS 编号**       | BGP 连接节点所在 AS 的 AS 编号。<br /><br /><b>注意</b>: 如果没有特殊要求，建议使用 IBGP 配置，即本地 AS 编号应与对等体 AS 编号一致。                                                                                                                       |
   | **对等体 AS 编号**     | BGP 对等体所在 AS 的 AS 编号。                                                                                                                                                                                                                                                                         |
   | **对等体 IP**          | BGP 对等体的 IP 地址，必须是一个有效的 IP 地址，可以建立 BGP 连接。                                                                                                                                                                                                                                      |
   | **本地 IP**            | BGP 连接节点的 IP 地址。当 BGP 连接节点有多个 IP 时，选择指定的本地 IP 与对等体建立 BGP 连接。                                                                                                                                                                                                    |
   | **对等体端口**         | BGP 对等体的端口号。                                                                                                                                                                                                                                                                                   |
   | **BGP 连接节点**       | 建立 BGP 连接的节点。如果未配置此参数，则所有节点将建立 BGP 连接。                                                                                                                                                                                                                                     |
   | **eBGP 多跳**          | 允许在未直接连接的 BGP 路由器之间建立 BGP 会话。当启用此功能时，BGP 数据包的默认 TTL 值为 5，允许在多个中间网络设备之间建立 BGP 对等关系，使网络设计更加灵活。                                                                                              |
   | **RouterID**           | 一个 32 位的数字值（通常以点分十进制格式表示，类似于 IPv4 地址格式），用于唯一标识 BGP 网络中的 BGP 路由器，通常用于建立 BGP 邻居关系、检测路由环路、选择最佳路径以及故障排除网络问题。 |

5. 点击 **创建**。

## 通过 CLI 创建 BGPPeer

```shell
kubectl apply -f test-bgb-example.yaml
```
