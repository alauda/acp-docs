---
weight: 10
sourceSHA: 7d1a69d3d920360ebc35e697ca4f3ba3145637f3d7b4c4251860a48be7593948
---

# 创建外部 IP 地址池

外部 IP 地址池是一组 IP，MetalLB 利用这些 IP 来获取负载均衡器类型内部路由的外部访问 IP。

## 前提条件

如果您需要使用 BGP 类型的外部 IP 地址池，请联系管理员以启用相关功能。

## 约束与限制

外部地址的 IP 资源必须满足以下条件：

- 外部地址池必须与可用节点以第二层（L2）互联。

- IP 必须可以被平台使用，且不能包括物理网络中已使用的 IP，例如网关 IP。

- 必须与集群使用的网络没有重叠，包括集群 CIDR、服务 CIDR、子网等。

- 在双栈环境中，确保同时在同一外部地址池中存在 IPv4 和 IPv6 地址，且它们的数量都大于 0。否则，双栈负载均衡器类型的内部路由将无法获取外部访问地址。

- 在 IPv6 环境中，节点的 DNS 必须支持 IPv6；否则，MetalLB 插件无法成功部署。

## 部署 MetalLB 插件

使用外部地址池依赖于 MetalLB 插件。

### 步骤

1. 进入 **平台管理**。

2. 在左侧导航栏中，点击 **集群管理** > **集群**。

3. 点击要部署插件的 ***集群名称***。

4. 在 **插件** 标签页上，点击 **MetalLB** 右侧的 ⋮ > **部署**。

5. 等待部署状态显示 **部署成功** 以完成部署。

## 创建外部 IP 地址池

1. 进入 **平台管理**。

2. 在左侧导航栏中，点击 **网络管理** > **外部 IP 地址池**。

3. 点击 **创建外部 IP 地址池**。

4. 根据以下说明配置某些参数。

   | 参数                 | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
   | ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **类型**            | <ul><li>L2：基于 MAC 地址的通信和转发，适合需要简单快速的第二层交换的小型或局域网络，具有配置简单和延迟低的优点。</li><li>BGP（Alpha）：基于 IP 地址的路由和转发，使用 BGP 协议交换路由信息，适合需要在多个自治系统中进行复杂路由的大型网络，具有高可扩展性和可靠性的优点。</li></ul>                                                                                                                                                                                                                                                                                                                                                                         |
   | **IP 资源**        | 支持 CIDR 和 IP 范围格式的输入。点击 **添加** 支持多个条目，示例如下：<br />**CIDR**：`192.168.1.1/24`。<br />**IP 范围**：`192.168.2.1` \~ `192.168.2.255`。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   | **可用节点**        | 在 L2 模式下，可用节点是用于承载所有 VIP 流量的节点；在 BGP 模式下，可用节点是用于承载 VIP，与对等方建立 BGP 连接并向外通告路由的节点。<ul><li><b>节点名称</b>：根据节点名称选择可用节点。</li><li><b>标签选择器</b>：根据标签选择可用节点。</li><li><b>显示节点详情</b>：以列表格式查看最终可用节点。</li></ul><b>注意</b>：<ul><li>使用 BGP 类型时，可用节点是下一跳节点；确保所选可用节点是 [BGP 连接节点](./create_bgppeer.mdx) 的子集。</li><li>您可以单独配置标签选择器或节点名称以选择可用节点；如果同时配置了两者，则最终可用节点是两者的交集。</li></ul> |
   | **BGP 对等体**      | 选择 BGP 对等体；有关具体配置，请参考 [BGP 对等体](./create_bgppeer.mdx)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

5. 点击 **创建**。

## 查看告警策略

1. 进入 **平台管理**。

2. 在左侧导航栏中，点击 **网络管理** > **外部 IP 地址池**。

3. 点击页面右上角的 **查看告警策略** 以查看 MetalLB 的通用告警策略。
