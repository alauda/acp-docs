---
weight: 20
sourceSHA: df0fd9220de91e62d618655742f67e7cf3fc3b199d13e15295de734e4367386f
---

# 创建子网 (Kube-OVN Overlay 网络)

在 Kube-OVN Overlay 网络中创建一个子网，以实现对集群中资源的更细粒度的网络隔离。

**注意**：平台内置了 **join** 子网用于节点与容器组之间的通信，请避免 **join** 子网与新创建的子网之间的网络段冲突。

## IP 分配规则

**描述**：如果一个项目或命名空间被分配了多个子网，则将从其中一个子网随机选择一个 IP 地址。

- 项目分配：

  - 如果项目未绑定到子网，则该项目下所有命名空间中的 Pods 只能使用默认子网中的 IP 地址。如果默认子网中的 IP 地址不足，Pods 将无法启动。
  - 如果项目绑定到子网，则该项目下所有命名空间中的 Pods 只能使用该子网中的 IP 地址。

- 命名空间分配：

  - 如果命名空间未绑定到子网，则该命名空间中的 Pods 只能使用默认子网中的 IP 地址。如果默认子网中的 IP 地址不足，Pods 将无法启动。
  - 如果命名空间绑定到子网，则该命名空间中的 Pods 只能使用该子网中的 IP 地址。

## 创建子网并分配给项目或命名空间

1. 进入 **平台管理**。

2. 在左侧导航栏中，点击 **网络管理** > **子网**。

3. 点击 **创建子网**。

4. 根据以下说明配置相关参数。

   | 参数                    | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   | ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | **网络段**             | 将子网分配给项目或命名空间后，该段内的 IP 将被随机分配给容器组使用。                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   | **保留 IP**            | 该集保留的 IP 将不会被自动分配。例如，它可以用作计算组件的 **固定 IP**。                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   | **网关类型**           | 选择子网的网关类型以控制出站流量。 <br />- **分布式**：集群中的每个主机可以作为当前主机上容器组的出站节点，实现分布式出站。 <br />- **集中式**：集群中的所有容器组使用一个或多个特定主机作为出站节点，便于外部审计和防火墙控制。设置多个集中式 **网关节点** 能实现高可用性。                                                                                                                                                                                                                                                                                                                      |
   | **ECMP (Alpha)**       | 当选择 **集中式** 网关时，可以使用 ECMP 特性。默认情况下，网关以主从模式运行，仅主网关处理流量。当启用 ECMP（等成本多路径路由）时，出站流量将通过多个等成本路径路由到所有可用的网关节点，从而增加网关的总吞吐量。 <br /><br />**注意**：请提前启用 ECMP 相关功能。                                                                                                                                                                                                                                 |
   | **网关节点**           | 当使用 **集中式** 网关时，选择一个或多个特定主机作为网关节点。                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   | **出站流量 NAT**       | 选择是否启用出站流量的 NAT（网络地址转换）。默认情况下，已启用。 <br />主要用于在子网中的容器组访问互联网时设置暴露给外部网络的访问地址。 <br />启用出站流量 NAT 时，主机 IP 将作为当前子网中容器组的访问地址；未启用时，子网内容器组的 IP 将直接暴露给外部网络。在这种情况下，建议使用集中式网关。 |

5. 点击 **确认**。

6. 在子网详细信息页面，选择 **操作** > **分配项目** / **命名空间**。

7. 完成配置并点击 **分配**。
