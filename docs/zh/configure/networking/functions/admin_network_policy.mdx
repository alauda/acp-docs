---
weight: 20
sourceSHA: 5cd30aaa1d34cadf1db9784d24dc0d6190c923d4470a01c7affc4a7ea71f76ed
---

:::info
平台现在提供两种不同的集群网络策略用户界面。旧版本是为了兼容性而保留的，而新版本更加灵活，并提供了原生YAML编辑器。我们建议使用新版本。

请联系平台管理员启用 **cluster-network-policy** 和 **cluster-network-policy-next** 特性开关以访问新的用户界面。
:::

# 配置管理员网络策略

新的集群网络策略采用了Kubernetes社区的管理员网络策略标准设计，提供更灵活的配置方法和丰富的配置选项。

当应用多个网络策略时，它们遵循严格的优先级顺序：管理员网络策略优先于网络策略，而网络策略又优先于基线管理员网络策略。

## 注意事项

- 只有KUBE-OVN CNI支持管理员网络策略。

- 在Kube-OVN网络模式下，此功能处于Alpha成熟度级别。

- 集群中只能存在一个基线管理员网络策略。

## 操作步骤

1. 进入**平台管理**。

2. 在左侧导航栏中，点击**网络** > **集群网络策略**。

3. 点击**创建管理员网络策略**或**配置基线管理员网络策略**。

4. 按照以下说明完成相关配置。

   <table>
     <thead>
       <tr>
         <th>区域</th>
         <th colSpan={2}>参数</th>
         <th>描述</th>
       </tr>
     </thead>

     <tbody>
       <tr>
         <td rowSpan={2}>创建管理员网络策略/配置基线管理员网络策略</td>
         <td colSpan={2}>名称</td>
         <td>管理员网络策略或基线管理员网络策略的名称。</td>
       </tr>

       <tr>
         <td colSpan={2}>优先级</td>
         <td>决定策略评估和应用的顺序。数值越小表示优先级越高。</td>
       </tr>

       <tr>
         <td rowSpan={4}>目标Pod</td>
         <td colSpan={2}>命名空间选择器</td>
         <td>以键值形式输入目标命名空间的标签。如果未设置，策略将应用于当前集群中的所有命名空间。指定后，策略将仅应用于匹配这些选择器的命名空间中的Pod。</td>
       </tr>

       <tr>
         <td colSpan={2}>受当前策略影响的目标Pod预览</td>
         <td>点击<b>预览</b>查看受此网络策略影响的目标Pod。</td>
       </tr>

       <tr>
         <td colSpan={2}>Pod选择器</td>
         <td>以键值形式输入目标Pod的标签。如果未设置，策略将应用于当前命名空间中的所有Pod。</td>
       </tr>

       <tr>
         <td colSpan={2}>受当前策略影响的目标Pod预览</td>
         <td>点击<b>预览</b>查看受此网络策略影响的目标Pod。</td>
       </tr>


       <tr>
         <td rowSpan={4}>入站规则</td>
         <td colSpan={2}>流量动作</td>
         <td>指定如何处理到目标Pod的入站流量。有三种模式：<b>允许</b>（允许流量），<b>拒绝</b>（阻止流量）和<b>跳过</b>（跳过所有低优先级的管理员网络策略，允许流量由网络策略处理，如果不存在网络策略，则由基线管理员网络策略处理）。</td>
       </tr>

       <tr>
         <td rowSpan={2}>规则<br /><br /><b>说明</b>：如果在规则中添加了多个来源，它们之间存在逻辑<b>或</b>关系。</td>
         <td>Pod选择器</td>
         <td>匹配集群中具有指定标签的命名空间或Pod；只有匹配的Pod可以访问目标Pod。您可以点击<b>预览</b>查看受当前规则影响的Pod。<ul><li>如果同时配置了命名空间和Pod选择器，将取它们的交集，即从指定命名空间中选择具有指定标签的Pod。</li><li>如果未配置此项，默认情况下集群中所有命名空间的所有Pod都可以访问目标Pod。</li></ul></td>
       </tr>

      <tr>
         <td>命名空间选择器</td>
         <td>匹配当前命名空间中具有指定标签的Pod；只有匹配的Pod可以访问目标Pod。您可以点击<b>预览</b>查看受当前规则影响的Pod。如果未配置此项，默认情况下当前命名空间中的所有Pod都允许访问目标Pod。</td>
       </tr>

       <tr>
         <td colSpan={2}>端口</td>
         <td>匹配指定协议和端口上的流量；您可以添加数字端口或Pod上的端口名称。如果未配置此项，将匹配所有端口。</td>
       </tr>

       <tr>
         <td rowSpan={4}>出站规则</td>
         <td rowSpan={3}>规则<br /><br /><b>说明</b>：如果在规则中添加了多个来源，它们之间存在逻辑<b>或</b>关系。</td>
         <td>节点选择器</td>
         <td>指定目标Pod允许访问哪些节点IP。您可以通过节点的标签选择节点，以控制从Pod可访问哪些节点IP。</td>
       </tr>

       <tr>
         <td>IP范围</td>
         <td>指定目标Pod允许连接的CIDR范围。如果未配置此项，默认情况下目标Pod可以连接到任何IP。</td>
       </tr>

       <tr>
         <td>其他参数</td>
         <td>与入站参数类似，具有相同的配置选项和行为。</td>
       </tr>

     </tbody>
   </table>

## 参考

如果您想了解更多详情，请查阅[管理员网络策略](https://network-policy-api.sigs.k8s.io/api-overview/)的官方文档。
