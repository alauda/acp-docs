---
weight: 50
sourceSHA: 25b8107be2a49ba56daed3a3cc9cbc75d3d84edfa3e0efabe20fc907f5096a59
---

# 创建 PV

手动创建类型为 **HostPath** 或 **NFS 共享存储** 的静态持久卷。

- **HostPath**：将容器所在主机的文件目录挂载到容器中的指定路径（对应于 Kubernetes 的 HostPath），允许容器使用主机的文件系统进行持久化存储。如果主机变得不可访问，则 HostPath 可能也无法访问。

- **NFS 共享存储**：NFS 共享存储使用社区版 NFS CSI（Container Storage Interface）存储插件，更符合 Kubernetes 的设计原则，能够为多个服务提供客户端访问能力。在使用之前，请确保当前集群已部署 **NFS 存储插件**。

## 前提条件

- 确认要创建的持久卷的大小，并确保后端存储系统目前能够提供相应的存储空间。

- 获取后端存储访问地址、待挂载的文件路径、凭证访问（如需要）及其他相关信息。

## 示例 PersistentVolume

```yaml
# example-pv.yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: example-pv
spec:
  capacity:
    storage: 5Gi # [!code callout]
  accessModes:
    - ReadWriteOnce # [!code callout]
  persistentVolumeReclaimPolicy: Retain # [!code callout]
  storageClassName: manual # [!code callout]
  hostPath: # [!code callout]
    path: "/mnt/data"
```

<Callouts>
  1. 存储量。
  2. 卷的挂载方式。
  3. PVC 删除后会发生什么（保留、删除、回收）。
  4. StorageClass 的名称（用于动态绑定）。
  5. 存储后端类型。
</Callouts>

## 通过 Web 控制台创建 PV

1. 进入 **平台管理**。

2. 在左侧导航栏中，点击 **存储管理** > **持久卷 (PV)**。

3. 点击 **创建持久卷**。

4. 参考以下说明并在配置参数后点击 **创建**。

### 存储信息

<table>
  <thead>
    <tr>
      <th>类型</th>
      <th>参数</th>
      <th>说明</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>HostPath</td>
      <td>路径</td>
      <td>后端存储卷所在节点的文件目录路径。例如：<code>/etc/kubernetes</code>。</td>
    </tr>

    <tr>
      <td rowSpan={3}>NFS 共享存储</td>
      <td>服务器地址</td>
      <td>NFS 服务器的访问地址。</td>
    </tr>

    <tr>
      <td>路径</td>
      <td>NFS 文件系统在服务器节点的挂载路径，例如 <code>/nfs/data</code>。</td>
    </tr>

    <tr>
      <td>NFS 协议版本</td>
      <td>当前平台支持的 NFS 协议版本包括 <code>v3</code>、<code>v4.0</code> 和 <code>v4.1</code>。您可以在服务器端执行 <code>nfsstat -s</code> 来查看版本信息。</td>
    </tr>
  </tbody>
</table>

## 通过 CLI 创建 PV

```shell
kubectl apply -f example-pv.yaml
```

### 访问模式

持久卷的访问模式受后端存储相关参数设置的影响。

| 访问模式              | 含义                                         |
|--------------------|---------------------------------------------|
| **单节点读写 (RWO)**  | 可以被单个节点以读写方式挂载。                |
| **多节点读写 (RWX)**  | 可以被多个节点以读写方式挂载。                |
| **多节点只读 (ROX)**  | 可以被多个节点以只读方式挂载。                |

### 回收策略

| 回收策略 | 含义                                                                                                                                                                                                                                     |
|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **删除**   | 删除持久卷声明的同时也会删除绑定的持久卷及后端存储卷资源。<br />**注意**：NFS 共享存储类型的持久卷的回收策略不支持 **删除**。                                                         |
| **保留**   | 即使删除持久卷声明，绑定的持久卷和存储数据仍将保留。之后需要手动处理存储数据并删除持久卷。                                                                                       |

## 相关操作

您可以在列表页面右侧点击 ⋮ 或在详情页面右上角点击 **操作**，根据需要更新或删除持久卷。

删除持久卷适用于以下两种场景：

- 删除未被绑定的持久卷：此卷未被写入数据且不再需要写入，删除后可释放相应的存储空间。

- 删除 **保留** 的持久卷：持久卷声明已被删除，但由于其回收策略为保留，未同时删除。如果持久卷中的数据已备份至其他存储或不再需要，删除它可释放相应的存储空间。

## 额外资源

- [创建 PVCs](./create_pvc.mdx)
