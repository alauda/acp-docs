---
sourceSHA: 08fa64ae9ae12557bf7ba851b09d7c7def503b03ee30e5693cee1e401147b1e2
---

# Redis 大键

## 大键简介

在 Redis 中，大键会消耗过多的内存资源，从而影响 Redis 的性能和可用性。

一般来说，以下条件可能导致一个键被视为大键：

- 对于字符串类型的键，如果分配的内存超过 5 MB。
- 对于列表类型的键，如果元素数量超过 20,000，或分配的内存超过 1 MB。
- 对于集合类型的键，如果元素数量超过 5,000，或分配的内存超过 1 MB。
- 对于有序集合类型的键，如果元素数量超过 10,000，或分配的内存超过 1 MB。
- 对于哈希类型的键，如果字段数量超过 1,000，或分配的内存超过 1 MB。

**注意**：这些阈值并不是固定的规则，需根据实际情况判断一个键是否符合大键的标准。

## 如何在 Redis 实例中识别大键？

使用以下命令对 Redis 中的键进行抽样和检查，以识别出占用大量内存的键，以及它们的类型和大小。

```bash
redis-cli --bigkeys
```

有关检测大键的更详细方法，请参见 <ExternalSiteLink name="redis" href="trouble_shooting/20-bigkeycheck.mdx" children="发现和处理大键" />。

## 如何在 Redis 实例中修复大键？

| 大键类型       | 修复方法                                                                                                                                                                                                                                                                                                                      |
| -------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **字符串**     | 考虑将大键拆分为多个较小的字符串进行存储。使用 `GETRANGE` 和 `SETRANGE` 命令读取和修改字符串的部分，从而将一个大字符串拆分为几个较小的字符串。                                                                                                           |
| **哈希**       | 将大键拆分为几个较小的哈希。首先，将大哈希的键集拆分为若干部分，然后将每个键对应的哈希的字段集拆分，最终将每个字段对应的值拆分。这种方式可以将一个大哈希分割为几个较小的哈希。                                  |
| **列表**       | 考虑将大键拆分为几条较小的列表进行存储。使用 `LRANGE` 和 `RPUSH` 命令读取和修改列表的部分，将一个大列表分割为几个较小的列表。                                                                                                                       |
| **集合**       | 考虑将大键拆分为几条较小的集合进行存储。使用 `SMEMBERS` 和 `SADD` 命令读取和修改集合中的元素，从而将一个大集合分割为几个较小的集合。                                                                                                                         |
| **有序集合**   | 将大键拆分为几个较小的有序集合。首先，将大有序集合的键集进行分区，然后将每个键的对应有序集合的元素进行拆分。使用 `ZRANGE` 和 `ZADD` 命令读取和修改有序集合中的元素，从而将一个大有序集合分割为几个较小的有序集合。 |
