---
weight: 20
---

# 创建负载均衡器

负载均衡（Load Balancer）是将流量分发到容器实例的服务。通过负载均衡功能，自动分配计算组件的访问流量，转发给计算组件的容器实例。负载均衡可以提高计算组件的容错能力，扩展计算组件的对外服务能力，提高应用的可用性。

平台管理员可以为平台上的任意集群创建单点或高可用的负载均衡器，并统一管理和分配负载均衡器资源。例如将负载均衡分配给项目，控制仅具有相应项目权限的用户可以使用该负载均衡。


本节相关概念说明请参见下表。


|参数|    说明  |
| ---- | ----- |
|  **负载均衡器** |  是一种把网络请求分散到一个集群中的可用节点上的软件或硬件设备，平台中使用的负载均衡器为七层软件负载均衡器。|
|  **VIP** |  虚拟 IP 地址（Virtual IP Address），是一种不与特定计算机或者特定计算机网卡相对应的 IP 地址。当负载均衡器为高可用类型时，访问地址应为 VIP。|

## 前提条件

**负载均衡器** 的高可用需要 VIP，请参考 [配置 VIP](./vip.mdx)。

## 创建负载均衡器

1. 进入 **平台管理**。

1. 在左侧导航栏中，单击 **网络管理** > **负载均衡器**。

2. 单击 **创建负载均衡器**。

3. 参考以下说明完成网络配置。

    |参数| 说明        |
    | -------- | -------- |
    | **网络模式** | <ul><li>**主机网络模式**：单个节点只允许部署一个负载均衡器副本，多业务共用一个 ALB，网络性能表现更优。</li><li>**容器网络模式**：单个节点可部署多个负载均衡器副本，以满足各业务单独使用 ALB 的需求，网络性能略差。</li></ul> |
    |  **内部路由及注解（Alpha）** |  <ul><li>**内部路由**：开启时将创建 LoadBalancer 类型内部路由为负载均衡器提供访问地址，使用前需确保当前集群支持 LoadBalancer 类型的内部路由。您可以使用平台自带的 LoadBalancer 内部路由实现，具体配置请参考 [外部地址池](/networking/metallb/functions/create_metallb.mdx)；关闭时需为负载均衡器配置访问地址。</li><li>**注解**：用于声明 LoadBalancer 类型内部路由的配置或者能力，具体请参考 [LoadBalancer 类型内部路由注解说明](/application/building_application/functions/operation_after_creating/network_communications/service/annotation.mdx)。</li></ul> |
    |  **访问地址** |  负载均衡的访问地址，即负载均衡实例的服务地址。负载均衡创建成功后，即可通过该地址访问负载均衡。<ul><li>主机网络模式下请根据实际情况填写，可以是域名或 IP 地址（内网 IP、外网 IP、VIP）。</li><li>容器网络模式下将自动获取。</li></ul> |    

4. 参考以下说明完成资源配置。

    |参数| 说明        |
    | -------- | -------- |
    | **规格** | 请根据业务需求合理设置规格。您也可参考 [负载均衡器选型及规划](./selection.mdx)，获取参考依据。 |
    | **部署类型** |  <ul><li>**单点**：负载均衡器的容器组部署在单一节点上，若发生机器故障后，可能会导致负载均衡不可用的风险。</li><li>**高可用**：多个负载均衡的容器组部署在对应个数的节点上，通常为 3。满足大业务量负载均衡需求的同时，具备应急容灾能力。</li></ul>  |
    | **副本数** | 副本数为负载均衡器的容器组个数。<br/>**提示**：为保证负载均衡的高可用，建议副本数不小于 3。 |
    | **节点标签**  | 通过标签筛选节点，用于部署负载均衡器。<br/>**提示**：<ul><li>推荐符合要求的节点个数大于负载均衡器的副本数。</li><li>键相同的标签，仅可选中其中一个（选中多个时，将不会有符合条件的主机）。</li></ul>|
    | **资源分配方式**  | <ul><li>**实例**：负载均衡器实例可监听的 1-65535 范围内的任意端口，都可供项目使用。</li><li>**端口（Alpha）**：仅指定范围内的端口可分配给项目使用。当端口资源有限时，此方式可满足更细粒度的资源管控。</li></ul>|
    | **分配项目** |  <ul><li>当 **资源分配方式** 为 **实例** 时，将负载均衡器分配给当前集群关联的全部项目或指定的项目，在被分配的项目中，所有命名空间下的 Pod 都可以接收到由该负载均衡分发的请求。<ul><li>**所有项目**：将负载均衡器分配给当前集群关联的所有项目使用。</li><li>**指定项目（Alpha）**：单击 **指定项目** 下拉选择框，单击项目名称左侧的复选框，选择一个或多个项目，将负载均衡器分配给指定的项目使用。<br/>**提示**：在下拉框中输入项目名称可对项目进行模糊搜索。</li><li>**不分配（Alpha）**：暂不分配项目。负载均衡器创建完成后，可通过 **更新项目** 操作，更新已创建负载均衡器的分配项目参数。</li></ul></li><li>当 **资源分配方式** 为 **端口** 时，不需配置此项，请在创建完成负载均衡器后，手动分配端口信息。</li></ul> |

5. 单击 **创建**。创建过程需要一段时间，请您耐心等待。

