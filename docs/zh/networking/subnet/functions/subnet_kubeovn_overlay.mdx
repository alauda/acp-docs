---
weight: 20
---

# 创建子网（Kube-OVN Overlay 网络）


在 Kube-OVN Overlay 网络中创建子网，实现集群下资源更细粒度的网络隔离。

**提示**：平台预置了一个 **join** 子网用于节点与容器组间通信，请避免 **join** 与新建子网的网段冲突。
 

## IP 分配规则

**说明**：若一个项目或命名空间被分配了多个子网，则会随机使用其中一个子网中的 IP 地址。

* 分配项目：

    - 若项目未绑定子网，则该项目下所有命名空间中的 Pod 只能使用默认子网中的 IP 地址。若默认子网中的 IP 地址不足，Pod 将无法启动。
    - 若项目已绑定子网，则该项目下所有命名空间中的 Pod 只能使用该子网中的 IP 地址。

* 分配命名空间：

    - 若命名空间未绑定子网，则该命名空间下的 Pod 只能使用默认子网中的 IP 地址。若默认子网中的 IP 地址不足，Pod 将无法启动。
    - 若命名空间已绑定子网，则该命名空间下的 Pod 只能使用该子网中的 IP 地址。


## 创建子网并分配项目或命名空间

1. 进入 **平台管理**。

1. 在左侧导航栏中，单击 **网络管理** > **子网**。
    
2. 单击 **创建子网**。

3. 参考以下说明配置相关参数。

    |参数|    说明      |
    | ---   |  ---  |
    |**网段**| 将子网分配给项目或命名空间后，此网段内 IP 将被随机分配给容器组使用。 |
    |**保留 IP**|  设置的保留 IP 将不会被自动分配。例如可将其用做计算组件 **固定 IP** 的 IP 地址。|
    |**网关类型**|  选择子网的网关类型，用于控制流量的出网方式。<br/>- **分布式**：集群内每台主机都可以作为当前主机上容器组的出网节点，实现分布式出网。<br/>- **集中式**：集群中所有容器组均使用一个或多个特定的主机作为出网节点，方便外部审计和防火墙控制。设置多个集中式 **网关节点** 可实现多活保障。 |
    |**ECMP（Alpha）**|当选择 **集中式** 网关时，可以使用 ECMP 功能。默认情况下网关工作在主备模式下，只有主网关处理流量。当开启 ECMP（Equal-Cost Multipath Routing，等价多路径路由）功能时，出站流量将会通过多条等价路径路由至所有可用的网关节点，从而提升网关总吞吐量。<br/><br/>**注意**：请提前开启 ECMP 相关功能。|
    |**网关节点**|当使用 **集中式** 网关时，选择一个或多个特定的主机作为网关节点。|
    |**外出流量 NAT**|  选择是否开启外出流量 NAT（Network Address Translation，网络地址转换），默认为开启。<br/>主要用于设置子网内容器组访问外网时，向外网暴露的访问地址。<br/>开启外出流量 NAT 后，将会使用主机 IP 作为当前子网内容器组的访问地址；不开启时，将会直接将子网内的容器组 IP 暴露给外网，此时，推荐使用集中式网关。 |
    
1. 单击 **确定** 。
2.  在子网详细信息页，选择 **操作** > **分配项目** / **命名空间**。
3. 完成配置并单击 **分配**。





