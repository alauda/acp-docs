---
weight: 10
---

# 数据容灾


MinIO 支持通过数据远程备份或双活部署的方式建立容灾中心，保证灾难发生后原有数据不会丢失或遭到破坏，确保数据的安全性和可靠性。

## 适用场景

* **热备**：在同城或异地存在两个机房，一主一备。数据从主集群实时复制到备集群，以确保数据的一致性。当主集群发生灾难时，可以无缝切换业务流量到备集群，以确保业务的连续性。

* **同城双活**：在同城双活（多集群）架构中，存在两个位于不同集群的机房。两个机房均处于活动状态，能够同时接收业务流量。当其中一个机房发生灾难时，业务仍能够无中断地继续在另一个机房运行。

## 名词解释

* **主集群**：指当前处于活动状态、正在处理业务请求的集群。它是数据的源头或操作的发起者。在主集群中，数据被创建、修改或更新，并且业务流量会首先发送到该集群进行处理。

* **目标集群**：指接收数据复制、迁移或故障切换的集群。它通常处于备份或待命状态，等待从主集群获取数据或接管业务流量。当主集群发生故障或需要切换时，目标集群会接收来自主集群的数据副本或接管业务流量，以确保业务的连续性。双活场景下，两集群可互为对方的目标集群。


## 前提条件

* 主集群和目标集群均需开启外网访问，具体配置方式请参考 [创建对象存储](/storage/storagesystem_minio/installation.mdx)。

* 主集群必须使用 **LoadBanlancer** 访问方式，目标集群建议支持 **负载均衡** 功能。

* 主集群和目标集群必须使用相同的访问协议，即均使用 HTTP 协议或均使用 HTTPS 协议。

* 使用 HTTPS 协议时，主集群和目标集群中均需要配置自己本身和对方的 DNS 域名解析。

* 使用 HTTPS 协议时，建议主集群和目标集群使用 CA 签发的证书，以确保通信的安全和信任；若使用自签名证书，则需要双方互相导入并信任对方的自签名证书，以确保能够成功建立安全的 HTTPS 连接。


## 操作步骤

1. 进入 **平台管理**。

1. 在左侧导航栏中，单击 **存储管理** > **对象存储**。

2. 在 **数据容灾** 页签下，单击 **添加目标集群**。

3. 根据以下说明配置目标集群的相关参数。

    |参数| 说明                                                         |
    | ------------ | ------------------------------------------------------------ |
    | **访问地址** | 目标集群的外网访问地址，以 http:// 或 https:// 开头。 |
    | **Access Key** | 目标集群的访问密钥 ID。与私有访问密钥关联的唯一标识符；访问密钥 ID 和私有访问密钥一起使用，对请求进行加密签名。|
    | **Secret Key** | 与访问密钥 ID 结合使用的私有访问密钥，对请求进行加密签名，可标识发送方，并防止请求被修改。|        
    
4. 单击 **添加**。

    * 添加成功后，即可查看目标集群的状态以及集群间的同步情况。

        |参数| 说明                                                         |
        | ------------ | ------------------------------------------------------------ |
        | **集群状态** | 目标集群的状态，包括 **健康**、**异常** 或 **未知**。 |
        | **存储桶** | 待同步、已同步的存储桶数量。<br/><ul><li>热备场景下待同步为主集群需要向目标集群同步的存储桶数量。</li><li>同城双活场景下待同步为主集群和目标集群需要互相同步的存储桶数量之和。</li></ul> |
        | **对象** | 存储桶中同步失败的对象数量。<br/>**说明**：由于 MinIO 同步过程中，同时会同步自身相关的文件配置，因此该数量仅供参考。 |
        | **网络流量速率** | 主集群的网络流入流出速率。<br/><ul><li>热备场景下网络流入速率始终为 0。</li><li>同城双活场景下流入流出速率均有数据。</li></ul> |

    
    * 若目标集群添加失败，您可以单击 **重新添加**，将清理集群信息并返回添加目标集群页面，此时可重新添加目标集群。

## 相关操作

当不再需要数据容灾时，可单击 **移除目标集群**。移除目标集群不会删除已同步的数据；如有数据正在同步，则将会被中断。
