---
weight: 68
---

# 创建 ceph 对象存储用户

我们允许通过自定义资源定义（CRD）创建和自定义对象存储用户。

## 前置条件

- 已经创建对象存储池。

## 步骤

<Steps>
### 创建用户

在集群的**控制节点**上执行以下命令。

```yaml
cat << EOF | kubectl apply -f -
apiVersion: ceph.rook.io/v1
kind: CephObjectStoreUser
metadata:
  name: <name>
  namespace: <namespace>
spec:
  store: <ObjectStore>
  displayName: <displayName>
  quotas:
    maxBuckets: -1
    maxSize: -1
    maxObjects: -1
  capabilities:
    user: "*"
    bucket: "*"
EOF
```

**参数**
|**参数**|**说明**|
|:---|:---|
|**name**|要创建的对象存储用户的名称。|
|**namespace**|对象存储用户的命名空间。|
|**displayName**|用户的显示名称。|
|**ObjectStore**|对象存储池名称。|
|**quotas**|**可选**<br></br>对用户设置配额限制<li>maxBuckets: 用户的最大桶限制。 设置为 `-1` 表示不做限制。</li><li>maxSize: 用户所有桶中所有对象的最大大小限制。设置为 `-1` 表示不做限制。</li><li>maxObjects: 跨所有用户桶的最大对象数。设置为 `-1` 表示不做限制。</li>|
|**capabilities**|**可选**<br></br>Ceph 允许用户获得额外的权限。此设置目前只能在创建对象存储用户时使用。如果需要修改用户的能力，则必须删除该用户并重新创建该用户。有关更多信息，请参阅 [Ceph文档](https://docs.ceph.com/en/latest/radosgw/admin/#add-remove-admin-capabilities)。我们支持对以下资源添加 `read`, `write`, `read,write`, 或者 `*` 权限：<li>user</li><li>buckets</li><li>usage</li><li>metadata</li><li>zone</li><li>roles</li><li>info</li><li>amz-cache</li><li>bilog</li><li>mdlog</li><li>datalog</li><li>user-policy</li><li>odic-provider</li><li>ratelimit</li>|

### 获取用户信息

```bash
user_secret=$(kubectl -n rook-ceph get cephobjectstoreuser <user-name> -o jsonpath='{.status.info.secretName}')

# ACCESS_KEY
kubectl -n rook-ceph get secret $user_secret -o jsonpath='{.data.AccessKey}' | base64 --decode

# SECRET_KEY
kubectl -n rook-ceph get secret $user_secret -o jsonpath='{.data.SecretKey}' | base64 --decode

```
</Steps>