---
weight: 30
---

# 核心概念

## 开源组件

### Filebeat
**定位**：轻量级日志采集器  
**说明**：部署在容器节点上的开源日志采集组件，负责实时监控指定路径的日志文件，通过输入模块收集日志数据，经处理后通过输出模块将日志转发至Kafka或直接投递到存储组件。支持多行日志合并、字段过滤等预处理能力。

### Elasticsearch
**定位**：分布式搜索分析引擎  
**说明**：基于Lucene的全文检索引擎，采用JSON文档格式存储日志数据，提供近实时检索能力。支持动态映射自动识别字段类型，通过倒排索引实现快速关键词检索，适用于日志搜索、监控告警等场景。

### ClickHouse
**定位**：列式分析型数据库  
**说明**：面向OLAP场景的高性能列式存储数据库，采用MergeTree引擎实现PB级日志数据存储。支持高速聚合查询、时间分区、数据TTL策略，适用于日志分析、统计报表等批量计算场景。

### Kafka
**定位**：分布式消息队列  
**说明**：作为日志管道系统的消息中间件，提供高吞吐量的日志缓冲能力。当Elasticsearch集群出现处理瓶颈时，通过Topic接收Filebeat发送的日志数据，实现流量削峰与异步消费，保障日志采集端稳定性。

## 核心功能概念

### 日志采集管道
**说明**：日志数据从产生到存储的完整链路，包含`采集->传输->缓存->存储`四个阶段。支持两种管道模式：  
- **直写模式**：Filebeat → Elasticsearch/ClickHouse  
- **缓冲模式**：Filebeat → Kafka → Elasticsearch

### 索引（Index）
**说明**：Elasticsearch中逻辑层面的数据分区单位，类比数据库中的表结构。支持按时间滚动创建索引（如logstash-2023.10.01），通过索引生命周期管理（ILM）实现自动化的热温冷分层存储。

### 分片与副本
**说明**：  
- **分片（Shard）**：Elasticsearch将索引水平拆分的物理存储单元，支持分布式扩展  
- **副本（Replica）**：每个分片的拷贝副本，提供数据高可用与查询负载均衡

### 列式存储
**说明**：ClickHouse的核心存储机制，数据按列压缩存储，显著减少I/O消耗。支持以下特性：  
- 向量化查询执行引擎  
- 数据分区（Partition）与分片（Shard）  
- 物化视图（Materialized View）预聚合

## 关键技术术语

### Ingest Pipeline
**说明**：Elasticsearch的数据预处理管道，可在数据写入前执行字段重命名、Grok解析、条件判断等ETL操作。

### 消费者组（Consumer Group）
**说明**：Kafka的并行消费机制，同一消费者组内的多个实例可并行消费不同分区的消息，保证消息的顺序性处理。

### TTL（Time To Live）
**说明**：数据存活时间策略，支持两种实现方式：  
- Elasticsearch：通过ILM策略自动删除过期索引  
- ClickHouse：通过TTL表达式自动删除表分区

### 副本因子（Replication Factor）
**说明**：Kafka Topic级别的数据冗余配置，定义每条消息在不同Broker上的副本数量，提升数据可靠性。


## 4. 数据流模型

```mermaid
graph LR
    A[容器日志文件] --> B[Filebeat Agent]
    B -->|直写模式| C{存储组件}
    B -->|缓冲模式| D[Kafka Cluster]
    D --> E[Elasticsearch Consumer]
    E --> C
    C -->|Elasticsearch| F[索引/搜索接口]
    C -->|ClickHouse| G[SQL查询接口]