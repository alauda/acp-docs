---
weight: 10
---

# 日志插件部署

平台的日志系统由 Log Collector 和 Log Storage 两个插件构成，本章节将向您介绍如何部署这两种插件。

:::warning

1、Log Storage 插件部署成功后，部署组件的集群可被用作平台中各集群的存储集群（部署 Log Collector 插件时可选），为平台中各集群提供日志存储服务。

2、global 集群能够查询存储在平台中任一业务集群上的日志数据。需确保 global 集群可访问业务集群的 11780 端口

3、Log Storage with Clickhouse 插件与 Log Storage with ElasticSearch 插件无法部署在同一集群，请阅读[选型建议](../architecture/component_suggestion.mdx)并选择部署其中一种日志存储插件。

:::

## 部署 Log Storage with ElasticSearch

1. 导航至 **应用商店管理** > **集群插件**，选择目标集群

3. 在 **插件** 页签下，单击 **Log Storage with ElasticSearch** 右侧的操作按钮> **部署**。

4. 参考以下说明，配置相关参数。

    | 参数 | 说明 |
    | ---- | ---- |
    | **对接外部 Elasticsearch**|  保持关闭，在平台中部署日志存储插件。|
    | **组件部署设置**| **LocalVolume**：本地存储，日志数据将存放于所选节点的本地存储路径中。使用该方式的优势在于日志组件和本地存储直接绑定，无需通过网络访问存储，可以提供更好的存储性能。<br />**StorageClass**：使用存储类动态创建存储资源以存储日志数据。使用该方式的优势在于具有更高的灵活性，当整个集群定义多个存储类时，管理员可以为日志组件根据使用场景选择对应的存储类，减少主机异常状态对存储的影响。但 StorageClass 的性能可能会受到网络带宽和延迟等因素的影响，并且需要依赖存储后端提供的冗余机制来实现存储的高可用性。|
    | **保留时间**| 各类日志、事件、审计数据可在集群上保留的最长时间，超出保留时间的数据会被自动清理。<br />**提示**：您可自行备份需长期保留的数据，如需帮助，请联系技术支持人员。|

5. 单击 **部署**。


## 部署 Log Storage with Clickhouse 

1. 导航至 **应用商店管理** > **集群插件**，选择目标集群

3. 在 **插件** 页签下，单击 **Log Storage with Clickhouse** 右侧的操作按钮> **部署**。

4. 参考以下说明，配置相关参数。

    | 参数 | 说明 |
    | ---- | ---- |
    | **组件部署设置**| **LocalVolume**：本地存储，日志数据将存放于所选节点的本地存储路径中。使用该方式的优势在于日志组件和本地存储直接绑定，无需通过网络访问存储，可以提供更好的存储性能。<br />**StorageClass**：使用存储类动态创建存储资源以存储日志数据。使用该方式的优势在于具有更高的灵活性，当整个集群定义多个存储类时，管理员可以为日志组件根据使用场景选择对应的存储类，减少主机异常状态对存储的影响。但 StorageClass 的性能可能会受到网络带宽和延迟等因素的影响，并且需要依赖存储后端提供的冗余机制来实现存储的高可用性。|
    | **保留时间**| 各类日志、事件、审计数据可在集群上保留的最长时间，超出保留时间的数据会被自动清理。<br />**提示**：您可自行备份需长期保留的数据，如需帮助，请联系技术支持人员。|

5. 单击 **部署**。


## 部署 Log Collector 插件

1. 导航至 **应用商店管理** > **集群插件**，选择目标集群

3. 在 **插件** 页签下，单击 **Log Collector ** 右侧的操作按钮> **部署**。

4. 选择 **存储集群**（已部署了 Log Storage），并单击 ***选中/取消选中*** 日志类型，设置集群中日志采集的范围。

5. 单击 **部署**。

