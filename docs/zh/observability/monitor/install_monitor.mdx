---
weight: 12
sourceSHA: f5492edbc81c613604eb6371a2113dd788b0a322aa01816ab68f1ef8409af97a
---

# 安装

## 概述

监控组件是可观测模块中监控、告警、巡检和健康检查功能的基础设施。本文描述了如何在集群中安装 ACP Monitoring with Prometheus 插件或 ACP Monitoring with VictoriaMetrics 插件。

## 安装准备

安装监控组件之前，请确保满足以下条件：

- 已参考 [监控组件选型指南](./architecture/component_selection_suggestion.mdx) 选择合适的监控组件。
- 在工作负载集群中安装时，确保 `global` 集群可以访问工作负载集群的 11780 端口。
- 如果需要使用存储类或持久卷存储监控数据，请提前在**存储**部分创建相应资源。

## 安装 ACP Monitoring with Prometheus 插件

### 安装步骤

1. 导航至 **应用商店管理** > **集群插件** 并选择目标集群。

2. 找到 **ACP Monitoring with Prometheus** 插件并点击 **安装**。

3. 配置以下参数：

   | 参数                       | 说明                                                                                                                                                                                                                                                                                                                                                                          |
   | ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | **规模配置**               | 支持三种配置：**小规模**、**中规模**和**大规模**：<br />- 默认值基于平台的推荐负载测试值设置<br />- 可根据实际集群规模选择或自定义配额<br />- 默认值会随着平台版本更新；对于固定配置，建议使用自定义设置                                                                                                                                            |
   | **存储类型**               | - **LocalVolume**：本地存储，数据存储在指定节点<br />- **StorageClass**：使用存储类自动生成持久卷<br />- **PV**：利用已有的持久卷<br />**注意**：安装后存储配置无法修改                                                                                                                                                                                        |
   | **副本数**                 | 设置监控组件容器组的数量<br />**注意**：Prometheus 仅支持单节点安装                                                                                                                                                                                                                                                                                                        |
   | **参数配置**               | 可根据需要调整监控组件的数据参数                                                                                                                                                                                                                                                                                                                                                |

4. 点击 **安装** 完成安装。

### 访问方式

安装完成后，可通过以下地址访问各组件（需将 `<>` 替换为实际值）：

| 组件            | 访问地址                                                       |
| -------------- | -------------------------------------------------------------- |
| **Thanos**     | `<平台访问地址>/clusters/<cluster>/prometheus`               |
| **Prometheus** | `<平台访问地址>/clusters/<cluster>/prometheus-0`             |
| **Alertmanager** | `<平台访问地址>/clusters/<cluster>/alertmanager`             |

## 安装 ACP Monitoring with VictoriaMetrics 插件

### 前提条件

- 如果仅安装 VictoriaMetrics 代理，请确保已在其他集群中安装 VictoriaMetrics Center。

### 安装步骤

1. 导航至 **应用商店管理** > **集群插件** 并选择目标集群。

2. 找到 **ACP Monitoring with VictoriaMetrics** 插件并点击 **安装**。

3. 配置以下参数：

   | 参数                       | 说明                                                                                                                                                                                                                                                                                                                                                                          |
   | ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
   | **规模配置**               | 支持三种配置：**小规模**、**中规模**和**大规模**：<br />- 默认值基于平台的推荐负载测试值设置<br />- 可根据实际集群规模选择或自定义配额<br />- 默认值会随着平台版本更新；对于固定配置，建议使用自定义设置                                                                                                                                            |
   | **仅安装代理**             | - 关闭：安装完整的 VictoriaMetrics 组件套件<br />- 开启：仅安装 VMAgent 采集组件，该组件依赖于 VictoriaMetrics Center                                                                                                                                                                                                                                               |
   | **VictoriaMetrics Center**  | 选择已安装完整 VictoriaMetrics 组件的集群                                                                                                                                                                                                                                                                                                                              |
   | **存储类型**               | - **LocalVolume**：本地存储，数据存储在指定节点<br />- **StorageClass**：使用存储类自动生成持久卷<br />- **PV**：利用已有的持久卷                                                                                                                                                                                                                                         |
   | **副本数**                 | 设置监控组件容器组的数量：<br />- LocalVolume 存储类型不支持多副本<br />- 其他存储类型请参考界面提示进行配置                                                                                                                                                                                                                                                           |
   | **参数配置**               | 可调整监控组件的数据参数<br />**注意**：数据可能会在被删除前暂时超过保留期限                                                                                                                                                                                                                                                                                                 |

4. 点击 **安装** 完成安装。
