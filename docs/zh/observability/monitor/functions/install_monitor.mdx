---
weight: 5
---

# 部署监控组件

## 概述

监控组件是可观测模块中监控、告警、巡检、健康检查等功能的基础设施。本文介绍如何在集群内部署 Prometheus 或 VictoriaMetrics 监控组件。

## 部署准备

在部署监控组件前，请确保满足以下条件：

* 已参考[监控组件选型指南](../architecture/component_selection_suggestion.mdx)选择合适的监控组件
* 如在业务集群部署，需确保 Global 集群可访问业务集群的 11781 端口
* 如需使用存储类或持久卷存储监控数据，请提前在**存储**功能下创建相应资源

## 部署 Prometheus

### 部署步骤

1. 导航至 **应用商店管理** > **集群插件**，选择目标集群
2. 找到 **Prometheus** 插件并点击**部署**
3. 配置以下参数：

    | 参数 | 说明 |
    | ---- | ---- |
    | **规模配置** | 支持**小规模**、**中规模**和**大规模**三种配置：<br />- 默认值基于平台压测推荐值设置<br />- 可根据实际集群规模选择或自定义配额<br />- 默认值会随平台版本更新，如需固定配置建议自定义 |
    | **存储类型** | - **LocalVolume**：本地存储，数据存储在指定节点<br />- **StorageClass**：使用存储类自动生成持久卷<br />- **PV**：使用已创建的持久卷<br />**注意**：部署后存储配置无法修改 |
    | **副本数** | 设置监控组件容器组数量<br />**注意**：Prometheus 仅支持单节点部署 |
    | **参数配置** | 可根据需求调整监控组件的数据参数 |

4. 点击**部署**完成安装

### 访问方式

部署完成后，可通过以下地址访问各组件（需将 `<>` 替换为实际值）：

| 组件 | 访问地址 |
| --- | --- |
| **Thanos** | `<平台访问地址>/clusters/<cluster>/prometheus` |
| **Prometheus** | `<平台访问地址>/clusters/<cluster>/prometheus-0` |
| **Alertmanager** | `<平台访问地址>/clusters/<cluster>/alertmanager` |

## 部署 VictoriaMetrics

### 前提条件

* 如仅部署 VictoriaMetrics 代理，需确保已在其他集群部署 VictoriaMetrics Center

### 部署步骤

1. 导航至 **应用商店管理** > **集群插件**，选择目标集群
2. 找到 **VictoriaMetrics** 插件并点击**部署**
3. 配置以下参数：

    | 参数 | 说明 |
    | ---- | ---- |
    | **规模配置** | 支持**小规模**、**中规模**和**大规模**三种配置：<br />- 默认值基于平台压测推荐值设置<br />- 可根据实际集群规模选择或自定义配额<br />- 默认值会随平台版本更新，如需固定配置建议自定义 |
    | **仅部署代理** | - 关闭：部署完整 VictoriaMetrics 组件套件<br />- 开启：仅部署 VMAgent 采集组件，需依赖 VictoriaMetrics Center |
    | **VictoriaMetrics Center** | 选择已部署完整 VictoriaMetrics 组件的集群 |
    | **存储类型** | - **LocalVolume**：本地存储，数据存储在指定节点<br />- **StorageClass**：使用存储类自动生成持久卷<br />- **PV**：使用已创建的持久卷 |
    | **副本数** | 设置监控组件容器组数量：<br />- LocalVolume 存储类型不支持多副本<br />- 其他存储类型请参考界面提示配置 |
    | **参数配置** | 可调整监控组件数据参数<br />**注意**：数据可能会暂时超出保留期限才被删除 |

4. 点击**部署**完成安装
