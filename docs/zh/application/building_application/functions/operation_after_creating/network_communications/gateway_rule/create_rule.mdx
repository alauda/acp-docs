---
weight: 30
---

# 创建 Route Rule


路由规则可为监听到的流量提供路由策略，它与入站规则（Kubernetes Ingress）类似，都是将网关监听到的网络流量暴露给集群的内部路由（Kubernetes Service），提供路由转发策略。不同的是两者的服务对象不同，入站规则服务于访问控制器（Ingress Controller），路由规则服务于入站网关（Gateway）。

在入站网关中创建好监听后，网关会实时监听来自指定域名和端口的流量，使用路由规则可将访问流量按照预期转发至后端实例中。

## 注意事项

如果 HTTPRoute 类型路由规则中没有 **Path** 对象的匹配规则，会自动增加 PathPrefix 方式且值为 / 的匹配规则。

## 操作步骤

1. 进入 **Container Platform**。

1. 在左侧导航栏中，单击 **网络** > **路由规则**。

2. 单击 **创建路由规则**。

5. 参考以下说明，配置部分参数。

    |参数| 描述 |
    | ---- | ---- |
    |**路由类型**|目前支持的路由类型有：HTTPRoute、TCPRoute、UDPRoute。<br/>**提示：** HTTPRoute 支持发布到 HTTP、HTTPS 协议的监听。|
    |**发布至监听**|在左侧选择框中选择已创建的 **入站网关**，在右侧的选择框中选择已创建的 **监听**，平台将根据下面创建的路由规则发布至监听，实现网关捕获的流量转发至指定的后端实例的功能。<br/><br/>**注意**：不允许将路由规则发布至端口是 **11782** 的监听或已经挂载了路由的 TCP、UDP 监听。|
    |**匹配**|您可通过添加一组或多组匹配规则，捕获符合要求的流量。例如 **捕获指定 Path 的流量**、**捕获指定方法的流量** 等。<br/><br/>**注意**：<ul><li>单击 **添加**，添加多个路由规则时，规则之间的关系为且，所有规则命中时才可生效。</li><li>单击 **添加匹配**，添加多组路由规则时，多组规则之间的关系为或，任意一组规则命中都可生效。</li><li>TCPRoute 和 UDPRoute 不支持配置匹配规则。</li><li>当匹配对象为 **path**，匹配方式为 **Exact** 或 **PathPrefix** 时，输入的 **值** 均需要以 "/" 开头且禁止使用 "//"、"/./"、"/../"、"%2f"、"%2F"、"#"、"/.."、"/." 等字符。</li></ul>|
    |**操作**|您可通过添加一个或多个操作来对捕获到的流量进行处理。<ul><li>Header：HTTP 消息的头部包含许多元数据，提供了关于请求或响应的额外信息，通过修改头部字段，服务器可以影响请求和响应的处理方式。</li><li>Redirect：匹配到的 URL 按照指定方式处理后，重新发起请求。</li><li>Rewrite：匹配到的 URL 按照指定方式处理后，将请求重新指向不同的资源路径或文件名。</li></ul><br/><br/>**注意**：<ul><li>单击 **添加**，添加多个操作规则时，平台将按照规则的展示顺序，顺序执行所有操作。</li><li>TCPRoute 和 UDPRoute 不支持配置操作规则。</li><li>同一路由规则中不能存在多条 **值** 相同的 **Header** 类型操作。</li><li>同一路由规则中仅能存在 **Redirect** 与 **Rewrite** 其中一种类型、 **FullPath** 与 **PrefixPath** 其中一种方式的操作。</li><li>若需使用 **PrefixPath** 方式的操作，请先添加 **PathPrefix** 方式的匹配。</li></ul>|
    |**后端实例**|规则生效后，将按照在当前命名空间中选择的内部路由以及端口转发至后端实例，同时您可设置权重，权重值越高的内部路由，被轮询到的概率越高。<br/>**提示**：权重右侧的百分数为转发到该实例的概率，计算方式为：当前权重值与所有权重值之和的比值。 |

8. 单击 **创建**。


