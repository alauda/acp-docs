---
weight: 10
sourceSHA: f75372d223d4cdcbeac48ba763c2fb2511553f2cc9d59fa279509d162da7464e
---

# 创建命名空间

## 理解命名空间

请参考官方 Kubernetes 文档：[命名空间](https://kubernetes.io/docs/reference/kubernetes-api/cluster-resources/namespace-v1/)

> 在 Kubernetes 中，命名空间提供了一种在单个集群内隔离资源组的机制。资源的名称在命名空间内需要唯一，但在不同命名空间之间不需要。基于命名空间的作用域仅适用于命名空间对象（例如，Deployments、Services 等），而不适用于集群范围的对象（例如，StorageClass、Nodes、PersistentVolumes 等）。

## 使用 Web 控制台创建命名空间

> 在与项目关联的集群内，创建一个与项目可用资源配额相一致的新命名空间。新命名空间在分配给项目的资源配额（例如，CPU、内存）内运行，命名空间中的所有资源必须位于关联的集群内。

1. 在 **项目管理** 视图中，点击要创建命名空间的 ***项目名称***。

2. 在左侧导航栏中，点击 **命名空间** > **命名空间**。

3. 点击 **创建命名空间**。

4. 配置 **基本信息**。

   | 参数         | 描述                                                                         |
   | ------------ | --------------------------------------------------------------------------- |
   | **集群**     | 选择与项目关联的集群以托管命名空间。                                         |
   | **命名空间** | 命名空间名称必须包含一个强制前缀，即项目名称。                               |

5. （可选）配置 [资源配额](./resource_quota.mdx)。

   每当为命名空间内的容器指定计算或存储资源的资源限制（limits），或每当添加新的 Pod 或 PVC 时，将消耗此处设置的配额。

   **注意**：

   - 命名空间的资源配额继承自项目在集群中分配的配额。资源类型的最大允许配额不能超过项目的剩余可用配额。如果任何资源的可用配额达到 0，则将阻止命名空间的创建。请联系您的平台管理员进行配额调整。

   - **GPU 配额配置要求**：

     - 仅在集群中配置了 GPU 资源时，才能配置 GPU 配额（vGPU 或 pGPU）。
     - 使用 vGPU 时，也可以设置内存配额。

     **GPU 单位定义**：

     - **vGPU 单位**：100 个虚拟 GPU 单位（vGPU）= 1 个物理 GPU 核心（pGPU）。
       - 注意：pGPU 单位仅以整数计数（例如，1 pGPU = 1 核心 = 100 vGPU）。
     - **内存单位**：
       - 1 内存单位 = 256 MiB。
       - 1 GiB = 4 内存单位（1024 MiB = 4 × 256 MiB）。

   - **默认配额行为**：
     - 如果未为资源类型指定配额，则默认值为无限制。
     - 这意味着命名空间可以消耗 **分配给项目的所有可用资源**，而无需明确限制。

   **配额参数描述**

   <table>
     <thead>
       <tr>
         <th>类别</th>
         <th>配额类型</th>
         <th>值和单位</th>
         <th>描述</th>
       </tr>
     </thead>

     <tbody>
       <tr>
         <td rowSpan={2}><b>存储资源配额</b></td>
         <td>所有</td>
         <td rowSpan={2}>Gi</td>
         <td>此命名空间中所有持久卷声明（PVC）的总请求存储容量不得超过此值。</td>
       </tr>

       <tr>
         <td>存储类</td>
         <td>与此命名空间中所选存储类关联的所有持久卷声明（PVC）的总请求存储容量不得超过此值。<br /><br /><b>注意</b>：请提前将存储类分配给命名空间所属的项目。</td>
       </tr>

       <tr>
         <td><b>扩展资源</b></td>
         <td>从配置字典（ConfigMap）中获取；有关详细信息，请参阅 [扩展资源配额描述](./resource_quota.mdx#extended-resources-quotas)。</td>
         <td>-</td>
         <td>如果没有相应的配置字典，则此类别将不显示。</td>
       </tr>

       <tr>
         <td><b>其他配额</b></td>
         <td>输入自定义配额；有关具体输入规则，请参阅 [其他配额描述](./resource_quota.mdx#other-quotas)。</td>
         <td>-</td>
         <td>为避免资源重复问题，以下值不允许作为配额类型： <ul><li>limits.cpu</li><li>limits.memory</li><li>requests.cpu</li><li>requests.memory</li><li>pods</li><li>cpu</li><li>memory</li></ul></td>
       </tr>
     </tbody>
   </table>

6. （可选）配置 **容器限制范围**；有关更多详细信息，请参阅 [限制范围](./limit_range.mdx)。

7. （可选）配置 **Pod 安全策略**；有关具体细节，请参阅 [Pod 安全准入](./security_policies.mdx)。

8. （可选）在 **更多配置** 区域，为当前命名空间添加标签和注释。

   **提示**：您可以通过标签定义命名空间的属性，或通过注释补充命名空间的附加信息；两者均可用于过滤和排序命名空间。

9. 点击 **创建**。

## 使用 CLI 创建命名空间

<a id="namespace-yaml" />

### YAML 文件示例

```yaml
# example-namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: example
  labels:
    pod-security.kubernetes.io/audit: baseline # 选项，为确保安全，建议选择基线或限制模式。
    pod-security.kubernetes.io/enforce: baseline 
    pod-security.kubernetes.io/warn: baseline

# example-resourcequota.yaml
apiVersion: v1
kind: ResourceQuota
metadata:
  name: example-resourcequota
  namespace: example
spec:
  hard:
    limits.cpu: "20"
    limits.memory: 20Gi
    pods: "500"
    requests.cpu: "2"
    requests.memory: 2Gi

# example-limitrange.yaml
apiVersion: v1
kind: LimitRange
metadata:
  name: example-limitrange
  namespace: example
spec:
  limits:
    - default:
        cpu: 100m
        memory: 100Mi
      defaultRequest:
        cpu: 50m
        memory: 50Mi
      max:
        cpu: 1000m
        memory: 1000Mi
      type: Container

```

### 通过 YAML 文件创建

```bash
kubectl apply -f example-namespace.yaml
kubectl apply -f example-resourcequota.yaml
kubectl apply -f example-limitrange.yaml
```

### 直接通过命令行创建

```bash
kubectl create namespace example
kubectl create resourcequota example-resourcequota --namespace=example --hard=limits.cpu=20,limits.memory=20Gi,pods=500 
kubectl create limitrange example-limitrange --namespace=example --default='cpu=100m,memory=100Mi' --default-request='cpu=50m,memory=50Mi' --max='cpu=1000m,memory=1000Mi'
```
