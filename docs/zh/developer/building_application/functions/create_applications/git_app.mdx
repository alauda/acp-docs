---
weight: 60
---

# 通过代码创建原生应用

通过代码创建原生应用是基于 S2I（Source to Image）技术实现。S2I 是一套自动化的镜像构建框架，能够将源代码直接转换为可运行的容器镜像，这种方式使得应用构建过程更加标准化、自动化，让开发人员可以专注于业务代码开发，无需关注容器化实现细节。

## 前提条件

请联系管理员下载安装 Source to Image Operator 并创建 Shipyard 实例。


## 操作步骤

1. 进入 **Container Platform**。

1. 在左侧导航栏中，单击 **应用管理** > **原生应用**。

2. 单击 **创建**。

3. 选择 **通过代码创建** 方式。

4. 参考下述参数说明完成配置。

    <table><thead>
      <tr>
        <th>区域</th>
        <th>参数</th>
        <th>说明</th>
      </tr></thead>
    <tbody>
      <tr>
        <td rowSpan={8}><b>代码仓库</b></td>
        <td><b>类型</b></td>
        <td><ul><li><b>平台集成</b>：选择使用平台集成的、且已经分配给所在项目使用的代码仓库，平台支持 GitLab、GitHub 及 Bitbucket。</li><li><b>输入</b>：使用没有通过平台集成的 Git 代码仓库。</li></ul></td>
      </tr>
      <tr>
        <td><b>集成项目名称</b></td>
        <td>平台管理员分配或关联给当前项目使用的集成工具项目名称。</td>
      </tr>
      <tr>
        <td><b>仓库地址</b></td>
        <td>选择或输入源代码存放的 Git 代码仓库地址。</td>
      </tr>
      <tr>
        <td><b>版本标识</b></td>
        <td>支持基于代码仓库中的分支、Tag 或 Commit 创建应用。其中：<ul><li>当版本标识为分支时，仅支持使用选择的分支下最新的 Commit 创建应用。</li><li>当版本标识为 Tag 或 Commit 时，默认选择代码仓库中最新的 Tag 或 Commit，您也可以按需选择其他版本。</li></ul></td>
      </tr>
      <tr>
        <td><b>源代码子目录</b></td>
        <td>源代码的根目录。</td>
      </tr>
      <tr>
        <td><b>凭证</b></td>
        <td>当使用非平台集成的代码仓库时，可以按需创建认证的凭据。</td>
      </tr>
      <tr>
        <td><b>构建器镜像</b></td>
        <td><ul><li>包含了特定编程语言运行时环境、依赖库和 S2I 脚本的容器镜像，它的主要作用是将源代码转换成可运行的应用程序容器镜像。</li><li>平台支持的构建器镜像包括：Golang、Java、Node.js、Python。<br/></li></ul></td>
      </tr>
      <tr>
        <td><b>版本</b></td>
        <td>选择与源代码兼容的运行环境版本。</td>
      </tr>
      <tr>
        <td rowSpan={2}><b>构建</b></td>
        <td><b>方式</b></td>
        <td>当前仅支持使用 <b>构建</b> 的方式来构建应用镜像，该方式将复杂的容器镜像构建过程简单化、自动化，从而使开发人员只需关注业务代码开发即可，大致流程如下：<ol><li>安装 Source to Image Operator 并部署 Shipyard 实例后，系统会自动生成集群级别的 ClusterBuildStrategy 等资源同时定义好标准化的构建流程，包括：详细的构建步骤、必要的构建参数等信息，从而实现 S2I 的构建。</li><li>基于上述策略及用户在表单页面中填写的信息创建 Build 类型的资源，该资源中指定了构建策略、构建参数、源代码仓库、输出的镜像仓库等信息。</li><li>创建 BuildRun 类型资源以启动具体的构建实例，该资源负责协调整个构建过程。</li><li>BuildRun 创建完成后会自动生成对应的 TaskRun 资源实例，该实例触发 Tekton 流水线构建，并创建执行构建的 Pod。Pod 负责实际的构建工作，包括：从代码仓库拉取源代码、调用指定构建器镜像、执行构建流程并将构建结果推送到指定的镜像仓库等。</li></ol></td>
      </tr>
      <tr>
        <td><b>镜像仓库</b></td>
        <td>构建完成后，指定应用镜像的目标仓库地址。</td>
      </tr>
      <tr>
        <td><b>应用</b></td>
        <td>-</td>
        <td>按需填写应用的配置。具体请参考 <a href="/application/building_application/functions/application_workloads/deployment_create" >部署</a>文档中的相关参数说明。</td>
      </tr>
      <tr>
        <td><b>网络</b></td>
        <td>-</td>
        <td><ul><li><b>目标端口</b>：容器内部应用程序实际监听的端口。当启用外部访问时，所有匹配的流量都会被转发至此端口，从而提供对外服务。</li><li><b>其他参数</b>：请参考 <a href="/application/building_application/functions/operation_after_creating/network_communications/ingress/create_ingress" >入站规则</a>文档中的相关参数说明。</li></ul></td>
      </tr>
      <tr>
        <td><b>标签注解</b></td>
        <td>-</td>
        <td>按需填写相关标签及注解。</td>
      </tr>
    </tbody>
    </table>

4. 参数填写完成后单击 **创建**。
5. 可在 **详情信息** 页面查看相应的部署。

## 相关操作

### 启动构建

应用创建完成后，可在详情信息页面下查看对应的信息。

|参数|说明|
|---|---|
|**构建**|单击链接可查看具体的构建（Build）、构建任务（BuildRun）的资源信息及 YAML。|
|**启动构建**|当构建失败或源代码发生变化时，可以单击此按钮重新执行构建任务。|
